<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grid Builder POC - Moveable.js (Experimental)</title>

  <!-- Moveable.js -->
  <script src="https://cdn.jsdelivr.net/npm/moveable@0.53.0/dist/moveable.min.js"></script>

  <script src="../shared/performance-monitor.js"></script>
  <link rel="stylesheet" href="index.css">
</head>
<body>
  <div class="app">
    <!-- Component Palette -->
    <div class="palette">
      <h2>Components</h2>
      <div class="palette-item" data-component-type="header">
        ğŸ“„ Header
      </div>
      <div class="palette-item" data-component-type="text">
        ğŸ“ Text Block
      </div>
      <div class="palette-item" data-component-type="image">
        ğŸ–¼ï¸ Image
      </div>
      <div class="palette-item" data-component-type="button">
        ğŸ”˜ Button
      </div>
      <div class="palette-item" data-component-type="video">
        ğŸ¥ Video
      </div>
      <h2 style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #ddd;">Complex</h2>
      <div class="palette-item" data-component-type="gallery">
        ğŸ–¼ï¸ Image Gallery
      </div>
      <div class="palette-item" data-component-type="dashboard">
        ğŸ“Š Dashboard
      </div>
      <div class="palette-item" data-component-type="livedata">
        ğŸ“¡ Live Data
      </div>
      <h2 style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #ddd;">History</h2>
      <div class="history-controls">
        <button id="undoBtn" class="history-btn" title="Undo (Ctrl+Z)">â†¶ Undo</button>
        <button id="redoBtn" class="history-btn" title="Redo (Ctrl+Y)">â†· Redo</button>
      </div>
      <h2 style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #ddd;">Info</h2>
      <div class="info-note" style="padding: 12px; background: #d1ecf1; border: 1px solid #bee5eb; border-radius: 4px; font-size: 12px; line-height: 1.5; color: #0c5460;">
        <strong>Moveable.js Features:</strong>
        <ul style="margin: 8px 0 0 20px; padding: 0;">
          <li>Built-in snap-to-grid</li>
          <li>Group selection support</li>
          <li>Rotation capabilities</li>
          <li>Transform-based positioning</li>
          <li>Guideline snapping</li>
        </ul>
      </div>
    </div>

    <!-- Main Canvas -->
    <div class="canvas">
      <div class="canvas-header">
        <h1>Grid Builder POC - Moveable.js</h1>
        <p>Using Moveable.js for drag/resize/rotate with built-in snap-to-grid and group selection. Compare with Interact.js implementation.</p>
        <div class="controls">
          <div class="viewport-toggle">
            <button id="desktopView" class="viewport-btn active">ğŸ–¥ï¸ Desktop</button>
            <button id="mobileView" class="viewport-btn">ğŸ“± Mobile</button>
          </div>
          <button id="toggleGrid" class="active">Show Grid</button>
          <button id="exportState">Export State</button>
          <button id="addSection">â• Add Section</button>
          <div style="display: inline-flex; align-items: center; gap: 6px; margin-left: 12px; padding: 6px 12px; background: #fff3cd; border: 1px solid #ffc107; border-radius: 4px;">
            <span style="font-size: 12px; color: #856404; font-weight: 500;">Stress Test:</span>
            <input type="number" id="stressTestCount" value="50" min="1" max="200" style="width: 60px; padding: 4px 8px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
            <button id="addStressTest" style="padding: 4px 12px; background: #ffc107; color: #000; border: 1px solid #ffc107; border-radius: 3px; cursor: pointer; font-size: 12px; font-weight: 500;">Add Items</button>
            <button id="clearAll" style="padding: 4px 12px; background: #dc3545; color: white; border: 1px solid #dc3545; border-radius: 3px; cursor: pointer; font-size: 12px; font-weight: 500;">Clear All</button>
            <span id="itemCount" style="font-size: 11px; color: #666; margin-left: 4px;">0 items</span>
          </div>
          <div class="info-badge" style="display: inline-block; position: relative; padding: 6px 12px; background: #6610f2; color: white; border-radius: 4px; font-size: 12px; font-weight: 600; margin-left: 12px; cursor: help;">
            ğŸ¯ Moveable.js
            <div class="tooltip" style="position: absolute; top: 100%; right: 0; margin-top: 8px; padding: 16px; background: white; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); min-width: 300px; display: none; z-index: 1000; color: #333;">
              <div class="tooltip-section" style="margin-bottom: 12px;">
                <div class="tooltip-title" style="font-weight: 700; margin-bottom: 8px; color: #6610f2;">âœ… Moveable Provides:</div>
                <ul class="tooltip-list" style="list-style: none; padding: 0; margin: 0; font-size: 11px; line-height: 1.6;">
                  <li style="padding: 2px 0;">â€¢ Drag, resize, rotate, scale</li>
                  <li style="padding: 2px 0;">â€¢ Built-in snap-to-grid</li>
                  <li style="padding: 2px 0;">â€¢ Group selection</li>
                  <li style="padding: 2px 0;">â€¢ Guideline snapping</li>
                  <li style="padding: 2px 0;">â€¢ Transform-based positioning</li>
                  <li style="padding: 2px 0;">â€¢ Boundary constraints</li>
                </ul>
              </div>
              <div class="tooltip-section">
                <div class="tooltip-title" style="font-weight: 700; margin-bottom: 8px; color: #666;">ğŸ“Š vs Interact.js:</div>
                <ul class="tooltip-list" style="list-style: none; padding: 0; margin: 0; font-size: 11px; line-height: 1.6;">
                  <li style="padding: 2px 0;">â€¢ More high-level API</li>
                  <li style="padding: 2px 0;">â€¢ Built-in features (rotation, etc.)</li>
                  <li style="padding: 2px 0;">â€¢ Transform-based by default</li>
                  <li style="padding: 2px 0;">â€¢ Larger bundle (~100KB vs 60KB)</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="version-switcher">
            <span class="version-switcher-label">Version:</span>
            <select id="versionSelect" onchange="window.location.href = this.value">
              <option value="../left-top/">Left/Top</option>
              <option value="../transform/">Transform ğŸ§ª</option>
              <option value="../masonry/">Masonry ğŸ§ª</option>
              <option value="../virtual/">Virtual ğŸ§ª</option>
              <option value="../stencil/">StencilJS ğŸ§ª</option>
              <option value="../gridstack/">Gridstack ğŸ§ª</option>
              <option value="../moveable/" selected>Moveable ğŸ§ª</option>
              <option value="../grapesjs/">GrapesJS ğŸ§ª</option>
            </select>
          </div>
        </div>
      </div>

      <div class="canvases-container">
        <div class="canvas-item" data-canvas-id="canvas1">
          <div class="canvas-item-header">
            <h3>Section 1</h3>
            <div class="canvas-controls">
              <label>
                <input type="color" class="canvas-bg-color" data-canvas="canvas1" value="#ffffff">
              </label>
              <button class="clear-canvas-btn" data-canvas="canvas1">Clear</button>
              <button class="delete-section-btn" data-canvas="canvas1" title="Delete Section">ğŸ—‘ï¸</button>
            </div>
          </div>
          <div class="grid-builder">
            <div class="grid-container" id="canvas1" data-canvas-id="canvas1">
              <!-- Grid items will be added here -->
            </div>
          </div>
        </div>

        <div class="canvas-item" data-canvas-id="canvas2">
          <div class="canvas-item-header">
            <h3>Section 2</h3>
            <div class="canvas-controls">
              <label>
                <input type="color" class="canvas-bg-color" data-canvas="canvas2" value="#f5f5f5">
              </label>
              <button class="clear-canvas-btn" data-canvas="canvas2">Clear</button>
              <button class="delete-section-btn" data-canvas="canvas2" title="Delete Section">ğŸ—‘ï¸</button>
            </div>
          </div>
          <div class="grid-builder">
            <div class="grid-container" id="canvas2" data-canvas-id="canvas2">
              <!-- Grid items will be added here -->
            </div>
          </div>
        </div>

        <div class="canvas-item" data-canvas-id="canvas3">
          <div class="canvas-item-header">
            <h3>Section 3</h3>
            <div class="canvas-controls">
              <label>
                <input type="color" class="canvas-bg-color" data-canvas="canvas3" value="#ffffff">
              </label>
              <button class="clear-canvas-btn" data-canvas="canvas3">Clear</button>
              <button class="delete-section-btn" data-canvas="canvas3" title="Delete Section">ğŸ—‘ï¸</button>
            </div>
          </div>
          <div class="grid-builder">
            <div class="grid-container" id="canvas3" data-canvas-id="canvas3">
              <!-- Grid items will be added here -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="index.js"></script>
  <script>
    // Tooltip hover effects
    document.querySelectorAll('.info-badge').forEach(badge => {
      badge.addEventListener('mouseenter', () => {
        const tooltip = badge.querySelector('.tooltip');
        if (tooltip) tooltip.style.display = 'block';
      });
      badge.addEventListener('mouseleave', () => {
        const tooltip = badge.querySelector('.tooltip');
        if (tooltip) tooltip.style.display = 'none';
      });
    });
  </script>
</body>
</html>
