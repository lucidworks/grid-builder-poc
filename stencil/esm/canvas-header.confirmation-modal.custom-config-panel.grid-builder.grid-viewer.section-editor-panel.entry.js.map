{"version":3,"file":"canvas-header.confirmation-modal.custom-config-panel.grid-builder.grid-viewer.section-editor-panel.entry.js","sources":["src/demo/components/canvas-header/canvas-header.scss?tag=canvas-header","src/demo/components/canvas-header/canvas-header.tsx","src/demo/components/confirmation-modal/confirmation-modal.scss?tag=confirmation-modal","src/demo/components/confirmation-modal/confirmation-modal.tsx","src/demo/components/custom-config-panel/custom-config-panel.scss?tag=custom-config-panel","src/demo/components/custom-config-panel/custom-config-panel.tsx","src/components/grid-builder/grid-builder.scss?tag=grid-builder","src/components/grid-builder/grid-builder.tsx","src/components/grid-viewer/grid-viewer.scss?tag=grid-viewer","src/components/grid-viewer/grid-viewer.tsx","src/demo/components/section-editor-panel/section-editor-panel.scss?tag=section-editor-panel","src/demo/components/section-editor-panel/section-editor-panel.tsx"],"sourcesContent":["/**\n * Canvas Header Component Styles\n * ===============================\n *\n * Styling for canvas section headers with title badges and delete buttons.\n */\n\n.canvas-header {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  padding: 0;\n  margin: 0; /* No margin - flush with canvas */\n  gap: 8px;\n\n  /* All canvas headers except the first overlay the canvas above */\n  &:not(:first-of-type) {\n    margin-top: var(--canvas-header-overlay-margin, -28px); /* Grid-relative overlay (default 1.4 grid units @ 20px) */\n  }\n\n  .canvas-title {\n    display: inline-flex;\n    align-items: center;\n    padding: 6px 12px;\n    border-radius: 4px;\n    margin: 0;\n    background: #4a90e2;\n    box-shadow: 0 1px 3px rgba(74, 144, 226, 0.2);\n    color: white;\n    cursor: pointer;\n    font-size: 13px;\n    font-weight: 500;\n    text-transform: none;\n    transition: all 0.15s;\n\n    &:hover {\n      background: #357abd;\n      box-shadow: 0 2px 6px rgba(74, 144, 226, 0.3);\n    }\n  }\n\n  .canvas-actions {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n\n    .delete-canvas-btn {\n      display: flex;\n      width: 28px;\n      height: 28px;\n      align-items: center;\n      justify-content: center;\n      padding: 0;\n      border: 1px solid #dee2e6;\n      border-radius: 4px;\n      background: white;\n      color: #dc3545;\n      cursor: pointer;\n      font-size: 20px;\n      font-weight: 300;\n      line-height: 1;\n      transition: all 0.15s;\n\n      &:hover {\n        border-color: #dc3545;\n        background: rgba(220, 53, 69, 0.1);\n        transform: scale(1.1);\n      }\n\n      &:active {\n        transform: scale(1);\n      }\n    }\n  }\n}\n","/**\n * Canvas Header Component\n * =======================\n *\n * Displays a header bar above each canvas section with title and optional delete button.\n *\n * ## Purpose\n *\n * - Shows section title as clickable badge\n * - Provides delete button for non-default sections\n * - Emits events for user interactions\n *\n * ## Usage\n *\n * ```tsx\n * <canvas-header\n *   canvasId=\"hero-section\"\n *   title=\"Hero Section\"\n *   isDeletable={false}\n *   onHeaderClick={() => handleClick()}\n *   onDeleteClick={() => handleDelete()}\n * />\n * ```\n *\n * @module canvas-header\n */\n\nimport { Component, Event, EventEmitter, h, Prop } from '@stencil/core';\n\n/**\n * CanvasHeader Component\n * ======================\n *\n * Declarative header component for canvas sections.\n *\n * **Tag**: `<canvas-header>`\n * **Shadow DOM**: Disabled (matches blog-app styling)\n */\n@Component({\n  tag: 'canvas-header',\n  styleUrl: 'canvas-header.scss',\n  shadow: false,\n})\nexport class CanvasHeader {\n  /**\n   * Canvas ID for data tracking\n   *\n   * **Purpose**: Identify which canvas this header belongs to\n   * **Required**: Yes\n   */\n  @Prop() canvasId!: string;\n\n  /**\n   * Display title for the canvas section\n   *\n   * **Purpose**: Text shown in the title badge\n   * **Required**: Yes\n   * **Note**: Named sectionTitle to avoid conflict with standard HTML title attribute\n   */\n  @Prop() sectionTitle!: string;\n\n  /**\n   * Whether this section can be deleted\n   *\n   * **Purpose**: Control delete button visibility\n   * **Default**: true\n   * **Note**: Default sections (hero, articles, footer) should set to false\n   */\n  @Prop() isDeletable: boolean = true;\n\n  /**\n   * Event emitted when header title is clicked\n   *\n   * **Detail**: { canvasId: string }\n   * **Use case**: Activate canvas and open section editor\n   */\n  @Event() headerClick: EventEmitter<{ canvasId: string }>;\n\n  /**\n   * Event emitted when delete button is clicked\n   *\n   * **Detail**: { canvasId: string }\n   * **Use case**: Delete the canvas section\n   */\n  @Event() deleteClick: EventEmitter<{ canvasId: string }>;\n\n  /**\n   * Handle title click\n   */\n  private handleTitleClick = () => {\n    this.headerClick.emit({ canvasId: this.canvasId });\n  };\n\n  /**\n   * Handle delete button click\n   */\n  private handleDeleteClick = () => {\n    this.deleteClick.emit({ canvasId: this.canvasId });\n  };\n\n  /**\n   * Render component template\n   */\n  render() {\n    return (\n      <div class=\"canvas-header\" data-canvas-id={this.canvasId}>\n        <div class=\"canvas-actions\">\n          {/* Section title badge (clickable) */}\n          <span class=\"canvas-title\" onClick={this.handleTitleClick}>\n            {this.sectionTitle}\n          </span>\n\n          {/* Delete button (optional) */}\n          {this.isDeletable && (\n            <button\n              class=\"delete-canvas-btn\"\n              title=\"Delete this section\"\n              onClick={this.handleDeleteClick}\n            >\n              Ã—\n            </button>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","confirmation-modal {\n  .confirmation-overlay {\n    position: fixed;\n    z-index: 10000;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    animation: fadeIn 0.2s ease-out;\n    background: rgba(0, 0, 0, 0.5);\n  }\n\n  .confirmation-modal {\n    width: 90%;\n    max-width: 400px;\n    border-radius: 8px;\n    animation: slideUp 0.2s ease-out;\n    background: white;\n    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n  }\n\n  .modal-header {\n    padding: 20px 24px;\n    border-bottom: 1px solid #e9ecef;\n\n    .modal-title {\n      margin: 0;\n      color: #212529;\n      font-size: 18px;\n      font-weight: 600;\n    }\n  }\n\n  .modal-body {\n    padding: 24px;\n\n    .modal-message {\n      margin: 0;\n      color: #495057;\n      font-size: 14px;\n      line-height: 1.5;\n    }\n  }\n\n  .modal-footer {\n    display: flex;\n    justify-content: flex-end;\n    padding: 16px 24px;\n    border-top: 1px solid #e9ecef;\n    gap: 12px;\n\n    button {\n      padding: 8px 16px;\n      border: none;\n      border-radius: 4px;\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 500;\n      transition: all 0.15s;\n\n      &.cancel-btn {\n        background: #f8f9fa;\n        color: #495057;\n\n        &:hover {\n          background: #e9ecef;\n        }\n      }\n\n      &.confirm-btn {\n        background: #dc3545;\n        color: white;\n\n        &:hover {\n          background: #c82333;\n        }\n      }\n    }\n  }\n\n  @keyframes fadeIn {\n    from {\n      opacity: 0;\n    }\n    to {\n      opacity: 1;\n    }\n  }\n\n  @keyframes slideUp {\n    from {\n      opacity: 0;\n      transform: translateY(20px);\n    }\n    to {\n      opacity: 1;\n      transform: translateY(0);\n    }\n  }\n}\n","import { Component, h, Prop, Event, EventEmitter } from '@stencil/core';\nimport { ConfirmationModalData } from '../../types/confirmation-modal-data';\n\n/**\n * Confirmation Modal Component\n * =============================\n *\n * Demo Component - NOT Part of Library\n *\n * This component demonstrates how to implement the grid-builder library's\n * deletion hook system with a custom confirmation modal.\n *\n * Library Feature Being Demonstrated:\n * -----------------------------------\n * This modal is used with the library's **onBeforeDelete hook** system.\n *\n * How It Works:\n * -------------\n * 1. Library calls onBeforeDelete hook when user deletes component\n * 2. Hook returns a Promise that doesn't resolve immediately\n * 3. Host app shows this modal (or any modal library)\n * 4. User clicks \"Delete\" or \"Cancel\"\n * 5. Modal fires confirm/cancel event\n * 6. Host app resolves Promise with true/false\n * 7. Library proceeds with or cancels deletion\n *\n * Code Flow Example:\n * ------------------\n * ```typescript\n * // In parent component (blog-app.tsx):\n * private handleBeforeDelete = (context: DeletionHookContext): Promise<boolean> => {\n *   return new Promise((resolve) => {\n *     this.deleteResolve = resolve;\n *     this.isConfirmModalOpen = true;  // Show this modal\n *   });\n * };\n *\n * private handleConfirmDelete = () => {\n *   this.deleteResolve(true);   // Tell library to proceed\n * };\n *\n * private handleCancelDelete = () => {\n *   this.deleteResolve(false);  // Tell library to cancel\n * };\n * ```\n *\n * Why This Pattern:\n * -----------------\n * - **Library agnostic**: Library doesn't provide modal UI\n * - **Flexibility**: Use any modal library (Material, Bootstrap, Ant Design, etc.)\n * - **Customization**: Full control over modal appearance and behavior\n * - **Async support**: Can make API calls before resolving\n *\n * Alternative Implementations:\n * ---------------------------\n * You could replace this component with:\n * - Material Design modal\n * - Bootstrap modal\n * - Ant Design modal\n * - Native browser confirm() (not recommended)\n * - Custom modal from your design system\n *\n * The library doesn't care what modal you use - it just waits for the\n * Promise to resolve with true/false.\n */\n@Component({\n  tag: 'confirmation-modal',\n  styleUrl: 'confirmation-modal.scss',\n  shadow: false,\n})\nexport class ConfirmationModal {\n  /**\n   * Modal open/closed state\n   * Controlled by parent component (blog-app)\n   */\n  @Prop() isOpen: boolean = false;\n\n  /**\n   * Modal content (title and message)\n   * Passed from parent when showing confirmation\n   */\n  @Prop() data: ConfirmationModalData | null = null;\n\n  /**\n   * Event: User confirmed deletion\n   * Parent resolves deletion hook Promise with `true`\n   */\n  @Event() confirm: EventEmitter<void>;\n\n  /**\n   * Event: User cancelled deletion\n   * Parent resolves deletion hook Promise with `false`\n   */\n  @Event() cancel: EventEmitter<void>;\n\n  /**\n   * Handle Confirm Button Click\n   * ----------------------------\n   * Fires confirm event â†’ Parent resolves Promise(true) â†’ Library deletes component\n   */\n  private handleConfirm = () => {\n    this.confirm.emit();\n  };\n\n  /**\n   * Handle Cancel Button Click\n   * ---------------------------\n   * Fires cancel event â†’ Parent resolves Promise(false) â†’ Library cancels deletion\n   */\n  private handleCancel = () => {\n    this.cancel.emit();\n  };\n\n  render() {\n    if (!this.isOpen || !this.data) {\n      return null;\n    }\n\n    return (\n      <div class=\"confirmation-overlay\" onClick={this.handleCancel}>\n        <div class=\"confirmation-modal\" onClick={(e) => e.stopPropagation()}>\n          <div class=\"modal-header\">\n            <h2 class=\"modal-title\">{this.data.title}</h2>\n          </div>\n\n          <div class=\"modal-body\">\n            <p class=\"modal-message\">{this.data.message}</p>\n          </div>\n\n          <div class=\"modal-footer\">\n            <button class=\"cancel-btn\" onClick={this.handleCancel}>\n              Cancel\n            </button>\n            <button class=\"confirm-btn\" onClick={this.handleConfirm}>\n              Delete\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","/**\n * Custom Config Panel Styles\n * ===========================\n *\n * Custom styling for the blog demo config panel.\n * Demonstrates how to match the panel UI to your app's branding.\n */\n\n.custom-config-panel {\n  position: fixed;\n  right: 0;\n  bottom: 0;\n  width: 400px;\n  max-width: 90vw;\n  max-height: 80vh;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  border-radius: 12px 0 0 0;\n  box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);\n  display: flex;\n  flex-direction: column;\n  z-index: 1000;\n  transform: translateY(100%);\n  transition: transform 0.3s ease-in-out;\n  overflow: hidden;\n\n  &.panel-open {\n    transform: translateY(0);\n  }\n}\n\n.custom-panel-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px 24px;\n  background: rgba(255, 255, 255, 0.1);\n  backdrop-filter: blur(10px);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.2);\n\n  .header-content {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    color: #ffffff;\n\n    .component-icon {\n      font-size: 24px;\n      line-height: 1;\n    }\n\n    h2 {\n      margin: 0;\n      font-size: 20px;\n      font-weight: 600;\n      color: #ffffff;\n    }\n  }\n\n  .close-btn {\n    background: rgba(255, 255, 255, 0.2);\n    border: none;\n    color: #ffffff;\n    width: 32px;\n    height: 32px;\n    border-radius: 50%;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 20px;\n    transition: all 0.2s ease;\n\n    &:hover {\n      background: rgba(255, 255, 255, 0.3);\n      transform: scale(1.1);\n    }\n\n    &:active {\n      transform: scale(0.95);\n    }\n  }\n}\n\n.custom-panel-body {\n  flex: 1;\n  overflow-y: auto;\n  padding: 24px;\n  background: #ffffff;\n\n  .config-section {\n    margin-bottom: 24px;\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n\n    .section-label {\n      display: block;\n      font-size: 14px;\n      font-weight: 600;\n      color: #374151;\n      margin-bottom: 8px;\n      text-transform: uppercase;\n      letter-spacing: 0.5px;\n    }\n\n    &.info-section {\n      background: #f9fafb;\n      border-radius: 8px;\n      padding: 16px;\n\n      .info-row {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 8px 0;\n        border-bottom: 1px solid #e5e7eb;\n\n        &:last-child {\n          border-bottom: none;\n          padding-bottom: 0;\n        }\n\n        &:first-child {\n          padding-top: 0;\n        }\n\n        .info-label {\n          font-size: 13px;\n          font-weight: 500;\n          color: #6b7280;\n        }\n\n        .info-value {\n          font-size: 13px;\n          color: #1f2937;\n          font-family: 'Monaco', 'Menlo', monospace;\n          background: #ffffff;\n          padding: 4px 8px;\n          border-radius: 4px;\n        }\n      }\n    }\n  }\n\n  .config-field {\n    margin-bottom: 16px;\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n\n    .field-label {\n      display: block;\n      font-size: 13px;\n      font-weight: 500;\n      color: #4b5563;\n      margin-bottom: 6px;\n    }\n  }\n\n  .text-input {\n    width: 100%;\n    padding: 10px 12px;\n    border: 2px solid #e5e7eb;\n    border-radius: 6px;\n    font-size: 14px;\n    color: #1f2937;\n    transition: all 0.2s ease;\n\n    &:focus {\n      outline: none;\n      border-color: #667eea;\n      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);\n    }\n\n    &:disabled {\n      background: #f9fafb;\n      color: #9ca3af;\n      cursor: not-allowed;\n    }\n\n    &::placeholder {\n      color: #9ca3af;\n    }\n  }\n\n  .select-input {\n    width: 100%;\n    padding: 10px 12px;\n    border: 2px solid #e5e7eb;\n    border-radius: 6px;\n    font-size: 14px;\n    color: #1f2937;\n    background: #ffffff;\n    cursor: pointer;\n    transition: all 0.2s ease;\n\n    &:focus {\n      outline: none;\n      border-color: #667eea;\n      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);\n    }\n  }\n\n  .checkbox-label {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    cursor: pointer;\n    user-select: none;\n\n    input[type='checkbox'] {\n      width: 18px;\n      height: 18px;\n      cursor: pointer;\n      accent-color: #667eea;\n    }\n\n    .checkbox-text {\n      font-size: 14px;\n      color: #4b5563;\n    }\n  }\n\n  .color-input-wrapper {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n\n    .color-input {\n      width: 60px;\n      height: 40px;\n      border: 2px solid #e5e7eb;\n      border-radius: 6px;\n      cursor: pointer;\n      transition: all 0.2s ease;\n\n      &:hover {\n        border-color: #667eea;\n      }\n    }\n\n    .color-value {\n      font-size: 13px;\n      font-family: 'Monaco', 'Menlo', monospace;\n      color: #6b7280;\n      background: #f9fafb;\n      padding: 8px 12px;\n      border-radius: 4px;\n    }\n  }\n\n  .no-config-message {\n    text-align: center;\n    color: #9ca3af;\n    font-size: 14px;\n    padding: 24px;\n    margin: 0;\n  }\n\n  .field-error {\n    color: #ef4444;\n    font-size: 13px;\n    margin: 0;\n    padding: 8px;\n    background: #fef2f2;\n    border-radius: 4px;\n  }\n}\n\n.custom-panel-footer {\n  display: flex;\n  gap: 12px;\n  padding: 20px 24px;\n  background: #f9fafb;\n  border-top: 1px solid #e5e7eb;\n\n  .btn {\n    flex: 1;\n    padding: 12px 20px;\n    border: none;\n    border-radius: 8px;\n    font-size: 14px;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.2s ease;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n\n    &:active {\n      transform: translateY(1px);\n    }\n\n    &.btn-secondary {\n      background: #ffffff;\n      color: #6b7280;\n      border: 2px solid #e5e7eb;\n\n      &:hover {\n        background: #f9fafb;\n        border-color: #d1d5db;\n      }\n    }\n\n    &.btn-primary {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: #ffffff;\n      box-shadow: 0 4px 6px rgba(102, 126, 234, 0.3);\n\n      &:hover {\n        box-shadow: 0 6px 12px rgba(102, 126, 234, 0.4);\n        transform: translateY(-2px);\n      }\n\n      &:active {\n        transform: translateY(0);\n        box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);\n      }\n    }\n  }\n}\n\n/* Mobile responsive */\n@media (max-width: 768px) {\n  .custom-config-panel {\n    width: 100%;\n    max-width: 100vw;\n    max-height: 70vh;\n    border-radius: 12px 12px 0 0;\n  }\n}\n","/**\n * Custom Config Panel (Demo Component)\n * ======================================\n *\n * Custom configuration panel for the blog demo app.\n * Demonstrates how to create an external config panel that works alongside grid-builder.\n *\n * **Key Features**:\n * - Custom styling to match blog theme (purple gradient)\n * - Auto-close when selected item is deleted (via itemRemoved event)\n * - Uses manual event listeners for item-click events (Stencil @Listen doesn't work for custom events)\n * - Receives GridBuilderAPI as a prop from parent component\n * - Demonstrates proper event subscription/unsubscription pattern\n *\n * **API Access Pattern**:\n * - Parent (blog-app) stores API on component instance via api-ref={{ target: this, key: 'api' }}\n * - Parent passes API to this component via api prop\n * - This allows multiple grid-builder instances without window pollution\n */\n\nimport { Component, h, State, Prop, Watch } from '@stencil/core';\nimport { blogComponentDefinitions } from '../../component-definitions';\nimport { GridBuilderAPI } from '../../../types/api';\n\n@Component({\n  tag: 'custom-config-panel',\n  styleUrl: 'custom-config-panel.scss',\n  shadow: false,\n})\nexport class CustomConfigPanel {\n  /**\n   * Grid Builder API (accessed from window.gridBuilderAPI or passed as prop)\n   *\n   * **Source**: window.gridBuilderAPI (set by grid-builder component)\n   * **Purpose**: Access grid state and methods\n   * **Required**: Component won't work without valid API reference\n   */\n  @Prop() api?: GridBuilderAPI;\n\n  /**\n   * Panel open/closed state\n   */\n  @State() isOpen: boolean = false;\n\n  /**\n   * Currently selected item ID\n   */\n  @State() selectedItemId: string | null = null;\n\n  /**\n   * Currently selected canvas ID\n   */\n  @State() selectedCanvasId: string | null = null;\n\n  /**\n   * Component config (temporary edit state)\n   */\n  @State() componentConfig: Record<string, any> = {};\n\n  /**\n   * Component name (temporary edit state)\n   */\n  @State() componentName: string = '';\n\n  /**\n   * Original state for cancel functionality\n   */\n  private originalState: {\n    name: string;\n    zIndex: number;\n    config: Record<string, any>;\n  } | null = null;\n\n  /**\n   * Component registry (from blog component definitions)\n   */\n  private componentRegistry: Map<string, any> = new Map();\n\n  /**\n   * Flag to track if we've subscribed to events\n   */\n  private eventsSubscribed: boolean = false;\n\n  /**\n   * Callback for itemRemoved event (stored for unsubscribe)\n   */\n  private handleItemRemoved = (event: { itemId: string; canvasId: string }) => {\n    console.log('ðŸŽ¨ custom-config-panel received itemRemoved event', {\n      eventItemId: event.itemId,\n      selectedItemId: this.selectedItemId,\n      isOpen: this.isOpen,\n    });\n\n    // Close panel if the deleted item is the currently selected one\n    if (this.isOpen && this.selectedItemId && event.itemId === this.selectedItemId) {\n      console.log('  âœ… Custom panel: Closing because selected item was deleted');\n      this.closePanel();\n    }\n  };\n\n  /**\n   * Get API (from prop or window)\n   */\n  private getAPI(): GridBuilderAPI | null {\n    // Use prop if provided, otherwise try window\n    return this.api || (window as any).gridBuilderAPI || null;\n  }\n\n  /**\n   * Ensure event subscription is set up (lazy initialization)\n   */\n  private ensureEventSubscription() {\n    if (this.eventsSubscribed) {\n      return;\n    }\n\n    const api = this.getAPI();\n    if (!api) {\n      return; // API not ready yet, will try again later\n    }\n\n    // Subscribe to itemRemoved events via API\n    api.on('itemRemoved', this.handleItemRemoved);\n    this.eventsSubscribed = true;\n    console.log('  âœ… Custom panel: Subscribed to itemRemoved event');\n  }\n\n  /**\n   * Watch for API prop changes\n   */\n  @Watch('api')\n  handleApiChange(newApi: GridBuilderAPI, oldApi: GridBuilderAPI) {\n    console.log('ðŸŽ¨ custom-config-panel API prop changed', {\n      hadOldApi: !!oldApi,\n      hasNewApi: !!newApi,\n      newApiType: typeof newApi,\n    });\n\n    // When API becomes available, ensure event subscription\n    if (newApi && !this.eventsSubscribed) {\n      this.ensureEventSubscription();\n    }\n  }\n\n  componentDidLoad() {\n    console.log('ðŸŽ¨ custom-config-panel componentDidLoad - setting up component registry');\n    const api = this.getAPI();\n    console.log('  ðŸ”§ API status:', {\n      apiExists: !!api,\n      apiType: typeof api,\n      fromProp: !!this.api,\n      fromWindow: !!(window as any).gridBuilderAPI,\n    });\n\n    // Build component registry from blog component definitions\n    // This doesn't depend on the API being available\n    this.componentRegistry = new Map(\n      blogComponentDefinitions.map(def => [def.type, def])\n    );\n\n    // Try to subscribe to events (will retry on first item click if API not ready)\n    this.ensureEventSubscription();\n\n    // Listen for item-click events\n    // Note: Stencil's @Listen decorator doesn't work reliably for custom events on document\n    // so we use manual event listeners instead\n    document.addEventListener('item-click', this.handleItemClick as EventListener);\n    console.log('  âœ… Custom panel: Listening for item-click events');\n  }\n\n  disconnectedCallback() {\n    console.log('ðŸŽ¨ custom-config-panel disconnectedCallback - cleaning up');\n\n    // Unsubscribe from itemRemoved events\n    const api = this.getAPI();\n    if (api && this.eventsSubscribed) {\n      api.off('itemRemoved', this.handleItemRemoved);\n      this.eventsSubscribed = false;\n    }\n\n    // Remove item-click event listener\n    document.removeEventListener('item-click', this.handleItemClick as EventListener);\n  }\n\n  /**\n   * Handle item-click events from the document\n   */\n  private handleItemClick = (event: CustomEvent) => {\n    console.log('ðŸŽ¨ custom-config-panel handleItemClick called', event.detail);\n\n    // Ensure event subscription is set up (retry if it failed in componentDidLoad)\n    this.ensureEventSubscription();\n\n    const { itemId, canvasId } = event.detail;\n    this.selectedItemId = itemId;\n    this.selectedCanvasId = canvasId;\n\n    // Get item from API\n    const api = this.getAPI();\n    console.log('  ðŸ”§ API exists:', !!api);\n\n    const item = api?.getItem(itemId);\n    console.log('  ðŸ”§ Item retrieved:', !!item, item);\n\n    if (!item) {\n      console.log('  âŒ No item found - exiting');\n      return;\n    }\n\n    // Get component definition\n    const definition = this.componentRegistry.get(item.type);\n    console.log('  ðŸ”§ Definition found:', !!definition, definition?.name);\n\n    // Save original state for cancel functionality\n    this.originalState = {\n      name: item.name || definition?.name || item.type,\n      zIndex: item.zIndex,\n      config: item.config ? { ...item.config } : {},\n    };\n\n    // Populate form\n    this.componentName = this.originalState.name;\n    this.componentConfig = { ...this.originalState.config };\n\n    // Open panel\n    console.log('  ðŸšª Opening panel - setting isOpen = true');\n    this.isOpen = true;\n    console.log('  âœ… Panel should now be open, isOpen =', this.isOpen);\n  }\n\n  /**\n   * Close panel and revert changes\n   */\n  private closePanel = () => {\n    // Revert changes on cancel by restoring original state\n    const api = this.getAPI();\n    if (this.selectedItemId && this.selectedCanvasId && this.originalState && api) {\n      // Revert config changes\n      api.updateConfig(this.selectedItemId, this.originalState.config);\n\n      // Revert name changes\n      const state = api.getState();\n      for (const canvasId in state.canvases) {\n        const canvas = state.canvases[canvasId];\n        const itemIndex = canvas.items.findIndex(i => i.id === this.selectedItemId);\n        if (itemIndex !== -1) {\n          canvas.items[itemIndex] = {\n            ...canvas.items[itemIndex],\n            name: this.originalState.name\n          };\n          // Trigger reactivity\n          state.canvases = { ...state.canvases };\n          break;\n        }\n      }\n    }\n\n    this.isOpen = false;\n    this.selectedItemId = null;\n    this.selectedCanvasId = null;\n    this.componentName = '';\n    this.componentConfig = {};\n    this.originalState = null;\n  };\n\n  /**\n   * Save config changes\n   */\n  private saveConfig = () => {\n    // Changes are already applied live, so just close without reverting\n    this.isOpen = false;\n    this.selectedItemId = null;\n    this.selectedCanvasId = null;\n    this.componentName = '';\n    this.componentConfig = {};\n    this.originalState = null;\n  };\n\n  /**\n   * Handle component name change\n   */\n  private handleNameChange = (event: Event) => {\n    const value = (event.target as HTMLInputElement).value;\n    this.componentName = value;\n\n    // Update the item name (live preview)\n    const api = this.getAPI();\n    if (this.selectedItemId && api) {\n      // Get the full state to access canvases\n      const state = api.getState();\n\n      // Find and update the item across all canvases\n      for (const canvasId in state.canvases) {\n        const canvas = state.canvases[canvasId];\n        const itemIndex = canvas.items.findIndex(i => i.id === this.selectedItemId);\n        if (itemIndex !== -1) {\n          // Update the name property\n          canvas.items[itemIndex] = {\n            ...canvas.items[itemIndex],\n            name: value\n          };\n          // Trigger reactivity by reassigning canvases object\n          state.canvases = { ...state.canvases };\n          break;\n        }\n      }\n    }\n  };\n\n  /**\n   * Handle config field change\n   */\n  private handleConfigChange = (fieldName: string, value: any) => {\n    // Update local config state\n    this.componentConfig = { ...this.componentConfig, [fieldName]: value };\n\n    // Apply changes immediately (live preview) via API\n    const api = this.getAPI();\n    if (this.selectedItemId && api) {\n      api.updateConfig(this.selectedItemId, this.componentConfig);\n    }\n  };\n\n  render() {\n    if (!this.isOpen) {\n      return null;\n    }\n\n    // Get item from API\n    const api = this.getAPI();\n    const item = api?.getItem(this.selectedItemId);\n    if (!item) {\n      return null;\n    }\n\n    const definition = this.componentRegistry.get(item.type);\n    if (!definition) {\n      return null;\n    }\n\n    const panelClasses = {\n      'custom-config-panel': true,\n      'panel-open': this.isOpen,\n    };\n\n    return (\n      <div class={panelClasses}>\n        <div class=\"custom-panel-header\">\n          <div class=\"header-content\">\n            <span class=\"component-icon\">{definition.icon}</span>\n            <h2>Edit Component</h2>\n          </div>\n          <button\n            class=\"close-btn\"\n            onClick={() => this.closePanel()}\n            title=\"Close\"\n          >\n            âœ•\n          </button>\n        </div>\n\n        <div class=\"custom-panel-body\">\n          {/* Component Name */}\n          <div class=\"config-section\">\n            <label class=\"section-label\">Component Name</label>\n            <input\n              type=\"text\"\n              class=\"text-input\"\n              value={this.componentName}\n              placeholder=\"Enter component name\"\n              onInput={(e) => this.handleNameChange(e)}\n            />\n          </div>\n\n          {/* Component Type Info */}\n          <div class=\"config-section info-section\">\n            <div class=\"info-row\">\n              <span class=\"info-label\">Type:</span>\n              <span class=\"info-value\">{definition.name}</span>\n            </div>\n            <div class=\"info-row\">\n              <span class=\"info-label\">ID:</span>\n              <span class=\"info-value\">{item.id}</span>\n            </div>\n          </div>\n\n          {/* Config Fields */}\n          {definition.configSchema && definition.configSchema.length > 0 ? (\n            <div class=\"config-section\">\n              <label class=\"section-label\">Configuration</label>\n              {definition.configSchema.map((field: any) => (\n                <div class=\"config-field\" key={field.name}>\n                  <label class=\"field-label\">{field.label}</label>\n                  {this.renderConfigField(field)}\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div class=\"config-section\">\n              <p class=\"no-config-message\">\n                No configuration options available for this component.\n              </p>\n            </div>\n          )}\n        </div>\n\n        <div class=\"custom-panel-footer\">\n          <button\n            class=\"btn btn-secondary\"\n            onClick={() => this.closePanel()}\n          >\n            Cancel\n          </button>\n          <button\n            class=\"btn btn-primary\"\n            onClick={() => this.saveConfig()}\n          >\n            Save Changes\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  /**\n   * Render a single config field\n   */\n  private renderConfigField(field: any) {\n    const value = this.componentConfig[field.name] ?? field.defaultValue ?? '';\n\n    switch (field.type) {\n      case 'text':\n      case 'textarea':\n        return (\n          <input\n            type=\"text\"\n            class=\"text-input\"\n            value={value}\n            onInput={(e) => this.handleConfigChange(field.name, (e.target as HTMLInputElement).value)}\n            placeholder={field.placeholder}\n          />\n        );\n\n      case 'number':\n        return (\n          <input\n            type=\"number\"\n            class=\"text-input\"\n            value={value}\n            onInput={(e) => this.handleConfigChange(field.name, Number((e.target as HTMLInputElement).value))}\n            min={field.min}\n            max={field.max}\n            step={field.step}\n          />\n        );\n\n      case 'select':\n        return (\n          <select\n            class=\"select-input\"\n            onChange={(e) => this.handleConfigChange(field.name, (e.target as HTMLSelectElement).value)}\n          >\n            {field.options?.map((option: any) => {\n              const optionValue = typeof option === 'string' ? option : option.value;\n              const optionLabel = typeof option === 'string' ? option : option.label;\n              return (\n                <option key={optionValue} value={optionValue} selected={value === optionValue}>\n                  {optionLabel}\n                </option>\n              );\n            })}\n          </select>\n        );\n\n      case 'checkbox':\n        return (\n          <label class=\"checkbox-label\">\n            <input\n              type=\"checkbox\"\n              checked={!!value}\n              onChange={(e) => this.handleConfigChange(field.name, (e.target as HTMLInputElement).checked)}\n            />\n            <span class=\"checkbox-text\">{field.label}</span>\n          </label>\n        );\n\n      case 'color':\n        return (\n          <div class=\"color-input-wrapper\">\n            <input\n              type=\"color\"\n              class=\"color-input\"\n              value={value}\n              onInput={(e) => this.handleConfigChange(field.name, (e.target as HTMLInputElement).value)}\n            />\n            <span class=\"color-value\">{value}</span>\n          </div>\n        );\n\n      default:\n        return <p class=\"field-error\">Unknown field type: {field.type}</p>;\n    }\n  }\n}\n","/**\n * Grid Builder Styles\n * ====================\n *\n * Main styles for the grid builder library component.\n * Uses CSS variables for theming support.\n */\n\n:host {\n  // Theme CSS variables with defaults\n  --grid-builder-primary-color: #007bff;\n  --grid-builder-palette-bg: #f5f5f5;\n  --grid-builder-canvas-bg: #ffffff;\n  --grid-builder-grid-line-color: rgba(0, 0, 0, 0.1);\n  --grid-builder-selection-color: #007bff;\n  --grid-builder-resize-handle-color: #007bff;\n  --grid-builder-font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell',\n    'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;\n\n  display: block;\n  width: 100%;\n  height: 100%;\n  font-family: var(--grid-builder-font-family);\n}\n\n.grid-builder-container {\n  position: relative;\n  display: flex;\n  width: 100%;\n  height: 100%;\n}\n\n.palette-area {\n  width: 250px;\n  flex-shrink: 0;\n  border-right: 1px solid #ddd;\n  background: var(--grid-builder-palette-bg);\n  overflow-y: auto;\n}\n\n.canvas-area {\n  position: relative;\n  flex: 1;\n  background: var(--grid-builder-canvas-bg);\n  overflow-y: auto;\n}\n\n.canvases-container {\n  display: flex;\n  flex-direction: column;\n  min-height: 100%;\n  gap: 0; /* No gaps between canvas sections */\n}\n\n.config-area {\n  position: fixed;\n  z-index: 1000;\n  right: 0;\n  bottom: 0;\n  display: none; // Hidden by default, shown when item selected\n  width: 350px;\n  max-height: 60%;\n  border: 1px solid #ddd;\n  border-radius: 8px 8px 0 0;\n  background: white;\n  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);\n\n  &.visible {\n    display: block;\n  }\n}\n","/**\n * Grid Builder - Main Library Component\n * =======================================\n *\n * Main entry point for the grid builder library. Accepts component definitions,\n * configuration, and customization options via props to create a fully functional\n * drag-and-drop page builder.\n *\n * ## Library Design Philosophy\n *\n * **Consumer-driven configuration**:\n * - Library provides infrastructure (drag/drop, undo/redo, state management)\n * - Consumer provides content (component types, initial layout, styling)\n * - Clean separation of concerns\n * - Maximum flexibility\n *\n * **Props-based API**:\n * ```typescript\n * <grid-builder\n *   components={componentDefinitions}     // Required: Component type registry\n *   config={gridConfig}                   // Optional: Grid system config\n *   theme={gridTheme}                     // Optional: Visual customization\n *   plugins={pluginInstances}             // Optional: Plugin extensions\n *   uiOverrides={customUIComponents}      // Optional: Custom UI rendering\n *   initialState={savedState}             // Optional: Restore saved layout\n * />\n * ```\n *\n * ## Component Lifecycle\n *\n * **Initialization flow**:\n * 1. componentWillLoad: Validate props, set defaults, restore initial state\n * 2. componentDidLoad: Initialize plugins, setup global dependencies, attach event listeners\n * 3. render: Render UI structure (palette, canvases, config panel)\n * 4. disconnectedCallback: Cleanup plugins, remove listeners, dispose resources\n *\n * **State management**:\n * - Uses global gridState from state-manager.ts\n * - Components subscribe via StencilJS reactivity\n * - Plugins access via GridBuilderAPI\n * - Clean separation of library vs consumer state\n *\n * @module grid-builder\n */\n\nimport { Component, Element, h, Host, Listen, Method, Prop, State, Watch } from '@stencil/core';\nimport interact from 'interactjs';\n\n// Type imports\nimport { ComponentDefinition } from '../../types/component-definition';\nimport { GridConfig } from '../../types/grid-config';\nimport { GridBuilderTheme } from '../../types/theme';\nimport { GridBuilderPlugin } from '../../types/plugin';\nimport { UIComponentOverrides } from '../../types/ui-overrides';\nimport { GridBuilderAPI } from '../../types/api';\nimport { DeletionHook } from '../../types/deletion-hook';\nimport { GridExport } from '../../types/grid-export';\n\n// Service imports\nimport { gridState, GridState, generateItemId, deleteItemsBatch, addItemsBatch, updateItemsBatch, setActiveCanvas, moveItemToCanvas } from '../../services/state-manager';\nimport { virtualRenderer } from '../../services/virtual-renderer';\nimport { eventManager } from '../../services/event-manager';\nimport { BatchAddCommand, BatchDeleteCommand, BatchUpdateConfigCommand, AddCanvasCommand, RemoveCanvasCommand, MoveItemCommand } from '../../services/undo-redo-commands';\nimport { undoRedo, undoRedoState } from '../../services/undo-redo';\n\n// Utility imports\nimport { pixelsToGridX, pixelsToGridY } from '../../utils/grid-calculations';\nimport { applyBoundaryConstraints, constrainPositionToCanvas, CANVAS_WIDTH_UNITS } from '../../utils/boundary-constraints';\nimport { createDebugLogger } from '../../utils/debug';\n\nconst debug = createDebugLogger('grid-builder');\n\n/**\n * GridBuilder Component\n * ======================\n *\n * Main library component providing complete grid builder functionality.\n *\n * **Tag**: `<grid-builder>`\n * **Shadow DOM**: Disabled (required for interact.js compatibility)\n * **Reactivity**: Listens to gridState changes via StencilJS store\n */\n@Component({\n  tag: 'grid-builder',\n  styleUrl: 'grid-builder.scss',\n  shadow: false, // Light DOM required for interact.js\n})\nexport class GridBuilder {\n  /**\n   * Component definitions registry\n   *\n   * **Required prop**: Array of ComponentDefinition objects\n   * **Purpose**: Defines available component types (header, text, button, etc.)\n   *\n   * **Each definition includes**:\n   * - type: Unique identifier (e.g., 'header', 'text-block')\n   * - name: Display name in palette\n   * - icon: Visual identifier (emoji recommended)\n   * - defaultSize: Initial size when dropped\n   * - render: Function returning component to render\n   * - configSchema: Optional auto-generated config form\n   * - renderConfigPanel: Optional custom config UI\n   * - Lifecycle hooks: onVisible, onHidden for virtual rendering\n   *\n   * **Example**:\n   * ```typescript\n   * const components = [\n   *   {\n   *     type: 'header',\n   *     name: 'Header',\n   *     icon: 'ðŸ“„',\n   *     defaultSize: { width: 20, height: 8 },\n   *     render: ({ itemId, config }) => (\n   *       <my-header itemId={itemId} config={config} />\n   *     ),\n   *     configSchema: [\n   *       { name: 'text', label: 'Text', type: 'text', defaultValue: 'Header' }\n   *     ]\n   *   }\n   * ];\n   * ```\n   */\n  @Prop() components!: ComponentDefinition[];\n\n  /**\n   * Grid configuration options\n   *\n   * **Optional prop**: Customizes grid system behavior\n   * **Default**: Standard 2% grid with 10px-50px constraints\n   *\n   * **Configuration options**:\n   * - gridSizePercent: Grid unit as % of width (default: 2)\n   * - minGridSize: Minimum size in pixels (default: 10)\n   * - maxGridSize: Maximum size in pixels (default: 50)\n   * - snapToGrid: Enable snap-to-grid (default: true)\n   * - showGridLines: Show visual grid (default: true)\n   * - minItemSize: Minimum item dimensions (default: { width: 5, height: 4 })\n   * - virtualRenderMargin: Pre-render margin (default: '20%')\n   *\n   * **Example**:\n   * ```typescript\n   * const config = {\n   *   gridSizePercent: 3,           // 3% grid (33 units per 100%)\n   *   minGridSize: 15,              // 15px minimum\n   *   maxGridSize: 60,              // 60px maximum\n   *   snapToGrid: true,\n   *   virtualRenderMargin: '30%'    // Aggressive pre-loading\n   * };\n   * ```\n   */\n  @Prop() config?: GridConfig;\n\n  /**\n   * Visual theme customization\n   *\n   * **Optional prop**: Customizes colors, fonts, and styling\n   * **Default**: Bootstrap-inspired blue theme\n   *\n   * **Theme options**:\n   * - primaryColor: Accent color (default: '#007bff')\n   * - paletteBackground: Palette sidebar color (default: '#f5f5f5')\n   * - canvasBackground: Canvas background (default: '#ffffff')\n   * - gridLineColor: Grid line color (default: 'rgba(0,0,0,0.1)')\n   * - selectionColor: Selection outline (default: '#007bff')\n   * - resizeHandleColor: Resize handle color (default: '#007bff')\n   * - fontFamily: UI font (default: system font stack)\n   * - customProperties: CSS variables for advanced theming\n   *\n   * **Example**:\n   * ```typescript\n   * const theme = {\n   *   primaryColor: '#ff6b6b',        // Brand red\n   *   paletteBackground: '#fff5f5',   // Light red\n   *   customProperties: {\n   *     '--text-color': '#ffffff',\n   *     '--border-radius': '8px'\n   *   }\n   * };\n   * ```\n   */\n  @Prop() theme?: GridBuilderTheme;\n\n  /**\n   * Plugin instances for extending functionality\n   *\n   * **Optional prop**: Array of GridBuilderPlugin instances\n   * **Purpose**: Add custom features, analytics, integrations\n   *\n   * **Plugin lifecycle**:\n   * 1. Library calls plugin.init(api) on componentDidLoad\n   * 2. Plugin subscribes to events, adds UI, etc.\n   * 3. Library calls plugin.destroy() on disconnectedCallback\n   *\n   * **Example**:\n   * ```typescript\n   * class AnalyticsPlugin implements GridBuilderPlugin {\n   *   name = 'analytics';\n   *\n   *   init(api: GridBuilderAPI) {\n   *     api.on('componentAdded', (e) => {\n   *       analytics.track('Component Added', { type: e.item.type });\n   *     });\n   *   }\n   *\n   *   destroy() {\n   *     // Cleanup\n   *   }\n   * }\n   *\n   * const plugins = [new AnalyticsPlugin()];\n   * ```\n   */\n  @Prop() plugins?: GridBuilderPlugin[];\n\n  /**\n   * Custom UI component overrides\n   *\n   * **Optional prop**: Replace default UI components\n   * **Purpose**: Fully customize visual appearance\n   *\n   * **Overridable components**:\n   * - ConfigPanel: Configuration panel UI\n   * - ComponentPalette: Component palette sidebar\n   * - Toolbar: Top toolbar with controls\n   *\n   * **Example**:\n   * ```typescript\n   * const uiOverrides = {\n   *   Toolbar: (props) => (\n   *     <div class=\"my-toolbar\">\n   *       <button onClick={props.onUndo}>Undo</button>\n   *       <button onClick={props.onRedo}>Redo</button>\n   *     </div>\n   *   )\n   * };\n   * ```\n   */\n  @Prop() uiOverrides?: UIComponentOverrides;\n\n  /**\n   * Initial state to restore\n   *\n   * **Optional prop**: Restore saved layout\n   * **Purpose**: Load previously saved grid state\n   *\n   * **State structure**: Same as gridState (canvases, viewport, etc.)\n   *\n   * **Example**:\n   * ```typescript\n   * const savedState = JSON.parse(localStorage.getItem('grid-state'));\n   * <grid-builder initialState={savedState} ... />\n   * ```\n   */\n  @Prop() initialState?: Partial<GridState>;\n\n  /**\n   * Canvas metadata storage (host app responsibility)\n   *\n   * **Optional prop**: Store canvas-level presentation metadata\n   * **Purpose**: Host app owns canvas metadata (titles, colors, settings)\n   *\n   * **Separation of concerns**:\n   * - Library owns placement state (items, layouts, zIndex)\n   * - Host app owns presentation state (colors, titles, custom metadata)\n   *\n   * **Structure**: Record<canvasId, any>\n   *\n   * **Example**:\n   * ```typescript\n   * const canvasMetadata = {\n   *   'hero-section': {\n   *     title: 'Hero Section',\n   *     backgroundColor: '#f0f4f8',\n   *     customSettings: { ... }\n   *   },\n   *   'articles-grid': {\n   *     title: 'Articles Grid',\n   *     backgroundColor: '#ffffff'\n   *   }\n   * };\n   * <grid-builder canvasMetadata={canvasMetadata} ... />\n   * ```\n   *\n   * **Use with canvas-click events**:\n   * - Library fires canvas-click event when canvas background clicked\n   * - Host app shows canvas settings panel\n   * - Host app updates canvasMetadata state\n   * - Library passes metadata to canvas-section via props\n   */\n  @Prop() canvasMetadata?: Record<string, any>;\n\n  /**\n   * Hook called before deleting a component\n   *\n   * **Optional prop**: Intercept deletion requests for custom workflows\n   * **Purpose**: Allow host app to show confirmation, make API calls, etc.\n   *\n   * **Hook behavior**:\n   * - Return `true` to proceed with deletion\n   * - Return `false` to cancel the deletion\n   * - Return a Promise for async operations (modals, API calls)\n   *\n   * **Example - Confirmation modal**:\n   * ```typescript\n   * const onBeforeDelete = async (context) => {\n   *   const confirmed = await showConfirmModal(\n   *     `Delete ${context.item.name}?`,\n   *     'This action cannot be undone.'\n   *   );\n   *   return confirmed;\n   * };\n   * <grid-builder onBeforeDelete={onBeforeDelete} ... />\n   * ```\n   *\n   * **Example - API call + confirmation**:\n   * ```typescript\n   * const onBeforeDelete = async (context) => {\n   *   // Show loading modal\n   *   const modal = showLoadingModal('Deleting...');\n   *\n   *   try {\n   *     // Make API call\n   *     await fetch(`/api/components/${context.itemId}`, {\n   *       method: 'DELETE'\n   *     });\n   *     modal.close();\n   *     return true; // Proceed with deletion\n   *   } catch (error) {\n   *     modal.close();\n   *     showErrorModal('Failed to delete component');\n   *     return false; // Cancel deletion\n   *   }\n   * };\n   * ```\n   *\n   * **Default behavior**: If not provided, components delete immediately\n   */\n  @Prop() onBeforeDelete?: DeletionHook;\n\n  /**\n   * Custom API exposure configuration\n   *\n   * **Optional prop**: Control where and how the Grid Builder API is exposed\n   * **Default**: `{ target: window, key: 'gridBuilderAPI' }`\n   * **Purpose**: Allows multiple grid-builder instances and flexible API access patterns\n   *\n   * **Options**:\n   * 1. **Custom key on window** (multiple instances):\n   * ```typescript\n   * <grid-builder api-ref={{ key: 'gridAPI1' }}></grid-builder>\n   * <grid-builder api-ref={{ key: 'gridAPI2' }}></grid-builder>\n   * // Access: window.gridAPI1, window.gridAPI2\n   * ```\n   *\n   * 2. **Custom storage object**:\n   * ```typescript\n   * const myStore = {};\n   * <grid-builder api-ref={{ target: myStore, key: 'api' }}></grid-builder>\n   * // Access: myStore.api\n   * ```\n   *\n   * 3. **Disable automatic exposure** (use ref instead):\n   * ```typescript\n   * <grid-builder api-ref={null}></grid-builder>\n   * // Access via ref: <grid-builder ref={el => this.api = el?.api}></grid-builder>\n   * ```\n   */\n  @Prop() apiRef?: { target?: any; key?: string } | null = { target: undefined, key: 'gridBuilderAPI' };\n\n  /**\n   * Component registry (internal state)\n   *\n   * **Purpose**: Map component type â†’ definition for lookup\n   * **Built from**: components prop\n   * **Used by**: grid-item-wrapper for dynamic rendering\n   *\n   * **Structure**: `{ 'header': ComponentDefinition, 'text': ComponentDefinition, ... }`\n   */\n  @State() private componentRegistry: Map<string, ComponentDefinition> = new Map();\n\n  /**\n   * Initialized plugins (internal state)\n   *\n   * **Purpose**: Track plugin instances for cleanup\n   * **Lifecycle**: Set in componentDidLoad, cleared in disconnectedCallback\n   */\n  @State() private initializedPlugins: GridBuilderPlugin[] = [];\n\n  /**\n   * GridBuilderAPI instance (internal state)\n   *\n   * **Purpose**: Provides API to plugins and external code\n   * **Lifecycle**: Created in componentDidLoad\n   */\n  private api?: GridBuilderAPI;\n\n  /**\n   * Host element reference\n   *\n   * **Purpose**: Access to host element for event listeners\n   */\n  @Element() private hostElement!: HTMLElement;\n\n  /**\n   * Event listener references for cleanup\n   */\n  private canvasDropHandler?: (e: Event) => void;\n  private canvasMoveHandler?: (e: Event) => void;\n  private canvasActivatedHandler?: (e: Event) => void;\n  private keyboardHandler?: (e: KeyboardEvent) => void;\n\n  /**\n   * ResizeObserver for container-based viewport switching\n   *\n   * **Purpose**: Automatically switch between desktop/mobile viewports based on container width\n   * **Breakpoint**: 768px (container width, not window width)\n   * **Cleanup**: disconnectedCallback() disconnects observer\n   */\n  private viewportResizeObserver?: ResizeObserver;\n\n  /**\n   * Component will load lifecycle\n   *\n   * **Purpose**: Validate props and initialize component registry\n   *\n   * **Validation**:\n   * - Components prop is required\n   * - Each component must have unique type\n   * - Basic structure validation\n   *\n   * **Registry building**:\n   * - Convert array to Map for O(1) lookups\n   * - Key = component type, Value = ComponentDefinition\n   *\n   * **Initial state restoration**:\n   * - If initialState provided, merge into gridState\n   * - Otherwise use empty canvases\n   */\n\n  /**\n   * Handle item deletion from grid-item-wrapper\n   * Internal event dispatched by grid-item-wrapper after user clicks delete\n   */\n  @Listen('grid-item:delete')\n  handleGridItemDelete(event: CustomEvent) {\n    debug.log('ðŸ—‘ï¸ @Listen(grid-item:delete) in grid-builder', {\n      detail: event.detail,\n    });\n\n    const { itemId } = event.detail;\n    if (itemId) {\n      debug.log('  âœ… Deleting item via API (with undo support):', itemId);\n      // Use API method instead of direct deleteItemsBatch to enable undo/redo\n      this.api?.deleteComponent(itemId);\n    }\n  }\n\n  componentWillLoad() {\n    // Validate required props\n    if (!this.components || this.components.length === 0) {\n      console.error('GridBuilder: components prop is required');\n      return;\n    }\n\n    // Build component registry\n    this.componentRegistry = new Map(\n      this.components.map(comp => [comp.type, comp])\n    );\n\n    // Validate unique component types\n    if (this.componentRegistry.size !== this.components.length) {\n      console.warn('GridBuilder: Duplicate component types detected');\n    }\n\n    // Expose interact.js globally (required for drag/drop handlers)\n    (window as any).interact = interact;\n\n    // Restore initial state if provided\n    if (this.initialState) {\n      Object.assign(gridState, this.initialState);\n    }\n  }\n\n  /**\n   * Component did load lifecycle\n   *\n   * **Purpose**: Initialize global dependencies and plugins\n   *\n   * **Initialization sequence**:\n   * 1. Expose virtualRenderer singleton globally\n   * 2. Create GridBuilderAPI instance\n   * 3. Initialize plugins via plugin.init(api)\n   * 4. Apply theme via CSS variables\n   * 5. Expose debug helpers\n   */\n  componentDidLoad() {\n    // Expose virtualRenderer singleton globally (for debugging)\n    (window as any).virtualRenderer = virtualRenderer;\n\n    // Create GridBuilderAPI instance\n    this.api = this.createAPI();\n\n    // Expose API based on apiRef configuration\n    debug.log('ðŸ”§ grid-builder exposing API', {\n      hasApiRef: !!this.apiRef,\n      apiRefKey: this.apiRef?.key,\n      hasTarget: !!this.apiRef?.target,\n      targetType: typeof this.apiRef?.target,\n      apiCreated: !!this.api,\n    });\n\n    if (this.apiRef && this.apiRef.key) {\n      const target = this.apiRef.target || window;\n      debug.log('  ðŸ“¤ Setting API on target', {\n        key: this.apiRef.key,\n        isWindow: target === window,\n        targetKeys: Object.keys(target).slice(0, 10), // Show first 10 keys\n      });\n      target[this.apiRef.key] = this.api;\n      debug.log('  âœ… API set on target -', {\n        key: this.apiRef.key,\n        apiNowExists: !!target[this.apiRef.key],\n      });\n    }\n\n    // Initialize plugins\n    if (this.plugins && this.plugins.length > 0) {\n      this.initializedPlugins = this.plugins.filter(plugin => {\n        try {\n          plugin.init(this.api!);\n          debug.log(`GridBuilder: Initialized plugin \"${plugin.name}\"`);\n          return true;\n        } catch (e) {\n          console.error(`GridBuilder: Failed to initialize plugin \"${plugin.name}\":`, e);\n          return false;\n        }\n      });\n    }\n\n    // Apply theme\n    if (this.theme) {\n      this.applyTheme(this.theme);\n    }\n\n    // Configure event debouncing\n    const debounceDelay = this.config?.eventDebounceDelay ?? 300;\n    eventManager.setDebounceDelay(debounceDelay);\n    debug.log(`GridBuilder: Event debounce delay set to ${debounceDelay}ms`);\n\n    // Debug helper\n    (window as any).debugInteractables = () => {\n      const interactables = (interact as any).interactables.list;\n      debug.log('Total interactables:', interactables.length);\n      interactables.forEach((interactable: any, index: number) => {\n        debug.log(`Interactable ${index}:`, {\n          target: interactable.target,\n          actions: interactable._actions,\n          options: interactable.options,\n        });\n      });\n    };\n\n    // Setup canvas drop event handler for palette items\n    this.canvasDropHandler = (event: Event) => {\n      const customEvent = event as CustomEvent;\n      const { canvasId, componentType, x, y } = customEvent.detail;\n\n      debug.log('ðŸŽ¯ canvas-drop event received:', { canvasId, componentType, x, y });\n\n      // Get component definition to determine default size\n      const definition = this.componentRegistry.get(componentType);\n      if (!definition) {\n        console.warn(`Component definition not found for type: ${componentType}`);\n        return;\n      }\n\n      // Convert pixel position to grid units\n      const gridX = pixelsToGridX(x, canvasId, this.config);\n      const gridY = pixelsToGridY(y, this.config);\n\n      debug.log('  Converting to grid units (before constraints):', {\n        gridX,\n        gridY,\n        defaultWidth: definition.defaultSize.width,\n        defaultHeight: definition.defaultSize.height\n      });\n\n      // Apply boundary constraints (validate, adjust size, constrain position)\n      const constrained = applyBoundaryConstraints(definition, gridX, gridY);\n\n      if (!constrained) {\n        console.warn(`Cannot place component \"${definition.name}\" - minimum size exceeds canvas width`);\n        return;\n      }\n\n      debug.log('  After boundary constraints:', constrained);\n\n      // Use existing addComponent API method with constrained values\n      const newItem = this.api?.addComponent(canvasId, componentType, {\n        x: constrained.x,\n        y: constrained.y,\n        width: constrained.width,\n        height: constrained.height,\n      });\n\n      debug.log('  Created item:', newItem);\n    };\n\n    this.hostElement.addEventListener('canvas-drop', this.canvasDropHandler);\n\n    // Setup canvas move event handler for cross-canvas moves\n    this.canvasMoveHandler = (event: Event) => {\n      const customEvent = event as CustomEvent;\n      const { itemId, sourceCanvasId, targetCanvasId, x, y } = customEvent.detail;\n\n      debug.log('ðŸ”„ canvas-move event received:', { itemId, sourceCanvasId, targetCanvasId, x, y });\n\n      // 1. Get item from source canvas\n      const sourceCanvas = gridState.canvases[sourceCanvasId];\n      if (!sourceCanvas) {\n        console.error('Source canvas not found:', sourceCanvasId);\n        return;\n      }\n\n      const itemIndex = sourceCanvas.items.findIndex(i => i.id === itemId);\n      if (itemIndex === -1) {\n        console.error('Item not found in source canvas:', itemId);\n        return;\n      }\n\n      const item = sourceCanvas.items[itemIndex];\n\n      // 2. Capture state BEFORE move (for undo)\n      const sourcePosition = {\n        x: item.layouts.desktop.x,\n        y: item.layouts.desktop.y\n      };\n\n      // 3. Convert drop position (pixels) to grid units for target canvas\n      let gridX = pixelsToGridX(x, targetCanvasId, this.config);\n      let gridY = pixelsToGridY(y, this.config);\n\n      // 4. Constrain position to target canvas boundaries\n      const constrained = constrainPositionToCanvas(\n        gridX,\n        gridY,\n        item.layouts.desktop.width,\n        item.layouts.desktop.height,\n        CANVAS_WIDTH_UNITS\n      );\n\n      gridX = constrained.x;\n      gridY = constrained.y;\n\n      const targetPosition = { x: gridX, y: gridY };\n\n      // 5. Update item position in desktop layout\n      item.layouts.desktop.x = gridX;\n      item.layouts.desktop.y = gridY;\n\n      // 6. Move item between canvases (updates canvasId, removes from source, adds to target)\n      moveItemToCanvas(sourceCanvasId, targetCanvasId, itemId);\n\n      // 7. Assign new z-index in target canvas\n      const targetCanvas = gridState.canvases[targetCanvasId];\n      item.zIndex = targetCanvas.zIndexCounter++;\n      gridState.canvases = { ...gridState.canvases }; // Trigger reactivity\n\n      // 8. Set target canvas as active\n      setActiveCanvas(targetCanvasId);\n\n      // 9. Update selection state if item was selected\n      if (gridState.selectedItemId === itemId) {\n        gridState.selectedCanvasId = targetCanvasId;\n      }\n\n      // 10. Create undo/redo command\n      const command = new MoveItemCommand(\n        itemId,\n        sourceCanvasId,\n        targetCanvasId,\n        sourcePosition,\n        targetPosition,\n        itemIndex\n      );\n      undoRedo.push(command);\n\n      // 11. Emit events for plugins\n      eventManager.emit('componentMoved', {\n        item,\n        sourceCanvasId,\n        targetCanvasId,\n        position: targetPosition\n      });\n\n      eventManager.emit('canvasActivated', { canvasId: targetCanvasId });\n\n      debug.log('âœ… Cross-canvas move completed:', {\n        itemId,\n        from: sourceCanvasId,\n        to: targetCanvasId,\n        position: targetPosition\n      });\n    };\n\n    this.hostElement.addEventListener('canvas-move', this.canvasMoveHandler);\n\n    // Setup canvas activated event handler\n    this.canvasActivatedHandler = (event: Event) => {\n      const customEvent = event as CustomEvent;\n      const { canvasId } = customEvent.detail;\n\n      debug.log('ðŸŽ¨ canvas-activated event received:', { canvasId });\n\n      // Emit plugin event\n      eventManager.emit('canvasActivated', { canvasId });\n    };\n\n    this.hostElement.addEventListener('canvas-activated', this.canvasActivatedHandler);\n\n    // Setup keyboard shortcuts\n    this.keyboardHandler = (event: KeyboardEvent) => {\n      // Get modifier keys (Cmd on Mac, Ctrl on Windows/Linux)\n      const isUndo = (event.metaKey || event.ctrlKey) && event.key === 'z' && !event.shiftKey;\n      const isRedo = (event.metaKey || event.ctrlKey) && (\n        (event.key === 'z' && event.shiftKey) || // Ctrl/Cmd+Shift+Z\n        event.key === 'y' // Ctrl/Cmd+Y\n      );\n\n      // Handle undo/redo\n      if (isUndo) {\n        debug.log('âŒ¨ï¸ Keyboard: Undo triggered');\n        event.preventDefault();\n        this.api?.undo();\n        return;\n      }\n\n      if (isRedo) {\n        debug.log('âŒ¨ï¸ Keyboard: Redo triggered');\n        event.preventDefault();\n        this.api?.redo();\n        return;\n      }\n\n      // Handle arrow key nudging (only if component is selected)\n      if (!gridState.selectedItemId || !gridState.selectedCanvasId) {\n        return;\n      }\n\n      const isArrowKey = ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(event.key);\n      if (!isArrowKey) {\n        return;\n      }\n\n      event.preventDefault();\n\n      // Get selected item\n      const canvas = gridState.canvases[gridState.selectedCanvasId];\n      if (!canvas) {\n        return;\n      }\n\n      const item = canvas.items.find(i => i.id === gridState.selectedItemId);\n      if (!item) {\n        return;\n      }\n\n      // Get current viewport layout\n      const viewport = gridState.currentViewport;\n      const layout = item.layouts[viewport];\n\n      // Calculate nudge amount (1 grid unit in each direction)\n      const nudgeAmount = 1;\n      let deltaX = 0;\n      let deltaY = 0;\n\n      switch (event.key) {\n        case 'ArrowUp':\n          deltaY = -nudgeAmount;\n          break;\n        case 'ArrowDown':\n          deltaY = nudgeAmount;\n          break;\n        case 'ArrowLeft':\n          deltaX = -nudgeAmount;\n          break;\n        case 'ArrowRight':\n          deltaX = nudgeAmount;\n          break;\n      }\n\n      debug.log('âŒ¨ï¸ Keyboard: Nudging component', {\n        key: event.key,\n        deltaX,\n        deltaY,\n        itemId: item.id,\n      });\n\n      // Capture old position for undo\n      const oldX = layout.x;\n      const oldY = layout.y;\n\n      // Update position with boundary checks\n      const newX = Math.max(0, layout.x + deltaX);\n      const newY = Math.max(0, layout.y + deltaY);\n\n      // Check right boundary (100 grid units = 100%)\n      const maxX = 100 - layout.width;\n      const constrainedX = Math.min(newX, maxX);\n      const constrainedY = newY; // No vertical limit\n\n      // Only update if position actually changed\n      if (oldX === constrainedX && oldY === constrainedY) {\n        return; // No change, don't create undo command\n      }\n\n      // Update item layout (mutate in place to preserve all properties like 'customized')\n      layout.x = constrainedX;\n      layout.y = constrainedY;\n\n      // Create undo command for nudge\n      const nudgeCommand = new MoveItemCommand(\n        item.id,\n        gridState.selectedCanvasId,\n        gridState.selectedCanvasId,\n        { x: oldX, y: oldY },\n        { x: constrainedX, y: constrainedY },\n        canvas.items.findIndex(i => i.id === item.id)\n      );\n      undoRedo.push(nudgeCommand);\n\n      // Trigger state update\n      gridState.canvases = { ...gridState.canvases };\n\n      // Emit event\n      eventManager.emit('componentDragged', {\n        itemId: item.id,\n        canvasId: gridState.selectedCanvasId,\n        position: { x: constrainedX, y: constrainedY },\n      });\n    };\n\n    document.addEventListener('keydown', this.keyboardHandler);\n\n    // Setup container-based viewport switching\n    this.setupViewportResizeObserver();\n  }\n\n  /**\n   * Disconnected callback (cleanup)\n   *\n   * **Purpose**: Clean up resources when component unmounts\n   *\n   * **Cleanup sequence**:\n   * 1. Remove event listeners\n   * 2. Destroy all plugins\n   * 3. Clear global references\n   */\n  disconnectedCallback() {\n    // Remove event listeners\n    if (this.canvasDropHandler) {\n      this.hostElement.removeEventListener('canvas-drop', this.canvasDropHandler);\n    }\n    if (this.canvasMoveHandler) {\n      this.hostElement.removeEventListener('canvas-move', this.canvasMoveHandler);\n    }\n    if (this.canvasActivatedHandler) {\n      this.hostElement.removeEventListener('canvas-activated', this.canvasActivatedHandler);\n    }\n    if (this.keyboardHandler) {\n      document.removeEventListener('keydown', this.keyboardHandler);\n    }\n\n    // Cleanup ResizeObserver\n    if (this.viewportResizeObserver) {\n      this.viewportResizeObserver.disconnect();\n    }\n\n    // Destroy plugins\n    if (this.initializedPlugins.length > 0) {\n      this.initializedPlugins.forEach(plugin => {\n        try {\n          plugin.destroy();\n          debug.log(`GridBuilder: Destroyed plugin \"${plugin.name}\"`);\n        } catch (e) {\n          console.error(`GridBuilder: Failed to destroy plugin \"${plugin.name}\":`, e);\n        }\n      });\n      this.initializedPlugins = [];\n    }\n\n    // Clear global references\n    delete (window as any).virtualRenderer;\n\n    // Clear API from storage location if it was set\n    if (this.apiRef && this.apiRef.key) {\n      const target = this.apiRef.target || window;\n      delete target[this.apiRef.key];\n    }\n  }\n\n  /**\n   * Watch components prop for changes\n   *\n   * **Purpose**: Rebuild component registry when components prop changes\n   */\n  @Watch('components')\n  handleComponentsChange(newComponents: ComponentDefinition[]) {\n    this.componentRegistry = new Map(\n      newComponents.map(comp => [comp.type, comp])\n    );\n  }\n\n  /**\n   * Create GridBuilderAPI instance\n   *\n   * **Purpose**: Provide API to plugins and external code\n   * **Returns**: GridBuilderAPI implementation\n   *\n   * **Implementation**: Full API with event system integration\n   */\n  private createAPI(): GridBuilderAPI {\n    return {\n      // ======================\n      // Event Subscriptions\n      // ======================\n\n      on: <T = any>(eventName: string, callback: (data: T) => void) => {\n        eventManager.on(eventName, callback);\n      },\n\n      off: <T = any>(eventName: string, callback: (data: T) => void) => {\n        eventManager.off(eventName, callback);\n      },\n\n      // ======================\n      // State Access (Read)\n      // ======================\n\n      getState: () => gridState,\n\n      getItems: (canvasId: string) => {\n        return gridState.canvases[canvasId]?.items || [];\n      },\n\n      getItem: (itemId: string) => {\n        // Search across all canvases\n        for (const canvasId in gridState.canvases) {\n          const canvas = gridState.canvases[canvasId];\n          const item = canvas.items.find((i) => i.id === itemId);\n          if (item) {\n            return item;\n          }\n        }\n        return null;\n      },\n\n      // ======================\n      // Programmatic Operations\n      // ======================\n\n      addComponent: (canvasId: string, componentType: string, position: { x: number; y: number; width: number; height: number }, config?: Record<string, any>) => {\n        const canvas = gridState.canvases[canvasId];\n        if (!canvas) {\n          console.error(`Canvas not found: ${canvasId}`);\n          return null;\n        }\n\n        // Create new item\n        const newItem = {\n          id: generateItemId(),\n          canvasId,\n          name: componentType,\n          type: componentType,\n          zIndex: ++canvas.zIndexCounter,\n          layouts: {\n            desktop: { ...position },\n            mobile: { x: 0, y: 0, width: 50, height: position.height, customized: false },\n          },\n          config: config || {},\n        };\n\n        // Add to canvas\n        canvas.items.push(newItem);\n        gridState.canvases = { ...gridState.canvases };\n\n        // Add to undo/redo history\n        undoRedo.push(new BatchAddCommand([newItem.id]));\n\n        // Emit event\n        eventManager.emit('componentAdded', { item: newItem, canvasId });\n\n        return newItem.id;\n      },\n\n      deleteComponent: (itemId: string) => {\n        // Find and delete item across all canvases\n        for (const canvasId in gridState.canvases) {\n          const canvas = gridState.canvases[canvasId];\n          const itemIndex = canvas.items.findIndex((i) => i.id === itemId);\n          if (itemIndex !== -1) {\n            // Add to undo/redo history BEFORE deletion (need state for undo)\n            undoRedo.push(new BatchDeleteCommand([itemId]));\n\n            // Delete item\n            canvas.items.splice(itemIndex, 1);\n            gridState.canvases = { ...gridState.canvases };\n\n            // Deselect if deleted item was selected\n            if (gridState.selectedItemId === itemId) {\n              gridState.selectedItemId = null;\n              gridState.selectedCanvasId = null;\n            }\n\n            // Emit event\n            eventManager.emit('componentDeleted', { itemId, canvasId });\n\n            return true;\n          }\n        }\n        return false;\n      },\n\n      updateConfig: (itemId: string, config: Record<string, any>) => {\n        // Find and update item across all canvases\n        for (const canvasId in gridState.canvases) {\n          const canvas = gridState.canvases[canvasId];\n          const itemIndex = canvas.items.findIndex((i) => i.id === itemId);\n          if (itemIndex !== -1) {\n            const item = canvas.items[itemIndex];\n            const newConfig = { ...item.config, ...config };\n\n            // Create undo command BEFORE making changes\n            const batchUpdate = [{\n              itemId,\n              canvasId,\n              updates: { config: newConfig },\n            }];\n            undoRedo.push(new BatchUpdateConfigCommand(batchUpdate));\n\n            // Merge config\n            canvas.items[itemIndex] = {\n              ...canvas.items[itemIndex],\n              config: newConfig,\n            };\n            gridState.canvases = { ...gridState.canvases };\n\n            // Emit event\n            eventManager.emit('configChanged', { itemId, canvasId, config });\n\n            return true;\n          }\n        }\n        return false;\n      },\n\n      // ======================\n      // Batch Operations\n      // ======================\n\n      addComponentsBatch: (components: Array<{ canvasId: string; type: string; position: { x: number; y: number; width: number; height: number }; config?: Record<string, any> }>) => {\n        // Convert API format to state-manager format\n        const partialItems = components.map(({ canvasId, type, position, config }) => ({\n          canvasId,\n          type,\n          name: type,\n          layouts: {\n            desktop: { ...position },\n            mobile: { x: 0, y: 0, width: 50, height: position.height, customized: false },\n          },\n          config: config || {},\n        }));\n\n        // Use state-manager batch operation (single state update)\n        const itemIds = addItemsBatch(partialItems);\n\n        // Add to undo/redo history\n        undoRedo.push(new BatchAddCommand(itemIds));\n\n        // Emit batch event\n        const createdItems = itemIds.map(id => {\n          const item = this.api?.getItem(id);\n          return item ? { item, canvasId: item.canvasId } : null;\n        }).filter(Boolean);\n        eventManager.emit('componentsBatchAdded', { items: createdItems });\n\n        return itemIds;\n      },\n\n      deleteComponentsBatch: (itemIds: string[]) => {\n        // Store deleted items for event\n        const deletedItems = itemIds.map(itemId => {\n          const item = this.api?.getItem(itemId);\n          return item ? { itemId, canvasId: item.canvasId } : null;\n        }).filter(Boolean);\n\n        // Add to undo/redo history BEFORE deletion (need state for undo)\n        undoRedo.push(new BatchDeleteCommand(itemIds));\n\n        // Use state-manager batch operation (single state update)\n        deleteItemsBatch(itemIds);\n\n        // Clear selection if any deleted item was selected\n        if (gridState.selectedItemId && itemIds.includes(gridState.selectedItemId)) {\n          gridState.selectedItemId = null;\n          gridState.selectedCanvasId = null;\n        }\n\n        // Emit batch event\n        eventManager.emit('componentsBatchDeleted', { items: deletedItems });\n      },\n\n      updateConfigsBatch: (updates: Array<{ itemId: string; config: Record<string, any> }>) => {\n        // Convert to state-manager format (need canvasId)\n        const batchUpdates = updates.map(({ itemId, config }) => {\n          const item = this.api?.getItem(itemId);\n          if (!item) {\n            console.warn(`Item ${itemId} not found for config update`);\n            return null;\n          }\n          return {\n            itemId,\n            canvasId: item.canvasId,\n            updates: { config: { ...item.config, ...config } },\n          };\n        }).filter(Boolean) as Array<{ itemId: string; canvasId: string; updates: Partial<any> }>;\n\n        // Add to undo/redo history\n        undoRedo.push(new BatchUpdateConfigCommand(batchUpdates));\n\n        // Use state-manager batch operation (single state update)\n        updateItemsBatch(batchUpdates);\n\n        // Emit batch event\n        const updatedItems = batchUpdates.map(({ itemId, canvasId, updates }) => ({\n          itemId,\n          canvasId,\n          config: updates.config,\n        }));\n        eventManager.emit('configsBatchChanged', { items: updatedItems });\n      },\n\n      // ======================\n      // Canvas Access\n      // ======================\n\n      getCanvasElement: (canvasId: string) => {\n        return document.getElementById(canvasId);\n      },\n\n      // ======================\n      // Undo/Redo Operations\n      // ======================\n\n      undo: () => {\n        undoRedo.undo();\n        // Emit event after undo\n        eventManager.emit('undoExecuted', {});\n      },\n\n      redo: () => {\n        undoRedo.redo();\n        // Emit event after redo\n        eventManager.emit('redoExecuted', {});\n      },\n\n      canUndo: () => {\n        return undoRedo.canUndo();\n      },\n\n      canRedo: () => {\n        return undoRedo.canRedo();\n      },\n\n      undoRedoState: undoRedoState,\n\n      // ======================\n      // Canvas Management\n      // ======================\n\n      addCanvas: (canvasId: string) => {\n        // Create and execute command\n        const command = new AddCanvasCommand(canvasId);\n        undoRedo.push(command);\n        command.redo();\n      },\n\n      removeCanvas: (canvasId: string) => {\n        // Create and execute command\n        const command = new RemoveCanvasCommand(canvasId);\n        undoRedo.push(command);\n        command.redo();\n      },\n\n      setActiveCanvas: (canvasId: string) => {\n        setActiveCanvas(canvasId);\n        eventManager.emit('canvasActivated', { canvasId });\n      },\n\n      getActiveCanvas: () => {\n        return gridState.activeCanvasId;\n      },\n    };\n  }\n\n  /**\n   * Apply theme via CSS variables\n   *\n   * **Purpose**: Apply theme customization to host element\n   * **Implementation**: Set CSS custom properties on :host\n   */\n  private applyTheme(theme: GridBuilderTheme) {\n    const host = this.el;\n    if (!host) return;\n\n    // Apply predefined theme properties\n    if (theme.primaryColor) {\n      host.style.setProperty('--grid-builder-primary-color', theme.primaryColor);\n    }\n    if (theme.paletteBackground) {\n      host.style.setProperty('--grid-builder-palette-bg', theme.paletteBackground);\n    }\n    if (theme.canvasBackground) {\n      host.style.setProperty('--grid-builder-canvas-bg', theme.canvasBackground);\n    }\n    if (theme.gridLineColor) {\n      host.style.setProperty('--grid-builder-grid-line-color', theme.gridLineColor);\n    }\n    if (theme.selectionColor) {\n      host.style.setProperty('--grid-builder-selection-color', theme.selectionColor);\n    }\n    if (theme.resizeHandleColor) {\n      host.style.setProperty('--grid-builder-resize-handle-color', theme.resizeHandleColor);\n    }\n    if (theme.fontFamily) {\n      host.style.setProperty('--grid-builder-font-family', theme.fontFamily);\n    }\n\n    // Apply custom properties\n    if (theme.customProperties) {\n      Object.entries(theme.customProperties).forEach(([key, value]) => {\n        host.style.setProperty(key, value);\n      });\n    }\n  }\n\n  /**\n   * Setup ResizeObserver for container-based viewport switching\n   *\n   * **Purpose**: Automatically switch between desktop/mobile viewports based on container width\n   * **Breakpoint**: 768px (container width, not window viewport)\n   *\n   * **Observer callback**:\n   * 1. Get container width from ResizeObserver entry\n   * 2. Determine target viewport (mobile if < 768px, desktop otherwise)\n   * 3. Update gridState.currentViewport if changed\n   *\n   * **Why container-based**:\n   * - More flexible than window.resize (e.g., sidebar layouts, embedded widgets)\n   * - Grid-builder can be embedded at any size\n   * - Multiple instances can have different viewports on same page\n   *\n   * **Debouncing**: Not needed - ResizeObserver is already efficient\n   */\n  private setupViewportResizeObserver = () => {\n    if (!this.hostElement) {\n      return;\n    }\n\n    // Watch for grid-builder container size changes\n    this.viewportResizeObserver = new ResizeObserver((entries) => {\n      for (const entry of entries) {\n        // Get container width (use borderBoxSize for better accuracy)\n        const width = entry.borderBoxSize?.[0]?.inlineSize || entry.contentRect.width;\n\n        // Determine target viewport based on container width\n        const targetViewport = width < 768 ? 'mobile' : 'desktop';\n\n        // Only update if viewport changed\n        if (gridState.currentViewport !== targetViewport) {\n          debug.log(`ðŸ“± Container-based viewport switch: ${gridState.currentViewport} â†’ ${targetViewport} (width: ${Math.round(width)}px)`);\n          gridState.currentViewport = targetViewport;\n        }\n      }\n    });\n\n    this.viewportResizeObserver.observe(this.hostElement);\n  };\n\n  /**\n   * Export current state to JSON-serializable format\n   *\n   * **Purpose**: Export grid layout for saving or transferring to viewer app\n   *\n   * **Use Cases**:\n   * - Save layout to database/localStorage\n   * - Transfer layout to viewer app via API\n   * - Create layout templates/presets\n   * - Backup/restore functionality\n   *\n   * **Example - Save to API**:\n   * ```typescript\n   * const builder = document.querySelector('grid-builder');\n   * const exportData = await builder.exportState();\n   * await fetch('/api/layouts', {\n   *   method: 'POST',\n   *   headers: { 'Content-Type': 'application/json' },\n   *   body: JSON.stringify(exportData)\n   * });\n   * ```\n   *\n   * **Example - Save to localStorage**:\n   * ```typescript\n   * const exportData = await builder.exportState();\n   * localStorage.setItem('grid-layout', JSON.stringify(exportData));\n   * ```\n   *\n   * @returns Promise<GridExport> - JSON-serializable export object\n   */\n  @Method()\n  async exportState(): Promise<GridExport> {\n    // Build export data from current gridState\n    const exportData: GridExport = {\n      version: '1.0.0',\n      canvases: {},\n      viewport: gridState.currentViewport,\n      metadata: {\n        createdAt: new Date().toISOString(),\n        updatedAt: new Date().toISOString(),\n      },\n    };\n\n    // Export each canvas with its items\n    for (const canvasId in gridState.canvases) {\n      const canvas = gridState.canvases[canvasId];\n\n      exportData.canvases[canvasId] = {\n        items: canvas.items.map(item => ({\n          id: item.id,\n          canvasId: item.canvasId,\n          type: item.type,\n          name: item.name,\n          layouts: {\n            desktop: { ...item.layouts.desktop },\n            mobile: { ...item.layouts.mobile },\n          },\n          zIndex: item.zIndex,\n          config: { ...item.config }, // Deep copy to avoid mutations\n        })),\n      };\n    }\n\n    return exportData;\n  }\n\n  /**\n   * Import state from JSON-serializable format\n   *\n   * **Purpose**: Restore previously exported grid state\n   *\n   * **Example**:\n   * ```typescript\n   * const builder = document.querySelector('grid-builder');\n   * const savedState = JSON.parse(localStorage.getItem('grid-layout'));\n   * await builder.importState(savedState);\n   * ```\n   *\n   * @param state - GridExport or partial GridState object\n   */\n  @Method()\n  async importState(state: Partial<GridState> | GridExport) {\n    // Import grid state\n    Object.assign(gridState, state);\n  }\n\n  /**\n   * Get current grid state\n   *\n   * **Purpose**: Direct access to grid state for reading\n   *\n   * **Example**:\n   * ```typescript\n   * const builder = document.querySelector('grid-builder');\n   * const state = await builder.getState();\n   * console.log('Current viewport:', state.currentViewport);\n   * ```\n   *\n   * @returns Promise<GridState> - Current grid state\n   */\n  @Method()\n  async getState(): Promise<GridState> {\n    return gridState;\n  }\n\n  /**\n   * Add a new canvas programmatically\n   *\n   * **Purpose**: Create new section/canvas in the grid\n   *\n   * **Example**:\n   * ```typescript\n   * const builder = document.querySelector('grid-builder');\n   * await builder.addCanvas('new-section');\n   * ```\n   *\n   * @param canvasId - Unique canvas identifier\n   */\n  @Method()\n  async addCanvas(canvasId: string) {\n    this.api?.addCanvas(canvasId);\n  }\n\n  /**\n   * Remove a canvas programmatically\n   *\n   * **Purpose**: Delete section/canvas from the grid\n   *\n   * **Example**:\n   * ```typescript\n   * const builder = document.querySelector('grid-builder');\n   * await builder.removeCanvas('old-section');\n   * ```\n   *\n   * @param canvasId - Canvas identifier to remove\n   */\n  @Method()\n  async removeCanvas(canvasId: string) {\n    this.api?.removeCanvas(canvasId);\n  }\n\n  /**\n   * Set active canvas programmatically\n   *\n   * **Purpose**: Activate a specific canvas for focused editing\n   *\n   * **Use cases**:\n   * - Focus specific section after adding items\n   * - Programmatic navigation between sections\n   * - Show canvas-specific settings panel\n   *\n   * **Events triggered**: 'canvasActivated'\n   *\n   * @param canvasId - Canvas to activate\n   *\n   * @example\n   * ```typescript\n   * const builder = document.querySelector('grid-builder');\n   * await builder.setActiveCanvas('canvas2');\n   * ```\n   */\n  @Method()\n  async setActiveCanvas(canvasId: string) {\n    this.api?.setActiveCanvas(canvasId);\n  }\n\n  /**\n   * Get currently active canvas ID\n   *\n   * **Purpose**: Check which canvas is currently active/focused\n   *\n   * @returns Promise<string | null> - Active canvas ID or null if none active\n   *\n   * @example\n   * ```typescript\n   * const builder = document.querySelector('grid-builder');\n   * const activeId = await builder.getActiveCanvas();\n   * if (activeId === 'canvas1') {\n   *   console.log('Canvas 1 is active');\n   * }\n   * ```\n   */\n  @Method()\n  async getActiveCanvas(): Promise<string | null> {\n    return this.api?.getActiveCanvas() || null;\n  }\n\n  /**\n   * Undo last action\n   *\n   * **Purpose**: Revert last user action (move, resize, add, delete, etc.)\n   *\n   * **Example**:\n   * ```typescript\n   * const builder = document.querySelector('grid-builder');\n   * await builder.undo();\n   * ```\n   */\n  @Method()\n  async undo() {\n    this.api?.undo();\n  }\n\n  /**\n   * Redo last undone action\n   *\n   * **Purpose**: Re-apply last undone action\n   *\n   * **Example**:\n   * ```typescript\n   * const builder = document.querySelector('grid-builder');\n   * await builder.redo();\n   * ```\n   */\n  @Method()\n  async redo() {\n    this.api?.redo();\n  }\n\n  /**\n   * Check if undo is available\n   *\n   * **Purpose**: Determine if there are actions to undo\n   *\n   * **Example**:\n   * ```typescript\n   * const builder = document.querySelector('grid-builder');\n   * const canUndo = await builder.canUndo();\n   * undoButton.disabled = !canUndo;\n   * ```\n   *\n   * @returns Promise<boolean> - True if undo is available\n   */\n  @Method()\n  async canUndo(): Promise<boolean> {\n    return this.api?.canUndo() || false;\n  }\n\n  /**\n   * Check if redo is available\n   *\n   * **Purpose**: Determine if there are actions to redo\n   *\n   * **Example**:\n   * ```typescript\n   * const builder = document.querySelector('grid-builder');\n   * const canRedo = await builder.canRedo();\n   * redoButton.disabled = !canRedo;\n   * ```\n   *\n   * @returns Promise<boolean> - True if redo is available\n   */\n  @Method()\n  async canRedo(): Promise<boolean> {\n    return this.api?.canRedo() || false;\n  }\n\n  /**\n   * Add a component programmatically\n   *\n   * **Purpose**: Add new component to canvas without dragging from palette\n   *\n   * **Example**:\n   * ```typescript\n   * const builder = document.querySelector('grid-builder');\n   * const itemId = await builder.addComponent('canvas1', 'header', {\n   *   x: 10, y: 10, width: 30, height: 6\n   * }, { title: 'My Header' });\n   * ```\n   *\n   * @param canvasId - Canvas to add component to\n   * @param componentType - Component type from registry\n   * @param position - Grid position and size\n   * @param config - Optional component configuration\n   * @returns Promise<string | null> - New item ID or null if failed\n   */\n  @Method()\n  async addComponent(\n    canvasId: string,\n    componentType: string,\n    position: { x: number; y: number; width: number; height: number },\n    config?: Record<string, any>\n  ): Promise<string | null> {\n    return this.api?.addComponent(canvasId, componentType, position, config) || null;\n  }\n\n  /**\n   * Delete a component programmatically\n   *\n   * **Purpose**: Remove component from grid\n   *\n   * **Example**:\n   * ```typescript\n   * const builder = document.querySelector('grid-builder');\n   * const success = await builder.deleteComponent('item-123');\n   * ```\n   *\n   * @param itemId - Item ID to delete\n   * @returns Promise<boolean> - True if deleted successfully\n   */\n  @Method()\n  async deleteComponent(itemId: string): Promise<boolean> {\n    return this.api?.deleteComponent(itemId) || false;\n  }\n\n  /**\n   * Update component configuration\n   *\n   * **Purpose**: Update component properties/config\n   *\n   * **Example**:\n   * ```typescript\n   * const builder = document.querySelector('grid-builder');\n   * const success = await builder.updateConfig('item-123', {\n   *   title: 'Updated Title',\n   *   color: '#ff0000'\n   * });\n   * ```\n   *\n   * @param itemId - Item ID to update\n   * @param config - Configuration updates\n   * @returns Promise<boolean> - True if updated successfully\n   */\n  @Method()\n  async updateConfig(itemId: string, config: Record<string, any>): Promise<boolean> {\n    return this.api?.updateConfig(itemId, config) || false;\n  }\n\n  /**\n   * Reference to host element\n   */\n  private el?: HTMLElement;\n\n  /**\n   * Render component template\n   *\n   * **Purpose**: Render main UI structure\n   *\n   * **Structure**:\n   * - Host element with theme classes\n   * - Component palette (sidebar or custom)\n   * - Canvas area with sections\n   *\n   * **Note**: Actual rendering delegates to child components:\n   * - <component-palette> or custom ComponentPalette\n   * - <canvas-section> for each canvas\n   *\n   * **Config Panel**: Users should implement their own config panels\n   * - See custom-config-panel in demo for reference implementation\n   * - Listen to 'item-click' events to show your config UI\n   */\n  render() {\n    const canvasIds = Object.keys(gridState.canvases);\n\n    return (\n      <Host ref={(el) => this.el = el}>\n        <div class=\"grid-builder-container\">\n          {/* Component Palette */}\n          <div class=\"palette-area\">\n            <component-palette components={this.components} config={this.config} />\n          </div>\n\n          {/* Canvas Area */}\n          <div class=\"canvas-area\">\n            {/* Canvases */}\n            <div class=\"canvases-container\">\n              {canvasIds.map((canvasId) => (\n                <canvas-section\n                  key={canvasId}\n                  canvasId={canvasId}\n                  isActive={gridState.activeCanvasId === canvasId}\n                  config={this.config}\n                  componentRegistry={this.componentRegistry}\n                  backgroundColor={this.canvasMetadata?.[canvasId]?.backgroundColor}\n                  canvasTitle={this.canvasMetadata?.[canvasId]?.title}\n                  onBeforeDelete={this.onBeforeDelete}\n                />\n              ))}\n            </div>\n          </div>\n        </div>\n      </Host>\n    );\n  }\n}\n","/**\n * Grid Viewer Styles\n * ===================\n *\n * Simplified styling for rendering-only grid viewer.\n * Based on grid-builder styles but without editing UI (palette, config panel).\n *\n * ## Key Differences from grid-builder.scss\n *\n * **Excluded**:\n * - âŒ Palette area styles (no component palette)\n * - âŒ Config panel styles (no configuration editing)\n * - âŒ Selection styles (no item selection)\n * - âŒ Resize handle styles (no resizing)\n *\n * **Included**:\n * - âœ… Canvas area layout\n * - âœ… Responsive container\n * - âœ… Theme variables\n *\n * @module grid-viewer-styles\n */\n\n/**\n * CSS Custom Properties (Theme Variables)\n *\n * **Default theme**: Bootstrap-inspired blue\n * **Overridable**: Via theme prop\n */\n:host {\n  // Color scheme\n  --grid-viewer-primary-color: #007bff;\n  --grid-viewer-canvas-bg: #ffffff;\n  --grid-viewer-font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;\n\n  // Layout\n  display: block;\n  width: 100%;\n  height: 100%;\n  font-family: var(--grid-viewer-font-family);\n}\n\n/**\n * Main Container\n *\n * **Layout**: Full width/height for embedding\n * **Simplified**: No grid layout (only canvas area)\n */\n.grid-viewer-container {\n  width: 100%;\n  height: 100%;\n  background: var(--grid-viewer-canvas-bg);\n  overflow: auto;\n}\n\n/**\n * Canvas Area\n *\n * **Layout**: Full width/height (no palette or config panel)\n * **Scrolling**: Vertical scroll for multiple canvases\n */\n.canvas-area {\n  width: 100%;\n  height: 100%;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n\n/**\n * Canvases Container\n *\n * **Layout**: Vertical stack of canvas sections\n * **Spacing**: Gap between canvases\n */\n.canvases-container {\n  display: flex;\n  flex-direction: column;\n  gap: 0; // No gap - canvases stack seamlessly\n  width: 100%;\n  min-height: 100%;\n}\n","/**\n * Grid Viewer - Rendering-Only Component\n * ========================================\n *\n * Lightweight component for rendering grid layouts without editing functionality.\n * Designed to be used in viewer apps where layouts are created in grid-builder\n * and displayed in grid-viewer.\n *\n * ## Design Philosophy\n *\n * **Separation of concerns**:\n * - Builder app: grid-builder with full editing (~150KB with interact.js)\n * - Viewer app: grid-viewer for display only (~30KB, 80% smaller)\n * - Same component definitions, different rendering modes\n *\n * **Export/Import workflow**:\n * ```typescript\n * // Builder App â†’ Export layout\n * const builder = document.querySelector('grid-builder');\n * const exportData = await builder.exportState();\n * await saveToAPI(exportData);\n *\n * // Viewer App â†’ Import and display layout\n * const layout = await loadFromAPI();\n * const viewer = document.querySelector('grid-viewer');\n * viewer.initialState = layout;\n * ```\n *\n * ## What's Excluded from Viewer\n *\n * **No editing features**:\n * - âŒ No drag-and-drop (no interact.js)\n * - âŒ No component palette\n * - âŒ No config panel\n * - âŒ No item selection\n * - âŒ No resize handles\n * - âŒ No undo/redo\n *\n * **Only rendering features**:\n * - âœ… Responsive layouts (desktop/mobile)\n * - âœ… Container-based viewport switching\n * - âœ… Virtual rendering for performance\n * - âœ… Theme customization\n * - âœ… Component registry for dynamic rendering\n *\n * ## Bundle Size Impact\n *\n * **Builder**: ~150KB (includes interact.js ~45KB)\n * **Viewer**: ~30KB (no interact.js, no editing logic)\n * **Reduction**: 80% smaller bundle\n *\n * @module grid-viewer\n */\n\nimport { Component, Element, h, Host, Prop, State, Watch } from '@stencil/core';\n\n// Type imports\nimport { ComponentDefinition } from '../../types/component-definition';\nimport { GridConfig } from '../../types/grid-config';\nimport { GridBuilderTheme } from '../../types/theme';\nimport { GridExport } from '../../types/grid-export';\n\n// Service imports - only rendering-related, no editing\nimport { ViewerState } from '../../services/state-manager';\nimport { createStore } from '@stencil/store';\nimport { createDebugLogger } from '../../utils/debug';\n\nconst debug = createDebugLogger('grid-viewer');\n\n/**\n * GridViewer Component\n * ====================\n *\n * Rendering-only grid component for displaying layouts created in grid-builder.\n *\n * **Tag**: `<grid-viewer>`\n * **Shadow DOM**: Disabled (consistent with grid-builder)\n * **Reactivity**: Uses local store for viewer state\n *\n * **Key differences from grid-builder**:\n * - No interact.js dependency (80% bundle size reduction)\n * - No palette, config panel, or editing UI\n * - Simplified state (no selection, no z-index tracking)\n * - Rendering-only canvas sections\n */\n@Component({\n  tag: 'grid-viewer',\n  styleUrl: 'grid-viewer.scss',\n  shadow: false, // Light DOM for consistency with grid-builder\n})\nexport class GridViewer {\n  /**\n   * Component definitions registry\n   *\n   * **Required prop**: Array of ComponentDefinition objects\n   * **Purpose**: Defines how to render each component type\n   *\n   * **Must match builder definitions**: Same component types as used in builder\n   *\n   * **Example**:\n   * ```typescript\n   * const components = [\n   *   {\n   *     type: 'header',\n   *     name: 'Header',\n   *     icon: 'ðŸ“„',\n   *     render: ({ itemId, config }) => (\n   *       <my-header itemId={itemId} config={config} />\n   *     )\n   *   }\n   * ];\n   * ```\n   */\n  @Prop() components!: ComponentDefinition[];\n\n  /**\n   * Grid configuration options\n   *\n   * **Optional prop**: Grid system configuration\n   * **Default**: Standard 2% grid with 10px-50px constraints\n   *\n   * **Should match builder config**: Use same config as builder for consistent rendering\n   */\n  @Prop() config?: GridConfig;\n\n  /**\n   * Visual theme customization\n   *\n   * **Optional prop**: Customizes colors, fonts, and styling\n   * **Default**: Bootstrap-inspired blue theme\n   */\n  @Prop() theme?: GridBuilderTheme;\n\n  /**\n   * Initial state to display\n   *\n   * **Optional prop**: Layout data to render\n   * **Accepts**: ViewerState or GridExport (both compatible)\n   *\n   * **From builder export**:\n   * ```typescript\n   * const exportData = await builder.exportState();\n   * viewer.initialState = exportData; // Type-safe!\n   * ```\n   *\n   * **From API**:\n   * ```typescript\n   * const layout = await fetch('/api/layouts/123').then(r => r.json());\n   * viewer.initialState = layout;\n   * ```\n   */\n  @Prop() initialState?: Partial<ViewerState> | GridExport;\n\n  /**\n   * Canvas metadata storage (host app responsibility)\n   *\n   * **Optional prop**: Store canvas-level presentation metadata\n   * **Purpose**: Host app owns canvas metadata (titles, colors, settings)\n   *\n   * **Structure**: Record<canvasId, any>\n   *\n   * **Example**:\n   * ```typescript\n   * const canvasMetadata = {\n   *   'hero-section': {\n   *     backgroundColor: '#f0f4f8',\n   *     customSettings: { ... }\n   *   }\n   * };\n   * ```\n   */\n  @Prop() canvasMetadata?: Record<string, any>;\n\n  /**\n   * Component registry (internal state)\n   *\n   * **Purpose**: Map component type â†’ definition for lookup\n   * **Built from**: components prop\n   */\n  @State() private componentRegistry: Map<string, ComponentDefinition> = new Map();\n\n  /**\n   * Local viewer state store\n   *\n   * **Purpose**: Minimal state for rendering (no editing state)\n   * **Structure**: ViewerState with canvases and currentViewport\n   */\n  private viewerState!: { state: ViewerState };\n\n  /**\n   * Host element reference\n   */\n  @Element() private hostElement!: HTMLElement;\n\n  /**\n   * ResizeObserver for container-based viewport switching\n   *\n   * **Purpose**: Automatically switch between desktop/mobile viewports based on container width\n   * **Breakpoint**: 768px (container width, not window width)\n   */\n  private viewportResizeObserver?: ResizeObserver;\n\n  /**\n   * Component will load lifecycle\n   *\n   * **Purpose**: Initialize component registry and viewer state\n   */\n  componentWillLoad() {\n    // Validate required props\n    if (!this.components || this.components.length === 0) {\n      console.error('GridViewer: components prop is required');\n      return;\n    }\n\n    // Build component registry\n    this.componentRegistry = new Map(\n      this.components.map(comp => [comp.type, comp])\n    );\n\n    // Validate unique component types\n    if (this.componentRegistry.size !== this.components.length) {\n      console.warn('GridViewer: Duplicate component types detected');\n    }\n\n    // Initialize local viewer state store\n    const initialViewerState: ViewerState = {\n      canvases: {},\n      currentViewport: 'desktop',\n    };\n\n    // Restore initial state if provided\n    if (this.initialState) {\n      // Handle both ViewerState and GridExport formats\n      if ('viewport' in this.initialState) {\n        // GridExport format\n        initialViewerState.currentViewport = this.initialState.viewport;\n        initialViewerState.canvases = this.initialState.canvases as Record<string, any>;\n      } else {\n        // ViewerState format\n        Object.assign(initialViewerState, this.initialState);\n      }\n    }\n\n    // Create local store (not global like grid-builder)\n    this.viewerState = createStore<ViewerState>(initialViewerState);\n  }\n\n  /**\n   * Component did load lifecycle\n   *\n   * **Purpose**: Apply theme and setup viewport switching\n   */\n  componentDidLoad() {\n    // Apply theme\n    if (this.theme) {\n      this.applyTheme(this.theme);\n    }\n\n    // Setup container-based viewport switching\n    this.setupViewportResizeObserver();\n  }\n\n  /**\n   * Disconnected callback (cleanup)\n   *\n   * **Purpose**: Clean up ResizeObserver\n   */\n  disconnectedCallback() {\n    // Cleanup ResizeObserver\n    if (this.viewportResizeObserver) {\n      this.viewportResizeObserver.disconnect();\n    }\n  }\n\n  /**\n   * Watch components prop for changes\n   *\n   * **Purpose**: Rebuild component registry when components prop changes\n   */\n  @Watch('components')\n  handleComponentsChange(newComponents: ComponentDefinition[]) {\n    this.componentRegistry = new Map(\n      newComponents.map(comp => [comp.type, comp])\n    );\n  }\n\n  /**\n   * Watch initialState prop for changes\n   *\n   * **Purpose**: Update viewer state when initialState prop changes\n   */\n  @Watch('initialState')\n  handleInitialStateChange(newState: Partial<ViewerState> | GridExport) {\n    if (newState) {\n      // Handle both ViewerState and GridExport formats\n      if ('viewport' in newState) {\n        // GridExport format\n        this.viewerState.state.currentViewport = newState.viewport;\n        this.viewerState.state.canvases = newState.canvases as Record<string, any>;\n      } else {\n        // ViewerState format\n        Object.assign(this.viewerState.state, newState);\n      }\n    }\n  }\n\n  /**\n   * Apply theme via CSS variables\n   *\n   * **Purpose**: Apply theme customization to host element\n   * **Implementation**: Set CSS custom properties on :host\n   */\n  private applyTheme(theme: GridBuilderTheme) {\n    const host = this.el;\n    if (!host) return;\n\n    // Apply predefined theme properties\n    if (theme.primaryColor) {\n      host.style.setProperty('--grid-viewer-primary-color', theme.primaryColor);\n    }\n    if (theme.canvasBackground) {\n      host.style.setProperty('--grid-viewer-canvas-bg', theme.canvasBackground);\n    }\n    if (theme.fontFamily) {\n      host.style.setProperty('--grid-viewer-font-family', theme.fontFamily);\n    }\n\n    // Apply custom properties\n    if (theme.customProperties) {\n      Object.entries(theme.customProperties).forEach(([key, value]) => {\n        host.style.setProperty(key, value);\n      });\n    }\n  }\n\n  /**\n   * Setup ResizeObserver for container-based viewport switching\n   *\n   * **Purpose**: Automatically switch between desktop/mobile viewports based on container width\n   * **Breakpoint**: 768px (container width, not window viewport)\n   *\n   * **Reused from grid-builder**: Same implementation for consistency\n   */\n  private setupViewportResizeObserver = () => {\n    if (!this.hostElement) {\n      return;\n    }\n\n    // Watch for grid-viewer container size changes\n    this.viewportResizeObserver = new ResizeObserver((entries) => {\n      for (const entry of entries) {\n        // Get container width directly from the element\n        // Note: We use offsetWidth instead of entry.contentRect.width because\n        // the grid-viewer uses Light DOM and contentRect returns 0 for elements with height: 100%\n        const width = this.hostElement.offsetWidth || entry.borderBoxSize?.[0]?.inlineSize || entry.contentRect.width;\n\n        // Skip viewport switching if width is 0 or very small (container not yet laid out)\n        // This prevents premature switching to mobile before CSS layout is complete\n        if (width < 100) {\n          debug.log(`ðŸ“± [Viewer] Skipping viewport switch - container not yet laid out (width: ${Math.round(width)}px)`);\n          return;\n        }\n\n        // Determine target viewport based on container width\n        const targetViewport = width < 768 ? 'mobile' : 'desktop';\n\n        // Only update if viewport changed\n        if (this.viewerState.state.currentViewport !== targetViewport) {\n          debug.log(`ðŸ“± [Viewer] Container-based viewport switch: ${this.viewerState.state.currentViewport} â†’ ${targetViewport} (width: ${Math.round(width)}px)`);\n          this.viewerState.state.currentViewport = targetViewport;\n        }\n      }\n    });\n\n    this.viewportResizeObserver.observe(this.hostElement);\n  };\n\n  /**\n   * Reference to host element\n   */\n  private el?: HTMLElement;\n\n  /**\n   * Render component template\n   *\n   * **Purpose**: Render canvases with items (no palette, no config panel)\n   *\n   * **Structure**:\n   * - Host element with theme classes\n   * - Canvas area with sections\n   * - No palette (viewing only)\n   * - No config panel (viewing only)\n   */\n  render() {\n    const canvasIds = Object.keys(this.viewerState.state.canvases);\n\n    return (\n      <Host ref={(el) => this.el = el}>\n        <div class=\"grid-viewer-container\">\n          {/* Canvas Area Only (no palette, no config panel) */}\n          <div class=\"canvas-area\">\n            <div class=\"canvases-container\">\n              {canvasIds.map((canvasId) => (\n                <canvas-section-viewer\n                  key={canvasId}\n                  canvasId={canvasId}\n                  config={this.config}\n                  componentRegistry={this.componentRegistry}\n                  items={this.viewerState.state.canvases[canvasId].items}\n                  currentViewport={this.viewerState.state.currentViewport}\n                  backgroundColor={this.canvasMetadata?.[canvasId]?.backgroundColor}\n                />\n              ))}\n            </div>\n          </div>\n        </div>\n      </Host>\n    );\n  }\n}\n","section-editor-panel {\n  .section-editor-overlay {\n    position: fixed;\n    z-index: 10000;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    animation: fadeIn 0.2s ease-out;\n    background: rgba(0, 0, 0, 0.5);\n  }\n\n  .section-editor-panel {\n    width: 90%;\n    max-width: 440px;\n    border-radius: 12px;\n    animation: slideUp 0.2s ease-out;\n    background: white;\n    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);\n  }\n\n  .panel-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 28px 32px 24px;\n    border-bottom: 1px solid #e9ecef;\n\n    .panel-title {\n      margin: 0;\n      color: #212529;\n      font-size: 20px;\n      font-weight: 600;\n      letter-spacing: -0.02em;\n    }\n\n    .close-btn {\n      display: flex;\n      width: 32px;\n      height: 32px;\n      align-items: center;\n      justify-content: center;\n      padding: 0;\n      border: none;\n      border-radius: 6px;\n      background: transparent;\n      color: #6c757d;\n      cursor: pointer;\n      font-size: 24px;\n      font-weight: 300;\n      line-height: 1;\n      transition: all 0.15s;\n\n      &:hover {\n        background: #f8f9fa;\n        color: #212529;\n      }\n\n      &:active {\n        transform: scale(0.95);\n      }\n    }\n  }\n\n  .panel-body {\n    padding: 32px;\n\n    .form-group {\n      margin-bottom: 28px;\n\n      &:last-child {\n        margin-bottom: 0;\n      }\n\n      label {\n        display: block;\n        margin-bottom: 10px;\n        color: #495057;\n        font-size: 13px;\n        font-weight: 600;\n        letter-spacing: 0.01em;\n        text-transform: uppercase;\n      }\n\n      .section-title-input {\n        width: 100%;\n        box-sizing: border-box;\n        padding: 12px 16px;\n        border: 1.5px solid #e1e4e8;\n        border-radius: 8px;\n        background: #f8f9fa;\n        color: #212529;\n        font-size: 15px;\n        transition: all 0.2s;\n\n        &:hover {\n          background: white;\n          border-color: #cbd3da;\n        }\n\n        &:focus {\n          border-color: #4a90e2;\n          background: white;\n          box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.08);\n          outline: none;\n        }\n\n        &::placeholder {\n          color: #adb5bd;\n        }\n      }\n\n      .color-picker-wrapper {\n        display: flex;\n        align-items: stretch;\n        gap: 14px;\n\n        .section-color-input {\n          width: 64px;\n          height: 48px;\n          padding: 6px;\n          border: 1.5px solid #e1e4e8;\n          border-radius: 8px;\n          cursor: pointer;\n          transition: all 0.2s;\n\n          &:hover {\n            border-color: #4a90e2;\n            box-shadow: 0 2px 8px rgba(74, 144, 226, 0.15);\n          }\n\n          &:focus {\n            border-color: #4a90e2;\n            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.08);\n            outline: none;\n          }\n        }\n\n        .color-hex-input {\n          flex: 1;\n          padding: 12px 16px;\n          border: 1.5px solid #e1e4e8;\n          border-radius: 8px;\n          background: #f8f9fa;\n          color: #495057;\n          font-family: 'SF Mono', 'Monaco', 'Courier New', monospace;\n          font-size: 14px;\n          transition: all 0.2s;\n\n          &:hover {\n            background: white;\n            border-color: #cbd3da;\n          }\n\n          &:focus {\n            border-color: #4a90e2;\n            background: white;\n            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.08);\n            outline: none;\n          }\n\n          &::placeholder {\n            color: #adb5bd;\n          }\n        }\n      }\n    }\n  }\n\n  .panel-footer {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 24px 32px 28px;\n    border-top: 1px solid #e9ecef;\n\n    .footer-actions {\n      display: flex;\n      gap: 12px;\n    }\n\n    button {\n      padding: 12px 24px;\n      border: none;\n      border-radius: 8px;\n      cursor: pointer;\n      font-size: 14px;\n      font-weight: 600;\n      transition: all 0.2s;\n\n      &:active {\n        transform: translateY(1px);\n      }\n    }\n\n    .delete-btn {\n      padding: 12px 16px;\n      margin-right: 16px;\n      border: 1.5px solid #dc3545;\n      background: transparent;\n      color: #dc3545;\n      font-weight: 500;\n\n      &:hover {\n        background: #fff5f5;\n        border-color: #c82333;\n        color: #c82333;\n      }\n\n      &:active {\n        background: #ffe5e5;\n      }\n    }\n\n    .cancel-btn {\n      border: 1.5px solid #e1e4e8;\n      background: white;\n      color: #495057;\n\n      &:hover {\n        border-color: #cbd3da;\n        background: #f8f9fa;\n      }\n\n      &:active {\n        background: #e9ecef;\n      }\n    }\n\n    .save-btn {\n      background: #4a90e2;\n      color: white;\n      box-shadow: 0 2px 8px rgba(74, 144, 226, 0.2);\n\n      &:hover {\n        background: #357abd;\n        box-shadow: 0 4px 12px rgba(74, 144, 226, 0.25);\n        transform: translateY(-1px);\n      }\n\n      &:active {\n        background: #2a5f8f;\n        box-shadow: 0 1px 4px rgba(74, 144, 226, 0.2);\n        transform: translateY(0);\n      }\n    }\n  }\n\n  @keyframes fadeIn {\n    from {\n      opacity: 0;\n    }\n    to {\n      opacity: 1;\n    }\n  }\n\n  @keyframes slideUp {\n    from {\n      opacity: 0;\n      transform: translateY(20px);\n    }\n    to {\n      opacity: 1;\n      transform: translateY(0);\n    }\n  }\n}\n","import { Component, h, Prop, Event, EventEmitter, State, Watch } from '@stencil/core';\nimport { SectionEditorData } from '../../types/section-editor-data';\n\n/**\n * Section Editor Panel Component\n * ===============================\n *\n * Demo Component - NOT Part of Library\n *\n * This component demonstrates how to build custom UI for editing canvas metadata\n * in applications using the grid-builder library.\n *\n * Purpose:\n * --------\n * Shows how to create a side panel for editing section/canvas settings.\n * This is completely custom to your application - the library doesn't provide this.\n *\n * Library Relationship:\n * ---------------------\n * - Library owns: Component placement, layouts, zIndex (grid state)\n * - Host app owns: Canvas metadata (titles, colors, settings) - THIS COMPONENT\n * - Metadata flows: App â†’ Library via canvasMetadata prop\n *\n * Pattern Demonstrated:\n * ---------------------\n * 1. User clicks section header (demo UI)\n * 2. App opens this panel (demo component)\n * 3. User edits title/color\n * 4. App updates canvasMetadata state\n * 5. Library receives updated metadata via prop\n * 6. Library passes backgroundColor to canvas-section\n *\n * Why This Approach:\n * ------------------\n * - Library stays focused on grid logic\n * - Host app controls all presentation/metadata UI\n * - You can use any UI framework (Material, Bootstrap, etc.)\n * - Complete flexibility over settings panel design\n */\n@Component({\n  tag: 'section-editor-panel',\n  styleUrl: 'section-editor-panel.scss',\n  shadow: false,\n})\nexport class SectionEditorPanel {\n  /**\n   * Panel open/closed state\n   * Controlled by parent component (blog-app)\n   */\n  @Prop() isOpen: boolean = false;\n\n  /**\n   * Section data being edited\n   * Passed from parent when user clicks section header\n   */\n  @Prop() sectionData: SectionEditorData | null = null;\n\n  /**\n   * Event: Close panel\n   * Fired when user clicks Cancel, Save, or overlay\n   */\n  @Event() closePanel: EventEmitter<void>;\n\n  /**\n   * Event: Update section\n   * Fired when user clicks Save with edited values\n   * Parent updates canvasMetadata state in response\n   */\n  @Event() updateSection: EventEmitter<{ canvasId: string; title: string; backgroundColor: string }>;\n\n  /**\n   * Event: Preview color change\n   * Fired when user changes color picker (live preview)\n   * Parent temporarily updates canvas background\n   */\n  @Event() previewColorChange: EventEmitter<{ canvasId: string; backgroundColor: string }>;\n\n  /**\n   * Event: Preview title change\n   * Fired when user types in title input (live preview)\n   * Parent temporarily updates canvas title\n   */\n  @Event() previewTitleChange: EventEmitter<{ canvasId: string; title: string }>;\n\n  /**\n   * Event: Delete section\n   * Fired when user clicks Delete button\n   * Parent handles canvas removal\n   */\n  @Event() deleteSection: EventEmitter<{ canvasId: string }>;\n\n  /**\n   * Internal editing state\n   * These track user's changes before saving\n   */\n  @State() editedTitle: string = '';\n  @State() editedColor: string = '';\n\n  /**\n   * Original values when modal opened\n   * Used to revert on cancel\n   */\n  private originalColor: string = '';\n  private originalTitle: string = '';\n\n  @Watch('sectionData')\n  handleSectionDataChange(newData: SectionEditorData | null) {\n    if (newData) {\n      this.editedTitle = newData.title;\n      this.editedColor = newData.backgroundColor;\n      // Store original values for revert on cancel\n      this.originalColor = newData.backgroundColor;\n      this.originalTitle = newData.title;\n    }\n  }\n\n  componentWillLoad() {\n    if (this.sectionData) {\n      this.editedTitle = this.sectionData.title;\n      this.editedColor = this.sectionData.backgroundColor;\n      // Store original values for revert on cancel\n      this.originalColor = this.sectionData.backgroundColor;\n      this.originalTitle = this.sectionData.title;\n    }\n  }\n\n  private handleClose = () => {\n    // Revert to original values on cancel\n    if (this.sectionData) {\n      this.previewColorChange.emit({\n        canvasId: this.sectionData.canvasId,\n        backgroundColor: this.originalColor,\n      });\n      this.previewTitleChange.emit({\n        canvasId: this.sectionData.canvasId,\n        title: this.originalTitle,\n      });\n    }\n    this.closePanel.emit();\n  };\n\n  private handleSave = () => {\n    if (this.sectionData) {\n      this.updateSection.emit({\n        canvasId: this.sectionData.canvasId,\n        title: this.editedTitle,\n        backgroundColor: this.editedColor,\n      });\n      this.closePanel.emit();\n    }\n  };\n\n  private handleDelete = () => {\n    if (this.sectionData) {\n      this.deleteSection.emit({\n        canvasId: this.sectionData.canvasId,\n      });\n      this.closePanel.emit();\n    }\n  };\n\n  private handleTitleInput = (e: Event) => {\n    this.editedTitle = (e.target as HTMLInputElement).value;\n\n    // Emit preview event for live title update\n    if (this.sectionData) {\n      this.previewTitleChange.emit({\n        canvasId: this.sectionData.canvasId,\n        title: this.editedTitle,\n      });\n    }\n  };\n\n  private handleColorInput = (e: Event) => {\n    this.editedColor = (e.target as HTMLInputElement).value;\n\n    // Emit preview event for live color update\n    if (this.sectionData) {\n      this.previewColorChange.emit({\n        canvasId: this.sectionData.canvasId,\n        backgroundColor: this.editedColor,\n      });\n    }\n  };\n\n  render() {\n    if (!this.isOpen || !this.sectionData) {\n      return null;\n    }\n\n    return (\n      <div class=\"section-editor-overlay\" onClick={this.handleClose}>\n        <div class=\"section-editor-panel\" onClick={(e) => e.stopPropagation()}>\n          <div class=\"panel-header\">\n            <h2 class=\"panel-title\">Edit Section</h2>\n            <button class=\"close-btn\" onClick={this.handleClose} title=\"Close\">\n              Ã—\n            </button>\n          </div>\n\n          <div class=\"panel-body\">\n            <div class=\"form-group\">\n              <label htmlFor=\"section-title\">Section Name</label>\n              <input\n                type=\"text\"\n                id=\"section-title\"\n                class=\"section-title-input\"\n                value={this.editedTitle}\n                onInput={this.handleTitleInput}\n                placeholder=\"Enter section name\"\n              />\n            </div>\n\n            <div class=\"form-group\">\n              <label htmlFor=\"section-color\">Background Color</label>\n              <div class=\"color-picker-wrapper\">\n                <input\n                  type=\"color\"\n                  id=\"section-color\"\n                  class=\"section-color-input\"\n                  value={this.editedColor}\n                  onInput={this.handleColorInput}\n                />\n                <input\n                  type=\"text\"\n                  class=\"color-hex-input\"\n                  value={this.editedColor}\n                  onInput={this.handleColorInput}\n                  placeholder=\"#ffffff\"\n                />\n              </div>\n            </div>\n          </div>\n\n          <div class=\"panel-footer\">\n            <button class=\"delete-btn\" onClick={this.handleDelete}>\n              Delete Section\n            </button>\n            <div class=\"footer-actions\">\n              <button class=\"cancel-btn\" onClick={this.handleClose}>\n                Cancel\n              </button>\n              <button class=\"save-btn\" onClick={this.handleSave}>\n                Save Changes\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n"],"names":["debug","gridState","state"],"mappings":"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"}