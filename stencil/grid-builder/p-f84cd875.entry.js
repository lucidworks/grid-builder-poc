import{r as e,h as n}from"./p-CC73Dkup.js";import{e as i}from"./p-C411GiWR.js";import{s as t}from"./p-CDiz7xEh.js";const o="config-panel .config-panel{position:fixed;z-index:2000;top:0;right:-400px;display:flex;width:400px;height:100vh;flex-direction:column;background:white;box-shadow:-2px 0 8px rgba(0, 0, 0, 0.15);transition:right 0.3s ease}config-panel .config-panel.open{right:0}config-panel .config-panel-header{display:flex;align-items:center;justify-content:space-between;padding:20px;border-bottom:1px solid #ddd}config-panel .config-panel-header h2{margin:0;color:#333;font-size:18px}config-panel .config-panel-close{display:flex;width:32px;height:32px;align-items:center;justify-content:center;padding:0;border:none;border-radius:4px;background:transparent;color:#999;cursor:pointer;font-size:24px;transition:all 0.2s}config-panel .config-panel-close:hover{background:#f5f5f5;color:#333}config-panel .config-panel-body{flex:1;padding:20px;overflow-y:auto}config-panel .config-section{margin-bottom:24px}config-panel .config-section h3{margin:0 0 16px 0;color:#333;font-size:14px;font-weight:600;letter-spacing:0.5px;text-transform:uppercase}config-panel .config-section .no-config{color:#999;font-size:13px;font-style:italic}config-panel .config-field{margin-bottom:20px}config-panel .config-field label{display:block;margin-bottom:8px;color:#333;font-size:13px;font-weight:600}config-panel .config-field input[type=text],config-panel .config-field input[type=number],config-panel .config-field input[type=color],config-panel .config-field select,config-panel .config-field textarea{width:100%;box-sizing:border-box;padding:10px 12px;border:1px solid #ddd;border-radius:4px;font-size:13px;transition:border-color 0.2s}config-panel .config-field input[type=text]:focus,config-panel .config-field input[type=number]:focus,config-panel .config-field input[type=color]:focus,config-panel .config-field select:focus,config-panel .config-field textarea:focus{border-color:#4a90e2;outline:none}config-panel .config-field input[type=color]{height:40px;padding:4px}config-panel .config-field textarea{font-family:inherit;resize:vertical}config-panel .config-field.config-field-checkbox label{display:flex;align-items:center;cursor:pointer;gap:8px}config-panel .config-field.config-field-checkbox label input[type=checkbox]{width:auto;margin:0;cursor:pointer}config-panel .config-field .field-error{margin:4px 0 0 0;color:#f44;font-size:12px}config-panel .z-index-controls{display:grid;gap:8px;grid-template-columns:1fr 1fr}config-panel .z-index-btn{padding:10px 12px;border:1px solid #ddd;border-radius:4px;background:white;cursor:pointer;font-size:13px;font-weight:500;text-align:center;transition:all 0.2s}config-panel .z-index-btn:hover{border-color:#4a90e2;background:#f5f5f5;color:#4a90e2}config-panel .config-panel-footer{display:flex;justify-content:flex-end;padding:20px;border-top:1px solid #ddd;gap:10px}config-panel .config-panel-footer button{padding:10px 20px;border:1px solid #ddd;border-radius:4px;background:white;cursor:pointer;font-size:13px;font-weight:500;transition:all 0.2s}config-panel .config-panel-footer button:hover{background:#f5f5f5}config-panel .config-panel-footer button.primary{border-color:#4a90e2;background:#4a90e2;color:white}config-panel .config-panel-footer button.primary:hover{border-color:#357abd;background:#357abd}";const c=class{constructor(n){e(this,n);this.isOpen=false;this.selectedItemId=null;this.selectedCanvasId=null;this.componentName="";this.componentConfig={};this.originalState=null;this.handleComponentDeleted=e=>{console.log("ðŸ”” config-panel received componentDeleted event",{eventItemId:e.itemId,selectedItemId:this.selectedItemId,isOpen:this.isOpen,shouldClose:this.isOpen&&this.selectedItemId&&e.itemId===this.selectedItemId});if(this.isOpen&&this.selectedItemId&&e.itemId===this.selectedItemId){console.log("  âœ… Closing panel because selected item was deleted");this.closePanel()}else{console.log("  â„¹ï¸ Not closing panel - different item or panel already closed")}};this.openPanel=(e,n)=>{var i;this.selectedItemId=e;this.selectedCanvasId=n;const o=this.getSelectedItem();if(!o){return}const c=(i=this.componentRegistry)===null||i===void 0?void 0:i.get(o.type);this.originalState={name:o.name||(c===null||c===void 0?void 0:c.name)||o.type,zIndex:o.zIndex,config:o.config?Object.assign({},o.config):{}};this.componentName=this.originalState.name;this.componentConfig=Object.assign({},this.originalState.config);t.selectedItemId=e;t.selectedCanvasId=n;this.isOpen=true};this.closePanel=()=>{if(this.selectedItemId&&this.selectedCanvasId&&this.originalState){const e=t.canvases[this.selectedCanvasId];const n=e===null||e===void 0?void 0:e.items.findIndex((e=>e.id===this.selectedItemId));if(n!==undefined&&n!==-1){e.items[n]=Object.assign(Object.assign({},e.items[n]),{name:this.originalState.name,zIndex:this.originalState.zIndex,config:this.originalState.config});t.canvases=Object.assign({},t.canvases)}}this.isOpen=false;this.selectedItemId=null;this.selectedCanvasId=null;this.componentName="";this.componentConfig={};this.originalState=null};this.saveConfig=()=>{this.isOpen=false;this.selectedItemId=null;this.selectedCanvasId=null;this.componentName="";this.componentConfig={};this.originalState=null};this.handleNameInput=e=>{const n=e.target;this.componentName=n.value;if(this.selectedItemId&&this.selectedCanvasId){const e=t.canvases[this.selectedCanvasId];const n=e===null||e===void 0?void 0:e.items.findIndex((e=>e.id===this.selectedItemId));if(n!==undefined&&n!==-1){e.items[n]=Object.assign(Object.assign({},e.items[n]),{name:this.componentName});t.canvases=Object.assign({},t.canvases)}}};this.handleConfigChange=(e,n)=>{this.componentConfig=Object.assign(Object.assign({},this.componentConfig),{[e]:n});if(this.selectedItemId&&this.selectedCanvasId){const e=t.canvases[this.selectedCanvasId];const n=e===null||e===void 0?void 0:e.items.findIndex((e=>e.id===this.selectedItemId));if(n!==undefined&&n!==-1){e.items[n]=Object.assign(Object.assign({},e.items[n]),{config:this.componentConfig});t.canvases=Object.assign({},t.canvases)}}};this.bringToFront=()=>{if(!this.selectedItemId||!this.selectedCanvasId)return;const e=t.canvases[this.selectedCanvasId];const n=e===null||e===void 0?void 0:e.items.findIndex((e=>e.id===this.selectedItemId));if(n===undefined||n===-1)return;const i=++e.zIndexCounter;e.items[n]=Object.assign(Object.assign({},e.items[n]),{zIndex:i});t.canvases=Object.assign({},t.canvases)};this.bringForward=()=>{if(!this.selectedItemId||!this.selectedCanvasId)return;const e=t.canvases[this.selectedCanvasId];const n=e===null||e===void 0?void 0:e.items.findIndex((e=>e.id===this.selectedItemId));if(n===undefined||n===-1)return;const i=e.items[n];const o=e.items.filter((e=>e.zIndex>i.zIndex));if(o.length>0){const c=Math.min(...o.map((e=>e.zIndex)));const s=e.items.findIndex((e=>e.zIndex===c));if(s!==-1){const o=i.zIndex;e.items[n]=Object.assign(Object.assign({},i),{zIndex:c});e.items[s]=Object.assign(Object.assign({},e.items[s]),{zIndex:o});t.canvases=Object.assign({},t.canvases)}}};this.sendBackward=()=>{if(!this.selectedItemId||!this.selectedCanvasId)return;const e=t.canvases[this.selectedCanvasId];const n=e===null||e===void 0?void 0:e.items.findIndex((e=>e.id===this.selectedItemId));if(n===undefined||n===-1)return;const i=e.items[n];const o=e.items.filter((e=>e.zIndex<i.zIndex));if(o.length>0){const c=Math.max(...o.map((e=>e.zIndex)));const s=e.items.findIndex((e=>e.zIndex===c));if(s!==-1){const o=i.zIndex;e.items[n]=Object.assign(Object.assign({},i),{zIndex:c});e.items[s]=Object.assign(Object.assign({},e.items[s]),{zIndex:o});t.canvases=Object.assign({},t.canvases)}}};this.sendToBack=()=>{if(!this.selectedItemId||!this.selectedCanvasId)return;const e=t.canvases[this.selectedCanvasId];const n=e===null||e===void 0?void 0:e.items.findIndex((e=>e.id===this.selectedItemId));if(n===undefined||n===-1)return;const i=Math.min(...e.items.map((e=>e.zIndex)));const o=Math.max(1,i-1);if(i<=1){const n=[...e.items].sort(((e,n)=>e.zIndex-n.zIndex));e.items=n.map(((e,n)=>Object.assign(Object.assign({},e),{zIndex:e.id===this.selectedItemId?1:n+2})))}else{e.items[n]=Object.assign(Object.assign({},e.items[n]),{zIndex:o})}t.canvases=Object.assign({},t.canvases)}}handleItemClick(e){const{itemId:n,canvasId:i}=e.detail;this.openPanel(n,i)}componentDidLoad(){console.log("ðŸ“‹ config-panel componentDidLoad - subscribing to componentDeleted event");i.on("componentDeleted",this.handleComponentDeleted);console.log("  âœ… Subscribed to componentDeleted event")}disconnectedCallback(){i.off("componentDeleted",this.handleComponentDeleted)}render(){var e;const i={"config-panel":true,open:this.isOpen};const t=this.getSelectedItem();const o=t?(e=this.componentRegistry)===null||e===void 0?void 0:e.get(t.type):null;return n("div",{key:"3e5fd83240ded1a4349bcac00d2b345247bda24e",class:i},n("div",{key:"ec8de14c8c645ed443f796a77171a73bda875cc8",class:"config-panel-header"},n("h2",{key:"a50de8dd21505b522538f750dc346458309001af"},"Component Settings"),n("button",{key:"76f5f56a695324622c11efb3e268a669a7d9d09e",class:"config-panel-close",onClick:()=>this.closePanel()},"Ã—")),n("div",{key:"ef941c6b822cd87d3c6da816ee687c9e70eb9c87",class:"config-panel-body"},n("div",{key:"2ae59b75f7c62ee63a45ed5fae178bc86a0a8072",class:"config-field"},n("label",{key:"08a196eebe2e4865745fb77bd0d2fae095ef9eba",htmlFor:"componentName"},"Component Name"),n("input",{key:"8743f004ba5e96e3933f6be73c99cf70211833bf",type:"text",id:"componentName",value:this.componentName,onInput:e=>this.handleNameInput(e),placeholder:"Enter component name"})),o&&this.renderConfigFields(o),n("div",{key:"08d641940c32f3ac449bd149dfacf257fcc92643",class:"config-field"},n("label",{key:"726d3915434560ae1a4141eea18fdb0ea7182c85"},"Layer Order"),n("div",{key:"f12aaec6bb9ff048d5458cff44845f5c791e70f4",class:"z-index-controls"},n("button",{key:"c8d59929325b3234b543c7488dec3742c92075fe",class:"z-index-btn",onClick:()=>this.bringToFront(),title:"Bring to Front"},"â¬†ï¸ To Front"),n("button",{key:"86fc308f3d6468aa926ad6c6fe4c5b622cd01bed",class:"z-index-btn",onClick:()=>this.bringForward(),title:"Bring Forward"},"â†‘ Forward"),n("button",{key:"8737d359c67c5cf1c8980d9d2a2d26db41e6413f",class:"z-index-btn",onClick:()=>this.sendBackward(),title:"Send Backward"},"â†“ Backward"),n("button",{key:"db59b047a3c53c9fcfcb2e11079c9951bd76d783",class:"z-index-btn",onClick:()=>this.sendToBack(),title:"Send to Back"},"â¬‡ï¸ To Back")))),n("div",{key:"740be28e6383bcd9a27d5e80a1df63f11fb584e0",class:"config-panel-footer"},n("button",{key:"950fe10ad2bbeace92af640b908c936a3ef73d46",onClick:()=>this.closePanel()},"Cancel"),n("button",{key:"ba3d4dcdfe20b53a7c3a32b9f4b5de075332fb2b",class:"primary",onClick:()=>this.saveConfig()},"Save")))}renderConfigFields(e){if(e.renderConfigPanel){return e.renderConfigPanel({config:this.componentConfig,onChange:this.handleConfigChange,onSave:this.saveConfig,onCancel:this.closePanel})}if(e.configSchema&&e.configSchema.length>0){return n("div",{class:"config-section"},n("h3",null,"Component Configuration"),e.configSchema.map((e=>this.renderConfigField(e))))}return n("div",{class:"config-section"},n("p",{class:"no-config"},"No configuration options available for this component."))}renderConfigField(e){var i,t,o;const c=(t=(i=this.componentConfig[e.name])!==null&&i!==void 0?i:e.defaultValue)!==null&&t!==void 0?t:"";switch(e.type){case"text":return n("div",{class:"config-field",key:e.name},n("label",{htmlFor:e.name},e.label),n("input",{type:"text",id:e.name,value:c,onInput:n=>this.handleConfigChange(e.name,n.target.value),placeholder:e.placeholder}));case"number":return n("div",{class:"config-field",key:e.name},n("label",{htmlFor:e.name},e.label),n("input",{type:"number",id:e.name,value:c,onInput:n=>this.handleConfigChange(e.name,Number(n.target.value)),min:e.min,max:e.max,step:e.step}));case"select":return n("div",{class:"config-field",key:e.name},n("label",{htmlFor:e.name},e.label),n("select",{id:e.name,onChange:n=>this.handleConfigChange(e.name,n.target.value)},(o=e.options)===null||o===void 0?void 0:o.map((e=>{const i=typeof e==="string"?e:e.value;const t=typeof e==="string"?e:e.label;return n("option",{key:i,value:i,selected:c===i},t)}))));case"checkbox":return n("div",{class:"config-field config-field-checkbox",key:e.name},n("label",{htmlFor:e.name},n("input",{type:"checkbox",id:e.name,checked:!!c,onChange:n=>this.handleConfigChange(e.name,n.target.checked)}),e.label));case"color":return n("div",{class:"config-field",key:e.name},n("label",{htmlFor:e.name},e.label),n("input",{type:"color",id:e.name,value:c,onInput:n=>this.handleConfigChange(e.name,n.target.value)}));case"textarea":return n("div",{class:"config-field",key:e.name},n("label",{htmlFor:e.name},e.label),n("textarea",{id:e.name,value:c,onInput:n=>this.handleConfigChange(e.name,n.target.value),placeholder:e.placeholder,rows:e.rows||3}));default:return n("div",{class:"config-field",key:e.name},n("label",null,e.label),n("p",{class:"field-error"},"Unknown field type: ",e.type))}}getSelectedItem(){if(!this.selectedItemId||!this.selectedCanvasId){return null}const e=t.canvases[this.selectedCanvasId];return e===null||e===void 0?void 0:e.items.find((e=>e.id===this.selectedItemId))}};c.style=o;export{c as config_panel};
//# sourceMappingURL=p-f84cd875.entry.js.map