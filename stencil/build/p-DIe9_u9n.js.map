{"version":3,"file":"p-DIe9_u9n.js","sources":["src/utils/visual-feedback.ts"],"sourcesContent":["/**\n * Visual Feedback Utility\n * =======================\n *\n * Animation and visual feedback utilities for click-to-add feature.\n * Provides canvas highlighting, position indicators, and component animations.\n *\n * ## Key Features\n *\n * **Canvas Highlighting**:\n * - Pulse animation on active canvas border\n * - Shows user which canvas will receive the component\n * - Auto-removes after animation completes\n *\n * **Position Indicator (Ghost Outline)**:\n * - Shows where component will be placed\n * - Semi-transparent preview of component size/position\n * - Helps user understand auto-placement logic\n * - Respects custom GridConfig (grid size, constraints)\n *\n * **Component Animation**:\n * - Fade + scale animation for newly added components\n * - Draws attention to new item\n * - Smooth visual feedback\n *\n * ## Performance\n *\n * - Uses CSS animations (GPU-accelerated)\n * - Minimal JavaScript overhead\n * - Cleanup after animations complete\n *\n * @module visual-feedback\n */\n\nimport { GridConfig } from '../types/grid-config';\n\n/**\n * Canvas highlight duration (milliseconds)\n * Duration of pulse animation on canvas border\n */\nconst CANVAS_HIGHLIGHT_DURATION = 600;\n\n/**\n * Position indicator duration (milliseconds)\n * How long ghost outline stays visible\n */\nconst POSITION_INDICATOR_DURATION = 800;\n\n/**\n * Component animation duration (milliseconds)\n * Duration of fade + scale animation for new components\n */\nconst COMPONENT_ANIMATION_DURATION = 400;\n\n/**\n * Highlight canvas with pulse animation\n *\n * Adds visual feedback showing which canvas will receive the component.\n * Useful when user clicks palette item - highlights active canvas.\n *\n * **Visual Effect**:\n * - Pulse animation on canvas border\n * - Color: var(--selection-color) or #f59e0b (amber/gold)\n * - Duration: 600ms\n * - Auto-removes after animation\n *\n * **Implementation**:\n * 1. Find canvas element by ID\n * 2. Add `.canvas-highlight` class (triggers CSS animation)\n * 3. Remove class after animation completes\n *\n * **CSS Animation** (defined in canvas-section.scss):\n * ```scss\n * @keyframes canvas-highlight-pulse {\n *   0%, 100% {\n *     box-shadow: 0 0 0 0 var(--selection-color);\n *     opacity: 1;\n *   }\n *   50% {\n *     box-shadow: 0 0 0 4px var(--selection-color);\n *     opacity: 0.7;\n *   }\n * }\n *\n * .canvas-highlight {\n *   animation: canvas-highlight-pulse 600ms ease-out;\n * }\n * ```\n *\n * **Example Usage**:\n * ```typescript\n * // User clicks palette item\n * highlightCanvas('canvas1');\n * // → Canvas border pulses to show it's active\n * ```\n *\n * @param canvasId - Canvas ID to highlight\n */\nexport function highlightCanvas(canvasId: string): void {\n  const canvasElement = document.getElementById(canvasId);\n\n  if (!canvasElement) {\n    console.warn(`highlightCanvas: Canvas element not found: ${canvasId}`);\n    return;\n  }\n\n  // Add highlight class (triggers CSS animation)\n  canvasElement.classList.add('canvas-highlight');\n\n  // Remove class after animation completes\n  setTimeout(() => {\n    canvasElement.classList.remove('canvas-highlight');\n  }, CANVAS_HIGHLIGHT_DURATION);\n}\n\n/**\n * Show position indicator (ghost outline) where component will be placed\n *\n * Creates a semi-transparent preview showing where the component will appear.\n * Helps user understand auto-placement algorithm results.\n *\n * **Visual Effect**:\n * - Ghost outline at target position\n * - Semi-transparent (30% opacity)\n * - Dashed border\n * - Fade out after 800ms\n *\n * **Grid Configuration**:\n * - Respects custom GridConfig (grid size, min/max constraints)\n * - Uses same grid calculations as actual component positioning\n * - Ensures indicator matches final component size/position\n *\n * **Implementation**:\n * 1. Find canvas container element\n * 2. Convert grid units to pixels (respecting GridConfig)\n * 3. Create ghost div with exact position/size\n * 4. Add `.position-indicator` class (CSS styling)\n * 5. Fade out and remove after delay\n *\n * **CSS Styling** (defined in canvas-section.scss):\n * ```scss\n * .position-indicator {\n *   position: absolute;\n *   border: 2px dashed var(--selection-color);\n *   background: var(--selection-color);\n *   opacity: 0.3;\n *   pointer-events: none;\n *   z-index: 9999;\n *   animation: position-indicator-fade 800ms ease-out forwards;\n * }\n *\n * @keyframes position-indicator-fade {\n *   0% { opacity: 0.3; }\n *   70% { opacity: 0.3; }\n *   100% { opacity: 0; }\n * }\n * ```\n *\n * **Example Usage**:\n * ```typescript\n * // Show where 10×6 component will be placed at (20, 2)\n * showPositionIndicator('canvas1', 20, 2, 10, 6);\n * // → Ghost outline appears at position, fades out\n *\n * // With custom grid config\n * const customConfig = { gridSizePercent: 3 };\n * showPositionIndicator('canvas1', 20, 2, 10, 6, customConfig);\n * // → Ghost outline uses 3% grid size instead of default 2%\n * ```\n *\n * @param canvasId - Canvas ID where component will be placed\n * @param x - X position in grid units\n * @param y - Y position in grid units\n * @param width - Width in grid units\n * @param height - Height in grid units\n * @param config - Optional GridConfig (uses defaults if not provided)\n */\nexport function showPositionIndicator(\n  canvasId: string,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  config?: GridConfig,\n): void {\n  const canvasElement = document.getElementById(canvasId);\n\n  if (!canvasElement) {\n    console.warn(\n      `showPositionIndicator: Canvas element not found: ${canvasId}`,\n    );\n    return;\n  }\n\n  // Import grid calculations (avoid circular dependency by using dynamic import)\n  import('./grid-calculations').then(({ gridToPixelsX, gridToPixelsY }) => {\n    // Convert grid units to pixels (respecting GridConfig)\n    const xPixels = gridToPixelsX(x, canvasId, config);\n    const yPixels = gridToPixelsY(y);\n    const widthPixels = gridToPixelsX(width, canvasId, config);\n    const heightPixels = gridToPixelsY(height);\n\n    // Create ghost indicator element\n    const indicator = document.createElement('div');\n    indicator.className = 'position-indicator';\n    indicator.style.position = 'absolute';\n    indicator.style.transform = `translate(${xPixels}px, ${yPixels}px)`;\n    indicator.style.width = `${widthPixels}px`;\n    indicator.style.height = `${heightPixels}px`;\n\n    // Add to canvas\n    canvasElement.appendChild(indicator);\n\n    // Remove after animation completes\n    setTimeout(() => {\n      if (indicator.parentNode) {\n        indicator.parentNode.removeChild(indicator);\n      }\n    }, POSITION_INDICATOR_DURATION);\n  });\n}\n\n/**\n * Animate component in (fade + scale animation)\n *\n * Adds visual feedback when component is added via click-to-add.\n * Draws attention to newly created item.\n *\n * **Visual Effect**:\n * - Fade in: opacity 0 → 1\n * - Scale in: scale 0.8 → 1\n * - Duration: 400ms\n * - Easing: ease-out\n *\n * **Implementation**:\n * 1. Find grid item element by ID\n * 2. Add `.component-animate-in` class (triggers CSS animation)\n * 3. Remove class after animation completes\n *\n * **CSS Animation** (defined in grid-item-wrapper.scss):\n * ```scss\n * @keyframes component-animate-in {\n *   0% {\n *     opacity: 0;\n *     transform: scale(0.8);\n *   }\n *   100% {\n *     opacity: 1;\n *     transform: scale(1);\n *   }\n * }\n *\n * .component-animate-in {\n *   animation: component-animate-in 400ms ease-out;\n * }\n * ```\n *\n * **Example Usage**:\n * ```typescript\n * // After adding component with id 'item-123'\n * animateComponentIn('item-123');\n * // → Component fades and scales in\n * ```\n *\n * **Note**: Call this AFTER the component has been added to the DOM.\n * Use a small delay (e.g., 50ms) to ensure DOM update has completed.\n *\n * @param itemId - Grid item ID to animate\n */\nexport function animateComponentIn(itemId: string): void {\n  // Small delay to ensure DOM update has completed\n  setTimeout(() => {\n    const itemElement = document.getElementById(itemId);\n\n    if (!itemElement) {\n      console.warn(`animateComponentIn: Item element not found: ${itemId}`);\n      return;\n    }\n\n    // Add animation class (triggers CSS animation)\n    itemElement.classList.add('component-animate-in');\n\n    // Remove class after animation completes\n    setTimeout(() => {\n      itemElement.classList.remove('component-animate-in');\n    }, COMPONENT_ANIMATION_DURATION);\n  }, 50); // 50ms delay for DOM update\n}\n"],"names":[],"mappings":"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"}