{"file":"grid-builder-app.entry.esm.js","mappings":";;;;;;;;;AAAA;;;;;;;AAUA;;;;MAIa,eAAe;IAK1B;QAHQ,iBAAY,GAAgB,IAAI,GAAG,EAAE,CAAC;QACtC,gBAAW,GAAwB,IAAI,GAAG,EAAE,CAAC;;QAInD,IAAI,CAAC,QAAQ,GAAG,IAAI,oBAAoB,CACtC,CAAC,OAAO;YACN,OAAO,CAAC,OAAO,CAAC,CAAC,KAAK;gBACpB,MAAM,WAAW,GAAG,KAAK,CAAC,MAAqB,CAAC;gBAChD,MAAM,MAAM,GAAG,WAAW,CAAC,EAAE,CAAC;gBAC9B,MAAM,QAAQ,GAAG,WAAW,CAAC,YAAY,CAAC,gBAAgB,CAAyB,CAAC;gBAEpF,IAAI,KAAK,CAAC,cAAc,EAAE;;oBAExB,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE;wBAClC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;wBAC9B,IAAI,CAAC,0BAA0B,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;qBACnD;iBACF;qBAAM;;oBAEL,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;iBAClC;aACF,CAAC,CAAC;SACJ,EACD;YACE,UAAU,EAAE,OAAO;YACnB,SAAS,EAAE,IAAI;SAChB,CACF,CAAC;KACH;;;;IAKD,OAAO,CAAC,OAAoB,EAAE,OAAe,EAAE,QAA8B;;QAE3E,OAAO,CAAC,YAAY,CAAC,gBAAgB,EAAE,QAAQ,CAAC,CAAC;QACjD,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;KAChC;;;;IAKD,SAAS,CAAC,MAAc;QACtB,MAAM,OAAO,GAAG,QAAQ,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;QAChD,IAAI,OAAO,EAAE;YACX,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;SAClC;;QAGD,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QAErB,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;KAClC;;;;IAKD,OAAO;QACL,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;;QAG3B,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,UAAU,KAAK,aAAa,CAAC,UAAU,CAAC,CAAC,CAAC;QACpE,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC;QACzB,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC;KAC3B;;;;IAKO,OAAO,CAAC,MAAc;QAC5B,MAAM,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QAChD,IAAI,UAAU,EAAE;YACd,aAAa,CAAC,UAAU,CAAC,CAAC;YAC1B,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;SACjC;KACF;;;;;IAMO,0BAA0B,CAAC,MAAc,EAAE,IAA0B;QAC3E,MAAM,SAAS,GAAG,QAAQ,CAAC,cAAc,CAAC,GAAG,MAAM,UAAU,CAAC,CAAC;QAC/D,IAAI,CAAC,SAAS,EAAE;YACd,OAAO;SACR;;QAGD,IAAI,SAAS,CAAC,OAAO,CAAC,WAAW,KAAK,MAAM,EAAE;YAC5C,OAAO;SACR;QACD,SAAS,CAAC,OAAO,CAAC,WAAW,GAAG,MAAM,CAAC;QAEvC,QAAQ,IAAI;YACV,KAAK,SAAS;gBACZ,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;gBAC9B,MAAM;YAER,KAAK,WAAW;gBACd,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC,CAAC;gBAChC,MAAM;YAER,KAAK,UAAU;gBACb,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;gBACvC,MAAM;SACT;KACF;;;;IAKO,aAAa,CAAC,SAAsB;QAC1C,SAAS,CAAC,SAAS,GAAG;;;uDAG6B,IAAI,CAAC,MAAM,EAAE;;;uDAGb,IAAI,CAAC,MAAM,EAAE;;;uDAGb,IAAI,CAAC,MAAM,EAAE;;;uDAGb,IAAI,CAAC,MAAM,EAAE;;;uDAGb,IAAI,CAAC,MAAM,EAAE;;;uDAGb,IAAI,CAAC,MAAM,EAAE;;;KAG/D,CAAC;KACH;;;;IAKO,eAAe,CAAC,SAAsB;QAC5C,SAAS,CAAC,SAAS,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KA8BrB,CAAC;KACH;;;;IAKO,cAAc,CAAC,SAAsB,EAAE,MAAc;QAC3D,IAAI,OAAO,GAAG,CAAC,CAAC;QAEhB,MAAM,cAAc,GAAG;YACrB,OAAO,EAAE,CAAC;YACV,MAAM,WAAW,GAAG,CAAC,EAAE,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC;YACzD,MAAM,GAAG,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,GAAG,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC;YAC7C,MAAM,MAAM,GAAG,CAAC,EAAE,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC;YAEpD,IAAI,SAAS,EAAE;gBACb,SAAS,CAAC,SAAS,GAAG;;;;gFAIkD,WAAW;;;;;wBAKnE,GAAG;;;wEAG6C,GAAG;;;;;;wBAMnD,MAAM;;;wEAG0C,MAAM;;;;wBAItD,OAAO,kBAAkB,IAAI,IAAI,EAAE,CAAC,kBAAkB,EAAE;;;SAGvE,CAAC;aACH;SACF,CAAC;;QAGF,cAAc,EAAE,CAAC;;QAGjB,MAAM,UAAU,GAAG,MAAM,CAAC,WAAW,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;;QAG5D,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,MAAM,EAAE,UAAU,CAAC,CAAC;KAC1C;;;ACnPH,MAAM,iBAAiB,GAAG,mkDAAmkD;;MCehlD,cAAc;;;yBACI,CAAC;;IAE9B,iBAAiB;;;QAGd,MAAc,CAAC,QAAQ,GAAGA,YAAQ,CAAC;;QAGpC,IAAI,CAAC,eAAe,EAAE,CAAC;KACxB;IAED,mBAAmB;;QAEjB,IAAI,CAAC,eAAe,EAAE,CAAC;KACxB;IAED,gBAAgB;;QAEd,IAAI,CAAC,eAAe,EAAE,CAAC;;QAGvB,IAAK,MAAc,CAAC,kBAAkB,EAAE;YACrC,MAAc,CAAC,WAAW,GAAG,IAAK,MAAc,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;SACjF;;QAGA,MAAc,CAAC,eAAe,GAAG,IAAI,eAAe,EAAE,CAAC;;QAGvD,MAAc,CAAC,kBAAkB,GAAG;YACnC,MAAM,aAAa,GAAIA,YAAgB,CAAC,aAAa,CAAC,IAAI,CAAC;YAC3D,OAAO,CAAC,GAAG,CAAC,sBAAsB,EAAE,aAAa,CAAC,MAAM,CAAC,CAAC;YAC1D,aAAa,CAAC,OAAO,CAAC,CAAC,YAAiB,EAAE,KAAa;gBACrD,OAAO,CAAC,GAAG,CAAC,gBAAgB,KAAK,GAAG,EAAE;oBACpC,MAAM,EAAE,YAAY,CAAC,MAAM;oBAC3B,OAAO,EAAE,YAAY,CAAC,QAAQ;oBAC9B,OAAO,EAAE,YAAY,CAAC,OAAO;iBAC9B,CAAC,CAAC;aACJ,CAAC,CAAC;SACJ,CAAC;;QAGF,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;KACtE;IAED,oBAAoB;QAClB,QAAQ,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;KACzE;IAGD,gBAAgB,CAAC,KAAkB;QACjC,MAAM,EAAE,QAAQ,EAAE,aAAa,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,KAAK,CAAC,MAAM,CAAC;;QAGvD,MAAM,QAAQ,GAAG,kBAAkB,CAAC,aAAa,CAAC,CAAC;QACnD,IAAI,CAAC,QAAQ,EAAE;YACb,OAAO,CAAC,KAAK,CAAC,yBAAyB,EAAE,aAAa,CAAC,CAAC;YACxD,OAAO;SACR;;QAGD,MAAM,KAAK,GAAG,aAAa,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;QACzC,MAAM,KAAK,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC;;QAG/B,MAAM,MAAM,GAAGC,KAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAC5C,IAAI,CAAC,MAAM,EAAE;YACX,OAAO,CAAC,KAAK,CAAC,mBAAmB,EAAE,QAAQ,CAAC,CAAC;YAC7C,OAAO;SACR;;QAGD,MAAM,OAAO,GAAG;YACd,EAAE,EAAE,cAAc,EAAE;YACpB,QAAQ;YACR,IAAI,EAAE,aAAa;YACnB,IAAI,EAAE,QAAQ,CAAC,KAAK;YACpB,OAAO,EAAE;gBACP,OAAO,EAAE;oBACP,CAAC,EAAE,KAAK;oBACR,CAAC,EAAE,KAAK;oBACR,KAAK,EAAE,EAAE;oBACT,MAAM,EAAE,CAAC;iBACV;gBACD,MAAM,EAAE;oBACN,CAAC,EAAE,IAAI;oBACP,CAAC,EAAE,IAAI;oBACP,KAAK,EAAE,IAAI;oBACX,MAAM,EAAE,IAAI;oBACZ,UAAU,EAAE,KAAK;iBAClB;aACF;YACD,MAAM,EAAE,MAAM,CAAC,aAAa,EAAE;SAC/B,CAAC;;QAGF,eAAe,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;;QAGnC,WAAW,CAAC,IAAI,cAAc,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC;;QAGnDA,KAAS,CAAC,QAAQ,qBAAQA,KAAS,CAAC,QAAQ,CAAE,CAAC;KAChD;IAGD,gBAAgB,CAAC,KAAkB;QACjC,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,GAAG,KAAK,CAAC,MAAM,CAAC;;QAG1C,MAAM,MAAM,GAAGA,KAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAC5C,IAAI,CAAC,MAAM,EAAE;YACX,OAAO;SACR;QAED,MAAM,SAAS,GAAG,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,MAAM,CAAC,CAAC;QACjE,MAAM,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;QACrC,IAAI,CAAC,IAAI,EAAE;YACT,OAAO;SACR;;QAGD,WAAW,CAAC,IAAI,iBAAiB,CAAC,QAAQ,EAAE,IAAI,EAAE,SAAS,CAAC,CAAC,CAAC;;QAG9D,oBAAoB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;QACvCA,KAAS,CAAC,QAAQ,qBAAQA,KAAS,CAAC,QAAQ,CAAE,CAAC;KAChD;IAGD,gBAAgB,CAAC,KAAkB;QACjC,MAAM,EAAE,MAAM,EAAE,cAAc,EAAE,cAAc,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,KAAK,CAAC,MAAM,CAAC;;QAGtE,MAAM,YAAY,GAAGA,KAAS,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;QACxD,MAAM,WAAW,GAAG,YAAY,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,MAAM,CAAC,CAAC;QACzE,MAAM,IAAI,GAAG,YAAY,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;QAE7C,IAAI,CAAC,IAAI,EAAE;YACT,OAAO;SACR;;QAGD,MAAM,cAAc,GAAG;YACrB,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;YACzB,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;SAC1B,CAAC;;QAGF,MAAM,KAAK,GAAG,aAAa,CAAC,CAAC,EAAE,cAAc,CAAC,CAAC;QAC/C,MAAM,KAAK,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC;;QAG/B,MAAM,cAAc,GAAG;YACrB,CAAC,EAAE,KAAK;YACR,CAAC,EAAE,KAAK;SACT,CAAC;;QAGF,WAAW,CACT,IAAI,eAAe,CAAC,MAAM,EAAE,cAAc,EAAE,cAAc,EAAE,cAAc,EAAE,cAAc,EAAE,WAAW,CAAC,CACzG,CAAC;;QAGF,IAAI,CAAC,QAAQ,GAAG,cAAc,CAAC;QAC/B,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,GAAG,KAAK,CAAC;QAC/B,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,GAAG,KAAK,CAAC;;QAG/B,YAAY,CAAC,KAAK,GAAG,YAAY,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,MAAM,CAAC,CAAC;;QAGvE,MAAM,YAAY,GAAGA,KAAS,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;QACxD,YAAY,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;QAG9BA,KAAS,CAAC,QAAQ,qBAAQA,KAAS,CAAC,QAAQ,CAAE,CAAC;KAChD;IAED,MAAM;QACJ,MAAM,SAAS,GAAG,MAAM,CAAC,IAAI,CAACA,KAAS,CAAC,QAAQ,CAAC,CAAC;QAElD,QACE,EAAC,IAAI,QACH,WAAK,KAAK,EAAC,KAAK,IAEd,4BAAqB,EAGrB,WAAK,KAAK,EAAC,QAAQ,IACjB,WAAK,KAAK,EAAC,eAAe,IACxB,qDAA6C,EAC7C,yHAGI,EAEJ,WAAK,KAAK,EAAC,UAAU,IAEnB,WAAK,KAAK,EAAC,iBAAiB,IAC1B,cACE,KAAK,EAAE;gBACL,cAAc,EAAE,IAAI;gBACpB,MAAM,EAAEA,KAAS,CAAC,eAAe,KAAK,SAAS;aAChD,EACD,OAAO,EAAE,MAAM,IAAI,CAAC,oBAAoB,CAAC,SAAS,CAAC,iCAG5C,EACT,cACE,KAAK,EAAE;gBACL,cAAc,EAAE,IAAI;gBACpB,MAAM,EAAEA,KAAS,CAAC,eAAe,KAAK,QAAQ;aAC/C,EACD,OAAO,EAAE,MAAM,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,0BAG3C,CACL,EAEN,cAAQ,KAAK,EAAE,EAAE,MAAM,EAAEA,KAAS,CAAC,QAAQ,EAAE,EAAE,OAAO,EAAE,MAAM,IAAI,CAAC,gBAAgB,EAAE,IAClFA,KAAS,CAAC,QAAQ,GAAG,WAAW,GAAG,WAAW,CACxC,EAET,cAAQ,OAAO,EAAE,MAAM,IAAI,CAAC,iBAAiB,EAAE,mBAAuB,EAEtE,cAAQ,OAAO,EAAE,MAAM,IAAI,CAAC,gBAAgB,EAAE,yBAAwB,EAEtE,cAAQ,OAAO,EAAE,MAAM,IAAI,CAAC,gBAAgB,EAAE,+BAAyB,EAGvE,WACE,KAAK,EAAE;gBACL,OAAO,EAAE,aAAa;gBACtB,UAAU,EAAE,QAAQ;gBACpB,GAAG,EAAE,KAAK;gBACV,UAAU,EAAE,MAAM;gBAClB,OAAO,EAAE,UAAU;gBACnB,UAAU,EAAE,SAAS;gBACrB,MAAM,EAAE,mBAAmB;gBAC3B,YAAY,EAAE,KAAK;aACpB,IAED,YAAM,KAAK,EAAE,EAAE,QAAQ,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,UAAU,EAAE,KAAK,EAAE,IAAG,IAAI,CAAC,SAAS,WAAc,CAC9F,EAGN,WAAK,KAAK,EAAC,kBAAkB,IAC3B,YAAM,KAAK,EAAC,wBAAwB,eAAgB,EACpD,cAAQ,QAAQ,EAAE,CAAC,CAAC,MAAM,MAAM,CAAC,QAAQ,CAAC,IAAI,GAAI,CAAC,CAAC,MAA4B,CAAC,KAAK,CAAC,IACrF,cAAQ,KAAK,EAAC,cAAc,eAAkB,EAC9C,cAAQ,KAAK,EAAC,eAAe,6BAAsB,EACnD,cAAQ,KAAK,EAAC,aAAa,2BAAoB,EAC/C,cAAQ,KAAK,EAAC,aAAa,2BAAoB,EAC/C,cAAQ,KAAK,EAAC,aAAa,EAAC,QAAQ,mCAE3B,CACF,CACL,CACF,CACF,EAGN,WACE,KAAK,EAAE;gBACL,oBAAoB,EAAE,IAAI;gBAC1B,aAAa,EAAEA,KAAS,CAAC,eAAe,KAAK,QAAQ;aACtD,IAEA,SAAS,CAAC,GAAG,CAAC,CAAC,QAAQ,EAAE,KAAK,MAC7B,sBAAgB,QAAQ,EAAE,QAAQ,EAAE,aAAa,EAAE,KAAK,GAAG,CAAC,EAAE,GAAG,EAAE,QAAQ,GAAI,CAChF,CAAC,CACE,CACF,CACF,EAGN,uBAAgB,CACX,EACP;KACH;IAEO,eAAe;QACrB,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,CAACA,KAAS,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,MAAM,KAAK,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;KAC1G;IAEO,cAAc,CAAC,CAAgB;;QAErC,IAAI,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,OAAO,KAAK,CAAC,CAAC,GAAG,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,QAAQ,EAAE;YAC5D,CAAC,CAAC,cAAc,EAAE,CAAC;YACnB,IAAI,EAAE,CAAC;YACP,OAAO;SACR;;QAGD,IAAI,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,OAAO,MAAM,CAAC,CAAC,GAAG,KAAK,GAAG,KAAK,CAAC,CAAC,GAAG,KAAK,GAAG,IAAI,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE;YAChF,CAAC,CAAC,cAAc,EAAE,CAAC;YACnB,IAAI,EAAE,CAAC;YACP,OAAO;SACR;;QAGD,IAAI,CAAC,CAAC,GAAG,KAAK,QAAQ,IAAIA,KAAS,CAAC,cAAc,EAAE;YAClD,IAAI,CAAC,oBAAoB,EAAE,CAAC;SAC7B;;QAGD,IAAI,CAAC,CAAC,GAAG,KAAK,QAAQ,EAAE;YACtBA,KAAS,CAAC,cAAc,GAAG,IAAI,CAAC;YAChCA,KAAS,CAAC,gBAAgB,GAAG,IAAI,CAAC;SACnC;KACF;IAEO,oBAAoB;QAC1B,IAAI,CAACA,KAAS,CAAC,cAAc,IAAI,CAACA,KAAS,CAAC,gBAAgB,EAAE;YAC5D,OAAO;SACR;QAED,MAAM,MAAM,GAAGA,KAAS,CAAC,QAAQ,CAACA,KAAS,CAAC,gBAAgB,CAAC,CAAC;QAC9D,IAAI,CAAC,MAAM,EAAE;YACX,OAAO;SACR;;QAGD,MAAM,SAAS,GAAG,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,KAAKA,KAAS,CAAC,cAAc,CAAC,CAAC;QACnF,MAAM,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;QACrC,IAAI,CAAC,IAAI,EAAE;YACT,OAAO;SACR;;QAGD,WAAW,CAAC,IAAI,iBAAiB,CAACA,KAAS,CAAC,gBAAgB,EAAE,IAAI,EAAE,SAAS,CAAC,CAAC,CAAC;;QAGhF,MAAM,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,KAAKA,KAAS,CAAC,cAAc,CAAC,CAAC;QAC7EA,KAAS,CAAC,cAAc,GAAG,IAAI,CAAC;QAChCA,KAAS,CAAC,gBAAgB,GAAG,IAAI,CAAC;;QAGlCA,KAAS,CAAC,QAAQ,qBAAQA,KAAS,CAAC,QAAQ,CAAE,CAAC;KAChD;IAEO,oBAAoB,CAAC,QAA8B;;;;;;;;;;;;;QAazDA,KAAS,CAAC,eAAe,GAAG,QAAQ,CAAC;KACtC;IAEO,gBAAgB;QACtBA,KAAS,CAAC,QAAQ,GAAG,CAACA,KAAS,CAAC,QAAQ,CAAC;KAC1C;IAEO,iBAAiB;QACvB,MAAMC,OAAK,GAAG;YACZ,QAAQ,EAAED,KAAS,CAAC,QAAQ;YAC5B,eAAe,EAAEA,KAAS,CAAC,eAAe;YAC1C,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;SACpC,CAAC;QAEF,OAAO,CAAC,GAAG,CAAC,aAAa,EAAEC,OAAK,CAAC,CAAC;QAClC,KAAK,CAAC,mDAAmD,IAAI,CAAC,SAAS,eAAeD,KAAS,CAAC,eAAe,EAAE,CAAC,CAAC;KACpH;IAEO,gBAAgB;;QAEtB,MAAM,SAAS,GAAG,MAAM,CAAC,IAAI,CAACA,KAAS,CAAC,QAAQ,CAAC,CAAC;QAClD,MAAM,MAAM,GAAG,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC;QACpC,MAAM,WAAW,GAAG,SAAS,MAAM,EAAE,CAAC;QAEtCA,KAAS,CAAC,QAAQ,mCACbA,KAAS,CAAC,QAAQ,KACrB,CAAC,WAAW,GAAG;gBACb,KAAK,EAAE,EAAE;gBACT,aAAa,EAAE,CAAC;gBAChB,eAAe,EAAE,SAAS;aAC3B,GACF,CAAC;QAEF,KAAK,CAAC,WAAW,MAAM,SAAS,CAAC,CAAC;KACnC;IAEO,gBAAgB;;QAEtB,MAAM,KAAK,GAAG,MAAM,CAAC,iCAAiC,EAAE,KAAK,CAAC,CAAC;QAC/D,IAAI,CAAC,KAAK,EAAE;YACV,OAAO;SACR;QAED,MAAM,KAAK,GAAG,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;QAClC,IAAI,KAAK,CAAC,KAAK,CAAC,IAAI,KAAK,GAAG,CAAC,IAAI,KAAK,GAAG,IAAI,EAAE;YAC7C,KAAK,CAAC,0CAA0C,CAAC,CAAC;YAClD,OAAO;SACR;;QAGD,MAAM,cAAc,GAAG,MAAM,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;QACvD,MAAM,SAAS,GAAG,MAAM,CAAC,IAAI,CAACA,KAAS,CAAC,QAAQ,CAAC,CAAC;;QAGlD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAE;;YAE9B,MAAM,aAAa,GAAG,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,cAAc,CAAC,MAAM,CAAC,CAAC,CAAC;YACxF,MAAM,QAAQ,GAAG,kBAAkB,CAAC,aAAa,CAAC,CAAC;;YAGnD,MAAM,QAAQ,GAAG,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;YACzE,MAAM,MAAM,GAAGA,KAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;;YAG5C,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;YAC7C,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC;;YAG9C,MAAM,OAAO,GAAG;gBACd,EAAE,EAAE,cAAc,EAAE;gBACpB,QAAQ;gBACR,IAAI,EAAE,aAAa;gBACnB,IAAI,EAAE,GAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE;gBAClC,OAAO,EAAE;oBACP,OAAO,EAAE;wBACP,CAAC,EAAE,KAAK;wBACR,CAAC,EAAE,KAAK;wBACR,KAAK,EAAE,EAAE;wBACT,MAAM,EAAE,CAAC;qBACV;oBACD,MAAM,EAAE;wBACN,CAAC,EAAE,IAAI;wBACP,CAAC,EAAE,IAAI;wBACP,KAAK,EAAE,IAAI;wBACX,MAAM,EAAE,IAAI;wBACZ,UAAU,EAAE,KAAK;qBAClB;iBACF;gBACD,MAAM,EAAE,MAAM,CAAC,aAAa,EAAE;aAC/B,CAAC;;YAGF,eAAe,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;SACpC;;QAGDA,KAAS,CAAC,QAAQ,qBAAQA,KAAS,CAAC,QAAQ,CAAE,CAAC;QAE/C,KAAK,CAAC,SAAS,KAAK,SAAS,CAAC,CAAC;KAChC;;;;;;","names":["interact","gridState","state"],"sources":["src/utils/virtual-rendering.ts","src/components/grid-builder-app/grid-builder-app.css?tag=grid-builder-app","src/components/grid-builder-app/grid-builder-app.tsx"],"sourcesContent":["/**\n * Virtual Rendering Utility\n * Lazy-load complex components using IntersectionObserver\n *\n * Purpose: Only initialize complex/heavy components when they become visible\n * This improves initial render performance and reduces memory usage\n */\n\ntype ComplexComponentType = 'gallery' | 'dashboard' | 'livedata';\n\n/**\n * Virtual Renderer using IntersectionObserver\n * Observes grid items and initializes complex components when visible\n */\nexport class VirtualRenderer {\n  private observer: IntersectionObserver;\n  private visibleItems: Set<string> = new Set();\n  private intervalIds: Map<string, number> = new Map();\n\n  constructor() {\n    // Create observer with 200px margin (pre-render before entering viewport)\n    this.observer = new IntersectionObserver(\n      (entries) => {\n        entries.forEach((entry) => {\n          const itemElement = entry.target as HTMLElement;\n          const itemId = itemElement.id;\n          const itemType = itemElement.getAttribute('data-item-type') as ComplexComponentType;\n\n          if (entry.isIntersecting) {\n            // Item is visible - check if we need to initialize it\n            if (!this.visibleItems.has(itemId)) {\n              this.visibleItems.add(itemId);\n              this.initializeComplexComponent(itemId, itemType);\n            }\n          } else {\n            // Item left viewport - cleanup if needed\n            this.visibleItems.delete(itemId);\n          }\n        });\n      },\n      {\n        rootMargin: '200px', // Start loading 200px before entering viewport\n        threshold: 0.01, // Trigger when even 1% is visible\n      }\n    );\n  }\n\n  /**\n   * Start observing an element for lazy loading\n   */\n  observe(element: HTMLElement, _itemId: string, itemType: ComplexComponentType): void {\n    // Store item type as data attribute for retrieval in observer callback\n    element.setAttribute('data-item-type', itemType);\n    this.observer.observe(element);\n  }\n\n  /**\n   * Stop observing an element\n   */\n  unobserve(itemId: string): void {\n    const element = document.getElementById(itemId);\n    if (element) {\n      this.observer.unobserve(element);\n    }\n\n    // Cleanup any intervals\n    this.cleanup(itemId);\n\n    this.visibleItems.delete(itemId);\n  }\n\n  /**\n   * Destroy the virtual renderer\n   */\n  destroy(): void {\n    this.observer.disconnect();\n\n    // Cleanup all intervals\n    this.intervalIds.forEach((intervalId) => clearInterval(intervalId));\n    this.intervalIds.clear();\n    this.visibleItems.clear();\n  }\n\n  /**\n   * Cleanup resources for an item\n   */\n  private cleanup(itemId: string): void {\n    const intervalId = this.intervalIds.get(itemId);\n    if (intervalId) {\n      clearInterval(intervalId);\n      this.intervalIds.delete(itemId);\n    }\n  }\n\n  /**\n   * Initialize complex component behavior\n   * Only called when item becomes visible (via Intersection Observer)\n   */\n  private initializeComplexComponent(itemId: string, type: ComplexComponentType): void {\n    const contentEl = document.getElementById(`${itemId}-content`);\n    if (!contentEl) {\n      return;\n    }\n\n    // Check if already initialized (prevent double-init)\n    if (contentEl.dataset.initialized === 'true') {\n      return;\n    }\n    contentEl.dataset.initialized = 'true';\n\n    switch (type) {\n      case 'gallery':\n        this.renderGallery(contentEl);\n        break;\n\n      case 'dashboard':\n        this.renderDashboard(contentEl);\n        break;\n\n      case 'livedata':\n        this.renderLiveData(contentEl, itemId);\n        break;\n    }\n  }\n\n  /**\n   * Render image gallery component\n   */\n  private renderGallery(contentEl: HTMLElement): void {\n    contentEl.innerHTML = `\n      <div style=\"display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; height: 100%;\">\n        <div style=\"position: relative; width: 100%; padding-bottom: 100%; overflow: hidden; border-radius: 4px; background: #f0f0f0;\">\n          <img src=\"https://picsum.photos/400?random=${Math.random()}\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;\" loading=\"lazy\" alt=\"Gallery image 1\">\n        </div>\n        <div style=\"position: relative; width: 100%; padding-bottom: 100%; overflow: hidden; border-radius: 4px; background: #f0f0f0;\">\n          <img src=\"https://picsum.photos/400?random=${Math.random()}\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;\" loading=\"lazy\" alt=\"Gallery image 2\">\n        </div>\n        <div style=\"position: relative; width: 100%; padding-bottom: 100%; overflow: hidden; border-radius: 4px; background: #f0f0f0;\">\n          <img src=\"https://picsum.photos/400?random=${Math.random()}\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;\" loading=\"lazy\" alt=\"Gallery image 3\">\n        </div>\n        <div style=\"position: relative; width: 100%; padding-bottom: 100%; overflow: hidden; border-radius: 4px; background: #f0f0f0;\">\n          <img src=\"https://picsum.photos/400?random=${Math.random()}\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;\" loading=\"lazy\" alt=\"Gallery image 4\">\n        </div>\n        <div style=\"position: relative; width: 100%; padding-bottom: 100%; overflow: hidden; border-radius: 4px; background: #f0f0f0;\">\n          <img src=\"https://picsum.photos/400?random=${Math.random()}\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;\" loading=\"lazy\" alt=\"Gallery image 5\">\n        </div>\n        <div style=\"position: relative; width: 100%; padding-bottom: 100%; overflow: hidden; border-radius: 4px; background: #f0f0f0;\">\n          <img src=\"https://picsum.photos/400?random=${Math.random()}\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;\" loading=\"lazy\" alt=\"Gallery image 6\">\n        </div>\n      </div>\n    `;\n  }\n\n  /**\n   * Render dashboard widget component\n   */\n  private renderDashboard(contentEl: HTMLElement): void {\n    contentEl.innerHTML = `\n      <div style=\"font-size: 11px; line-height: 1.4;\">\n        <div style=\"display: flex; justify-content: space-between; margin-bottom: 8px;\">\n          <div style=\"flex: 1; padding: 6px; background: #f0f0f0; border-radius: 3px; margin-right: 4px;\">\n            <div style=\"font-weight: 600; color: #666;\">Users</div>\n            <div style=\"font-size: 16px; font-weight: 700; color: #4A90E2;\">2,547</div>\n          </div>\n          <div style=\"flex: 1; padding: 6px; background: #f0f0f0; border-radius: 3px;\">\n            <div style=\"font-weight: 600; color: #666;\">Revenue</div>\n            <div style=\"font-size: 16px; font-weight: 700; color: #28a745;\">$12.4K</div>\n          </div>\n        </div>\n        <div style=\"background: #f8f8f8; padding: 8px; border-radius: 3px; margin-bottom: 6px;\">\n          <div style=\"font-weight: 600; margin-bottom: 4px;\">Activity Chart</div>\n          <div style=\"display: flex; align-items: flex-end; height: 40px; gap: 2px;\">\n            <div style=\"flex: 1; background: #4A90E2; height: 60%;\"></div>\n            <div style=\"flex: 1; background: #4A90E2; height: 80%;\"></div>\n            <div style=\"flex: 1; background: #4A90E2; height: 40%;\"></div>\n            <div style=\"flex: 1; background: #4A90E2; height: 90%;\"></div>\n            <div style=\"flex: 1; background: #4A90E2; height: 70%;\"></div>\n            <div style=\"flex: 1; background: #4A90E2; height: 85%;\"></div>\n            <div style=\"flex: 1; background: #4A90E2; height: 95%;\"></div>\n          </div>\n        </div>\n        <div style=\"font-size: 10px; color: #999;\">\n          <div>‚Ä¢ 24 active sessions</div>\n          <div>‚Ä¢ 156 page views</div>\n          <div>‚Ä¢ 89% bounce rate</div>\n        </div>\n      </div>\n    `;\n  }\n\n  /**\n   * Render live data component (with polling)\n   */\n  private renderLiveData(contentEl: HTMLElement, itemId: string): void {\n    let counter = 0;\n\n    const updateLiveData = () => {\n      counter++;\n      const temperature = (20 + Math.random() * 10).toFixed(1);\n      const cpu = (Math.random() * 100).toFixed(0);\n      const memory = (40 + Math.random() * 50).toFixed(0);\n\n      if (contentEl) {\n        contentEl.innerHTML = `\n          <div style=\"font-size: 11px;\">\n            <div style=\"margin-bottom: 8px; padding: 6px; background: #e3f2fd; border-radius: 3px;\">\n              <div style=\"font-weight: 600; color: #1976d2;\">üå°Ô∏è Temperature</div>\n              <div style=\"font-size: 20px; font-weight: 700; color: #1976d2;\">${temperature}¬∞C</div>\n            </div>\n            <div style=\"margin-bottom: 6px;\">\n              <div style=\"display: flex; justify-content: space-between; margin-bottom: 2px;\">\n                <span style=\"font-weight: 600;\">CPU</span>\n                <span>${cpu}%</span>\n              </div>\n              <div style=\"background: #e0e0e0; height: 6px; border-radius: 3px; overflow: hidden;\">\n                <div style=\"background: #4A90E2; height: 100%; width: ${cpu}%; transition: width 0.5s;\"></div>\n              </div>\n            </div>\n            <div style=\"margin-bottom: 6px;\">\n              <div style=\"display: flex; justify-content: space-between; margin-bottom: 2px;\">\n                <span style=\"font-weight: 600;\">Memory</span>\n                <span>${memory}%</span>\n              </div>\n              <div style=\"background: #e0e0e0; height: 6px; border-radius: 3px; overflow: hidden;\">\n                <div style=\"background: #28a745; height: 100%; width: ${memory}%; transition: width 0.5s;\"></div>\n              </div>\n            </div>\n            <div style=\"font-size: 10px; color: #999; margin-top: 8px;\">\n              Updated ${counter} times ‚Ä¢ Last: ${new Date().toLocaleTimeString()}\n            </div>\n          </div>\n        `;\n      }\n    };\n\n    // Initial render\n    updateLiveData();\n\n    // Poll every 2 seconds\n    const intervalId = window.setInterval(updateLiveData, 2000);\n\n    // Store interval ID for cleanup\n    this.intervalIds.set(itemId, intervalId);\n  }\n}\n","/* Grid Builder App - Root Component Styles */\n\n* {\n  box-sizing: border-box;\n  padding: 0;\n  margin: 0;\n}\n\nbody {\n  overflow: hidden;\n  height: 100vh;\n  background: #f5f5f5;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;\n}\n\n.app {\n  display: flex;\n  height: 100vh;\n}\n\n/* Main Canvas */\n.canvas {\n  position: relative;\n  overflow: auto;\n  flex: 1;\n  padding: 20px;\n}\n\n.canvas-header {\n  padding: 15px 20px;\n  border-radius: 4px;\n  margin-bottom: 20px;\n  background: white;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 5%);\n}\n\n.canvas-header h1 {\n  margin-bottom: 10px;\n  color: #333;\n  font-size: 24px;\n}\n\n.canvas-header p {\n  margin-bottom: 15px;\n  color: #666;\n}\n\n/* Controls */\n.controls {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  gap: 10px;\n}\n\n.controls button {\n  padding: 8px 16px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  background: white;\n  cursor: pointer;\n  font-size: 14px;\n  transition: all 0.2s;\n}\n\n.controls button:hover {\n  border-color: #4a90e2;\n  background: #f5f5f5;\n}\n\n.controls button.active {\n  border-color: #4a90e2;\n  background: #4a90e2;\n  color: white;\n}\n\n/* Viewport Toggle */\n.viewport-toggle {\n  display: flex;\n  overflow: hidden;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  gap: 5px;\n}\n\n.viewport-btn {\n  padding: 8px 16px;\n  border: none;\n  background: white;\n  cursor: pointer;\n  font-size: 14px;\n  transition: all 0.2s;\n}\n\n.viewport-btn:hover {\n  background: #f5f5f5;\n}\n\n.viewport-btn.active {\n  background: #4a90e2;\n  color: white;\n}\n\n/* Version Switcher */\n.version-switcher {\n  display: flex;\n  align-items: center;\n  margin-left: auto;\n  gap: 8px;\n}\n\n.version-switcher-label {\n  color: #666;\n  font-size: 12px;\n  font-weight: 500;\n}\n\n.version-switcher select {\n  padding: 6px 12px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  background: white;\n  cursor: pointer;\n  font-size: 13px;\n}\n\n/* Canvases Container */\n.canvases-container {\n  display: flex;\n  flex-direction: column;\n  gap: 0;\n}\n\n/* Mobile View */\n.canvases-container.mobile-view {\n  max-width: 375px;\n  margin: 0 auto;\n  box-shadow: 0 0 20px rgba(0, 0, 0, 10%);\n}\n","import { Component, h, Host, Listen, State } from '@stencil/core';\n// Use the standard interactjs package import\nimport interact from 'interactjs';\nimport { componentTemplates } from '../../data/component-templates';\nimport { addItemToCanvas, generateItemId, gridState, removeItemFromCanvas } from '../../services/state-manager';\nimport { pushCommand, redo, undo } from '../../services/undo-redo';\nimport { AddItemCommand, DeleteItemCommand, MoveItemCommand } from '../../services/undo-redo-commands';\nimport { pixelsToGridX, pixelsToGridY } from '../../utils/grid-calculations';\nimport { VirtualRenderer } from '../../utils/virtual-rendering';\n\n@Component({\n  tag: 'grid-builder-app',\n  styleUrl: 'grid-builder-app.css',\n  shadow: false, // Use light DOM for compatibility with interact.js\n})\nexport class GridBuilderApp {\n  @State() itemCount: number = 0;\n\n  componentWillLoad() {\n    // Expose interact to global scope before child components load\n    // This ensures drag/resize handlers in grid-item-wrapper can initialize\n    (window as any).interact = interact;\n\n    // Initial item count\n    this.updateItemCount();\n  }\n\n  componentWillUpdate() {\n    // Update item count when state changes\n    this.updateItemCount();\n  }\n\n  componentDidLoad() {\n    // Initialize item count\n    this.updateItemCount();\n\n    // Initialize performance monitor (from shared library)\n    if ((window as any).PerformanceMonitor) {\n      (window as any).perfMonitor = new (window as any).PerformanceMonitor('stencil');\n    }\n\n    // Initialize global VirtualRenderer for lazy-loading complex components\n    (window as any).virtualRenderer = new VirtualRenderer();\n\n    // Add debug helper to inspect all interactables\n    (window as any).debugInteractables = () => {\n      const interactables = (interact as any).interactables.list;\n      console.log('Total interactables:', interactables.length);\n      interactables.forEach((interactable: any, index: number) => {\n        console.log(`Interactable ${index}:`, {\n          target: interactable.target,\n          actions: interactable._actions,\n          options: interactable.options,\n        });\n      });\n    };\n\n    // Set up keyboard shortcuts\n    document.addEventListener('keydown', this.handleKeyboard.bind(this));\n  }\n\n  disconnectedCallback() {\n    document.removeEventListener('keydown', this.handleKeyboard.bind(this));\n  }\n\n  @Listen('canvas-drop', { target: 'document' })\n  handleCanvasDrop(event: CustomEvent) {\n    const { canvasId, componentType, x, y } = event.detail;\n\n    // Get template for the component type\n    const template = componentTemplates[componentType];\n    if (!template) {\n      console.error('Unknown component type:', componentType);\n      return;\n    }\n\n    // Convert pixel coordinates to grid units\n    const gridX = pixelsToGridX(x, canvasId);\n    const gridY = pixelsToGridY(y);\n\n    // Get canvas to determine next z-index\n    const canvas = gridState.canvases[canvasId];\n    if (!canvas) {\n      console.error('Canvas not found:', canvasId);\n      return;\n    }\n\n    // Create new item\n    const newItem = {\n      id: generateItemId(),\n      canvasId,\n      type: componentType,\n      name: template.title,\n      layouts: {\n        desktop: {\n          x: gridX,\n          y: gridY,\n          width: 10, // Default 10 grid units wide\n          height: 6, // Default 6 grid units tall\n        },\n        mobile: {\n          x: null,\n          y: null,\n          width: null,\n          height: null,\n          customized: false,\n        },\n      },\n      zIndex: canvas.zIndexCounter++,\n    };\n\n    // Add item to canvas\n    addItemToCanvas(canvasId, newItem);\n\n    // Push undo command\n    pushCommand(new AddItemCommand(canvasId, newItem));\n\n    // Trigger update\n    gridState.canvases = { ...gridState.canvases };\n  }\n\n  @Listen('item-delete', { target: 'document' })\n  handleItemDelete(event: CustomEvent) {\n    const { itemId, canvasId } = event.detail;\n\n    // Find the item and its index before deletion\n    const canvas = gridState.canvases[canvasId];\n    if (!canvas) {\n      return;\n    }\n\n    const itemIndex = canvas.items.findIndex((i) => i.id === itemId);\n    const item = canvas.items[itemIndex];\n    if (!item) {\n      return;\n    }\n\n    // Push undo command before deleting\n    pushCommand(new DeleteItemCommand(canvasId, item, itemIndex));\n\n    // Delete the item\n    removeItemFromCanvas(canvasId, itemId);\n    gridState.canvases = { ...gridState.canvases };\n  }\n\n  @Listen('canvas-move', { target: 'document' })\n  handleCanvasMove(event: CustomEvent) {\n    const { itemId, sourceCanvasId, targetCanvasId, x, y } = event.detail;\n\n    // Find the item in the source canvas\n    const sourceCanvas = gridState.canvases[sourceCanvasId];\n    const sourceIndex = sourceCanvas.items.findIndex((i) => i.id === itemId);\n    const item = sourceCanvas.items[sourceIndex];\n\n    if (!item) {\n      return;\n    }\n\n    // Capture source position\n    const sourcePosition = {\n      x: item.layouts.desktop.x,\n      y: item.layouts.desktop.y,\n    };\n\n    // Convert pixel position to grid units\n    const gridX = pixelsToGridX(x, targetCanvasId);\n    const gridY = pixelsToGridY(y);\n\n    // Capture target position\n    const targetPosition = {\n      x: gridX,\n      y: gridY,\n    };\n\n    // Push undo command before moving\n    pushCommand(\n      new MoveItemCommand(itemId, sourceCanvasId, targetCanvasId, sourcePosition, targetPosition, sourceIndex)\n    );\n\n    // Update item's canvas ID and position\n    item.canvasId = targetCanvasId;\n    item.layouts.desktop.x = gridX;\n    item.layouts.desktop.y = gridY;\n\n    // Remove from source canvas\n    sourceCanvas.items = sourceCanvas.items.filter((i) => i.id !== itemId);\n\n    // Add to target canvas\n    const targetCanvas = gridState.canvases[targetCanvasId];\n    targetCanvas.items.push(item);\n\n    // Trigger update\n    gridState.canvases = { ...gridState.canvases };\n  }\n\n  render() {\n    const canvasIds = Object.keys(gridState.canvases);\n\n    return (\n      <Host>\n        <div class=\"app\">\n          {/* Component Palette */}\n          <component-palette />\n\n          {/* Main Canvas */}\n          <div class=\"canvas\">\n            <div class=\"canvas-header\">\n              <h1>Grid Builder POC - StencilJS Variant</h1>\n              <p>\n                Drag components from the palette into the page sections below. Build your page layout section by\n                section.\n              </p>\n\n              <div class=\"controls\">\n                {/* Viewport Toggle */}\n                <div class=\"viewport-toggle\">\n                  <button\n                    class={{\n                      'viewport-btn': true,\n                      active: gridState.currentViewport === 'desktop',\n                    }}\n                    onClick={() => this.handleViewportChange('desktop')}\n                  >\n                    üñ•Ô∏è Desktop\n                  </button>\n                  <button\n                    class={{\n                      'viewport-btn': true,\n                      active: gridState.currentViewport === 'mobile',\n                    }}\n                    onClick={() => this.handleViewportChange('mobile')}\n                  >\n                    üì± Mobile\n                  </button>\n                </div>\n\n                <button class={{ active: gridState.showGrid }} onClick={() => this.handleGridToggle()}>\n                  {gridState.showGrid ? 'Show Grid' : 'Hide Grid'}\n                </button>\n\n                <button onClick={() => this.handleExportState()}>Export State</button>\n\n                <button onClick={() => this.handleAddSection()}>‚ûï Add Section</button>\n\n                <button onClick={() => this.handleStressTest()}>üöÄ Stress Test</button>\n\n                {/* Item Count */}\n                <div\n                  style={{\n                    display: 'inline-flex',\n                    alignItems: 'center',\n                    gap: '6px',\n                    marginLeft: '12px',\n                    padding: '6px 12px',\n                    background: '#fff3cd',\n                    border: '1px solid #ffc107',\n                    borderRadius: '4px',\n                  }}\n                >\n                  <span style={{ fontSize: '11px', color: '#666', marginLeft: '4px' }}>{this.itemCount} items</span>\n                </div>\n\n                {/* Version Switcher */}\n                <div class=\"version-switcher\">\n                  <span class=\"version-switcher-label\">Version:</span>\n                  <select onChange={(e) => (window.location.href = (e.target as HTMLSelectElement).value)}>\n                    <option value=\"../left-top/\">Left/Top</option>\n                    <option value=\"../transform/\">Transform üß™</option>\n                    <option value=\"../masonry/\">Masonry üß™</option>\n                    <option value=\"../virtual/\">Virtual üß™</option>\n                    <option value=\"../stencil/\" selected>\n                      StencilJS üß™\n                    </option>\n                  </select>\n                </div>\n              </div>\n            </div>\n\n            {/* Canvas Sections */}\n            <div\n              class={{\n                'canvases-container': true,\n                'mobile-view': gridState.currentViewport === 'mobile',\n              }}\n            >\n              {canvasIds.map((canvasId, index) => (\n                <canvas-section canvasId={canvasId} sectionNumber={index + 1} key={canvasId} />\n              ))}\n            </div>\n          </div>\n        </div>\n\n        {/* Configuration Panel */}\n        <config-panel />\n      </Host>\n    );\n  }\n\n  private updateItemCount() {\n    this.itemCount = Object.values(gridState.canvases).reduce((sum, canvas) => sum + canvas.items.length, 0);\n  }\n\n  private handleKeyboard(e: KeyboardEvent) {\n    // Undo (Ctrl+Z or Cmd+Z)\n    if ((e.ctrlKey || e.metaKey) && e.key === 'z' && !e.shiftKey) {\n      e.preventDefault();\n      undo();\n      return;\n    }\n\n    // Redo (Ctrl+Y or Ctrl+Shift+Z or Cmd+Shift+Z)\n    if ((e.ctrlKey || e.metaKey) && (e.key === 'y' || (e.key === 'z' && e.shiftKey))) {\n      e.preventDefault();\n      redo();\n      return;\n    }\n\n    // Delete key\n    if (e.key === 'Delete' && gridState.selectedItemId) {\n      this.handleDeleteSelected();\n    }\n\n    // Escape key\n    if (e.key === 'Escape') {\n      gridState.selectedItemId = null;\n      gridState.selectedCanvasId = null;\n    }\n  }\n\n  private handleDeleteSelected() {\n    if (!gridState.selectedItemId || !gridState.selectedCanvasId) {\n      return;\n    }\n\n    const canvas = gridState.canvases[gridState.selectedCanvasId];\n    if (!canvas) {\n      return;\n    }\n\n    // Find the item and its index before deletion\n    const itemIndex = canvas.items.findIndex((i) => i.id === gridState.selectedItemId);\n    const item = canvas.items[itemIndex];\n    if (!item) {\n      return;\n    }\n\n    // Push undo command before deleting\n    pushCommand(new DeleteItemCommand(gridState.selectedCanvasId, item, itemIndex));\n\n    // Delete the item\n    canvas.items = canvas.items.filter((i) => i.id !== gridState.selectedItemId);\n    gridState.selectedItemId = null;\n    gridState.selectedCanvasId = null;\n\n    // Trigger update\n    gridState.canvases = { ...gridState.canvases };\n  }\n\n  private handleViewportChange(viewport: 'desktop' | 'mobile') {\n    /**\n     * Viewport switching with automatic read/write batching:\n     *\n     * 1. Setting currentViewport triggers re-render of all grid-item-wrapper components\n     * 2. Each component's render() calls gridToPixelsX() which uses getGridSizeHorizontal()\n     * 3. Grid size caching ensures container.clientWidth is only read once per canvas\n     * 4. All subsequent components use the cached grid size (no DOM reads)\n     * 5. StencilJS automatically batches all resulting DOM writes\n     *\n     * Result: With 100+ items, only 1 DOM read per canvas instead of 100+,\n     * and all style updates are batched by StencilJS for a single reflow\n     */\n    gridState.currentViewport = viewport;\n  }\n\n  private handleGridToggle() {\n    gridState.showGrid = !gridState.showGrid;\n  }\n\n  private handleExportState() {\n    const state = {\n      canvases: gridState.canvases,\n      currentViewport: gridState.currentViewport,\n      timestamp: new Date().toISOString(),\n    };\n\n    console.log('Grid State:', state);\n    alert(`Grid state exported to console!\\n\\nTotal Items: ${this.itemCount}\\nViewport: ${gridState.currentViewport}`);\n  }\n\n  private handleAddSection() {\n    // Add new section logic\n    const canvasIds = Object.keys(gridState.canvases);\n    const nextId = canvasIds.length + 1;\n    const newCanvasId = `canvas${nextId}`;\n\n    gridState.canvases = {\n      ...gridState.canvases,\n      [newCanvasId]: {\n        items: [],\n        zIndexCounter: 1,\n        backgroundColor: '#ffffff',\n      },\n    };\n\n    alert(`Section ${nextId} added!`);\n  }\n\n  private handleStressTest() {\n    // Prompt for number of items\n    const input = prompt('How many items to add? (1-1000)', '100');\n    if (!input) {\n      return;\n    }\n\n    const count = parseInt(input, 10);\n    if (isNaN(count) || count < 1 || count > 1000) {\n      alert('Please enter a number between 1 and 1000');\n      return;\n    }\n\n    // Get available component types\n    const componentTypes = Object.keys(componentTemplates);\n    const canvasIds = Object.keys(gridState.canvases);\n\n    // Add items\n    for (let i = 0; i < count; i++) {\n      // Random component type\n      const componentType = componentTypes[Math.floor(Math.random() * componentTypes.length)];\n      const template = componentTemplates[componentType];\n\n      // Random canvas\n      const canvasId = canvasIds[Math.floor(Math.random() * canvasIds.length)];\n      const canvas = gridState.canvases[canvasId];\n\n      // Random position (0-40 grid units horizontally, 0-100 grid units vertically)\n      const gridX = Math.floor(Math.random() * 40);\n      const gridY = Math.floor(Math.random() * 100);\n\n      // Create new item\n      const newItem = {\n        id: generateItemId(),\n        canvasId,\n        type: componentType,\n        name: `${template.title} ${i + 1}`,\n        layouts: {\n          desktop: {\n            x: gridX,\n            y: gridY,\n            width: 10, // Default 10 grid units wide\n            height: 6, // Default 6 grid units tall\n          },\n          mobile: {\n            x: null,\n            y: null,\n            width: null,\n            height: null,\n            customized: false,\n          },\n        },\n        zIndex: canvas.zIndexCounter++,\n      };\n\n      // Add item to canvas (without pushing undo command to avoid history bloat)\n      addItemToCanvas(canvasId, newItem);\n    }\n\n    // Trigger single update after all items added\n    gridState.canvases = { ...gridState.canvases };\n\n    alert(`Added ${count} items!`);\n  }\n}\n"],"version":3}