class n{constructor(){this.canvases=new Map}getCanvas(n){if(this.canvases.has(n)){return this.canvases.get(n)}const o=document.getElementById(n);if(o){this.canvases.set(n,o)}return o}invalidate(n){this.canvases.delete(n)}clear(){this.canvases.clear()}}const o=new n;const t=20;const i=.02;const e=10;const c=50;const s=new Map;function a(n){if(n){const o=`${n}-`;for(const n of s.keys()){if(n.startsWith(o)){s.delete(n)}}}else{s.clear()}}function l(n,o,t){var a,l;const r=(t===null||t===void 0?void 0:t.instanceId)?`${t.instanceId}-${n}-h`:`${n}-h`;const d=(t===null||t===void 0?void 0:t.gridSizePercent)?t.gridSizePercent/100:i;const u=o*d;const h=(a=t===null||t===void 0?void 0:t.minGridSize)!==null&&a!==void 0?a:e;const v=(l=t===null||t===void 0?void 0:t.maxGridSize)!==null&&l!==void 0?l:c;const f=Math.max(h,Math.min(v,u));s.set(r,f);console.log("[BUILD-2025-12-01-02:15] Pre-populated cache from ResizeObserver",{cacheKey:r,containerWidth:o,rawSize:u,finalSize:f})}function r(n,t,a=false){var l,r;const d=(t===null||t===void 0?void 0:t.instanceId)?`${t.instanceId}-${n}-h`:`${n}-h`;if(!a&&s.has(d)){const n=s.get(d);console.log("[BUILD-2025-12-01-01:40] Cache HIT",{cacheKey:d,cachedValue:n});return n}const u=o.getCanvas(n);if(!u){console.warn(`Canvas container not found: ${n}`);return 0}const h=(t===null||t===void 0?void 0:t.gridSizePercent)?t.gridSizePercent/100:i;const v=u.clientWidth*h;const f=(l=t===null||t===void 0?void 0:t.minGridSize)!==null&&l!==void 0?l:e;const p=(r=t===null||t===void 0?void 0:t.maxGridSize)!==null&&r!==void 0?r:c;const z=Math.max(f,Math.min(p,v));console.log("[BUILD-2025-12-01-01:40] Cache MISS - calculated",{cacheKey:d,containerWidth:u.clientWidth,rawSize:v,finalSize:z});if(u.clientWidth>100){s.set(d,z);console.log("  → Cached (containerWidth > 100px)")}else{console.log("  → NOT cached (containerWidth too small, waiting for layout)")}return z}function d(n){var o;return(o=n===null||n===void 0?void 0:n.verticalGridSize)!==null&&o!==void 0?o:t}function u(n,o,t){const i=r(o,t);return Math.round(n*i)}function h(n,o){return n*d(o)}function v(n,o,t){const i=r(o,t);if(i===0){return 0}return Math.round(n/i)}function f(n,o){return Math.round(n/d(o))}var p=Object.freeze({__proto__:null,clearGridSizeCache:a,getGridSizeHorizontal:r,getGridSizeVertical:d,gridToPixelsX:u,gridToPixelsY:h,pixelsToGridX:v,pixelsToGridY:f,setGridSizeCache:l});export{n as D,d as a,u as b,a as c,o as d,r as e,f,h as g,p as h,v as p,l as s};
//# sourceMappingURL=p-B5eO_qMn.js.map