{"file":"component-palette.entry.esm.js","mappings":"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","names":["interact"],"sources":["src/components/component-palette/component-palette.css?tag=component-palette","src/components/component-palette/component-palette.tsx"],"sourcesContent":["/* Component Palette */\n.palette {\n  width: 250px;\n  padding: 20px;\n  border-right: 1px solid #ddd;\n  background: white;\n  overflow-y: auto;\n}\n\n.palette h2 {\n  margin-bottom: 20px;\n  color: #333;\n  font-size: 18px;\n}\n\n.palette-item {\n  padding: 15px;\n  border-radius: 4px;\n  margin-bottom: 10px;\n  background: #4a90e2;\n  color: white;\n  cursor: move;\n  font-weight: 500;\n  text-align: center;\n  transition: transform 0.2s, box-shadow 0.2s;\n  user-select: none;\n}\n\n.palette-item:hover {\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 10%);\n  transform: translateY(-2px);\n}\n\n.palette-item.dragging-from-palette {\n  opacity: 0.5;\n}\n\n/* Drag Clone */\n.dragging-clone {\n  position: fixed;\n  z-index: 10000;\n  width: 200px;\n  height: 150px;\n  padding: 20px;\n  border-radius: 4px;\n  background: rgba(74, 144, 226, 90%);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 20%);\n  color: white;\n  pointer-events: none;\n}\n\n/* History Controls */\n.history-controls {\n  display: flex;\n  margin-top: 10px;\n  gap: 8px;\n}\n\n.history-btn {\n  flex: 1;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  background: white;\n  cursor: pointer;\n  font-size: 13px;\n  font-weight: 500;\n  transition: all 0.2s;\n}\n\n.history-btn:disabled {\n  cursor: not-allowed;\n  opacity: 0.4;\n}\n\n.history-btn:hover:not(:disabled) {\n  border-color: #4a90e2;\n  background: #f5f5f5;\n  color: #4a90e2;\n}\n","import { Component, h } from '@stencil/core';\n// Use the standard interactjs package import\nimport interact from 'interactjs';\nimport { componentTemplates } from '../../data/component-templates';\nimport { redo, undo, undoRedoState } from '../../services/undo-redo';\nimport { gridToPixelsX, gridToPixelsY } from '../../utils/grid-calculations';\n\n@Component({\n  tag: 'component-palette',\n  styleUrl: 'component-palette.css',\n  shadow: false,\n})\nexport class ComponentPalette {\n  componentWillLoad() {\n    // Subscribe to undo/redo state changes\n    // The undoRedoState from @stencil/store is already reactive\n  }\n\n  componentDidLoad() {\n    // Initialize drag functionality for palette items\n    this.initializePaletteItems();\n  }\n\n  render() {\n    const simpleComponents = Object.entries(componentTemplates).filter(([, template]) => !template.complex);\n\n    const complexComponents = Object.entries(componentTemplates).filter(([, template]) => template.complex);\n\n    return (\n      <div class=\"palette\">\n        <h2>Components</h2>\n\n        {simpleComponents.map(([type, template]) => (\n          <div class=\"palette-item\" data-component-type={type} key={type}>\n            {template.icon} {template.title}\n          </div>\n        ))}\n\n        <h2\n          style={{\n            marginTop: '20px',\n            paddingTop: '20px',\n            borderTop: '1px solid #ddd',\n          }}\n        >\n          Complex\n        </h2>\n\n        {complexComponents.map(([type, template]) => (\n          <div class=\"palette-item\" data-component-type={type} key={type}>\n            {template.icon} {template.title}\n          </div>\n        ))}\n\n        <h2\n          style={{\n            marginTop: '20px',\n            paddingTop: '20px',\n            borderTop: '1px solid #ddd',\n          }}\n        >\n          History\n        </h2>\n\n        <div class=\"history-controls\">\n          <button\n            id=\"undoBtn\"\n            class=\"history-btn\"\n            title=\"Undo (Ctrl+Z)\"\n            disabled={!undoRedoState.canUndo}\n            onClick={() => undo()}\n          >\n            ↶ Undo\n          </button>\n          <button\n            id=\"redoBtn\"\n            class=\"history-btn\"\n            title=\"Redo (Ctrl+Y)\"\n            disabled={!undoRedoState.canRedo}\n            onClick={() => redo()}\n          >\n            ↷ Redo\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  private initializePaletteItems() {\n    const paletteItems = document.querySelectorAll('.palette-item');\n\n    paletteItems.forEach((element: HTMLElement) => {\n      interact(element).draggable({\n        inertia: false,\n        autoScroll: false,\n        listeners: {\n          start: (event: any) => {\n            event.target.classList.add('dragging-from-palette');\n\n            // Get component type and template\n            const componentType = event.target.getAttribute('data-component-type');\n            const template = componentTemplates[componentType];\n\n            // Calculate actual component size (default: 10 units wide, 6 units tall)\n            // Use canvas1 for width calculation (responsive grid)\n            const defaultWidth = 10;\n            const defaultHeight = 6;\n            const widthPx = gridToPixelsX(defaultWidth, 'canvas1');\n            const heightPx = gridToPixelsY(defaultHeight);\n            const halfWidth = widthPx / 2;\n            const halfHeight = heightPx / 2;\n\n            // Create drag clone with actual component size\n            const dragClone = document.createElement('div');\n            dragClone.className = 'dragging-clone';\n            dragClone.style.position = 'fixed';\n            dragClone.style.width = widthPx + 'px';\n            dragClone.style.height = heightPx + 'px';\n            dragClone.style.left = event.clientX - halfWidth + 'px';\n            dragClone.style.top = event.clientY - halfHeight + 'px';\n            dragClone.style.padding = '20px 20px 20px 44px';\n            dragClone.style.background = 'rgba(74, 144, 226, 0.9)';\n            dragClone.style.color = 'white';\n            dragClone.style.borderRadius = '4px';\n            dragClone.style.pointerEvents = 'none';\n            dragClone.style.zIndex = '10000';\n            dragClone.innerHTML = `\n                <div style=\"font-weight: 600; color: #fff; margin-bottom: 5px; font-size: 14px;\">${template.icon} ${template.title}</div>\n              `;\n            document.body.appendChild(dragClone);\n\n            // Store clone reference and half dimensions for move event\n            (event.target as any)._dragClone = dragClone;\n            (event.target as any)._halfWidth = halfWidth;\n            (event.target as any)._halfHeight = halfHeight;\n          },\n\n          move: (event: any) => {\n            const dragClone = (event.target as any)._dragClone;\n            const halfWidth = (event.target as any)._halfWidth;\n            const halfHeight = (event.target as any)._halfHeight;\n            if (dragClone) {\n              dragClone.style.left = event.clientX - halfWidth + 'px';\n              dragClone.style.top = event.clientY - halfHeight + 'px';\n            }\n          },\n\n          end: (event: any) => {\n            event.target.classList.remove('dragging-from-palette');\n            const dragClone = (event.target as any)._dragClone;\n            if (dragClone) {\n              dragClone.remove();\n              delete (event.target as any)._dragClone;\n            }\n          },\n        },\n      });\n    });\n  }\n}\n"],"version":3}