{"version":3,"file":"plugin.js","sourceRoot":"","sources":["../../src/types/plugin.ts"],"names":[],"mappings":"AAAA;;;;;GAKG","sourcesContent":["/**\n * Plugin System Types\n * ====================\n *\n * Type definitions for creating plugins that extend grid builder functionality.\n */\n\nimport { GridBuilderAPI } from './api';\n\n/**\n * Grid Builder Plugin Interface\n * ===============================\n *\n * Defines a plugin that can extend grid builder functionality.\n * Plugins have access to the full GridBuilderAPI and can subscribe to events,\n * modify state, and add custom UI.\n *\n * **Lifecycle**:\n * 1. User provides plugin instances to `<grid-builder plugins={[...]} />`\n * 2. grid-builder calls `plugin.init(api)` on componentDidLoad\n * 3. Plugin subscribes to events, adds UI, etc.\n * 4. grid-builder calls `plugin.destroy()` on disconnectedCallback\n * 5. Plugin cleans up subscriptions, removes UI, etc.\n *\n * **Example: Simple Logger Plugin**\n * ```typescript\n * export class LoggerPlugin implements GridBuilderPlugin {\n *   name = 'logger';\n *   version = '1.0.0';\n *\n *   private api: GridBuilderAPI;\n *\n *   init(api: GridBuilderAPI) {\n *     this.api = api;\n *\n *     // Subscribe to all events\n *     api.on('componentAdded', (e) => console.log('Added:', e));\n *     api.on('componentDragged', (e) => console.log('Dragged:', e));\n *     api.on('componentDeleted', (e) => console.log('Deleted:', e));\n *   }\n *\n *   destroy() {\n *     // Cleanup if needed\n *     console.log('Logger plugin destroyed');\n *   }\n * }\n * ```\n *\n * **Example: Performance Monitor Plugin**\n * ```typescript\n * export class PerformanceMonitorPlugin implements GridBuilderPlugin {\n *   name = 'performance-monitor';\n *   version = '1.0.0';\n *\n *   private api: GridBuilderAPI;\n *   private metrics = {\n *     dragOperations: [],\n *     resizeOperations: [],\n *     fps: 60\n *   };\n *   private uiElement: HTMLElement | null = null;\n *\n *   init(api: GridBuilderAPI) {\n *     this.api = api;\n *\n *     // Subscribe to drag events\n *     api.on('dragStart', this.onDragStart);\n *     api.on('dragEnd', this.onDragEnd);\n *\n *     // Subscribe to resize events\n *     api.on('resizeStart', this.onResizeStart);\n *     api.on('resizeEnd', this.onResizeEnd);\n *\n *     // Start FPS monitoring\n *     this.startFPSMonitoring();\n *\n *     // Add performance UI\n *     this.renderPerformanceUI();\n *   }\n *\n *   destroy() {\n *     // Unsubscribe from events\n *     this.api.off('dragStart', this.onDragStart);\n *     this.api.off('dragEnd', this.onDragEnd);\n *     this.api.off('resizeStart', this.onResizeStart);\n *     this.api.off('resizeEnd', this.onResizeEnd);\n *\n *     // Stop FPS monitoring\n *     this.stopFPSMonitoring();\n *\n *     // Remove UI\n *     this.removePerformanceUI();\n *   }\n *\n *   private onDragStart = (event) => {\n *     // Track drag start time\n *   };\n *\n *   private onDragEnd = (event) => {\n *     // Calculate drag metrics\n *   };\n *\n *   private renderPerformanceUI() {\n *     // Create and inject UI element\n *     this.uiElement = document.createElement('div');\n *     this.uiElement.className = 'performance-monitor';\n *     document.body.appendChild(this.uiElement);\n *   }\n *\n *   private removePerformanceUI() {\n *     this.uiElement?.remove();\n *     this.uiElement = null;\n *   }\n * }\n * ```\n *\n * **Example: Auto-Save Plugin**\n * ```typescript\n * export class AutoSavePlugin implements GridBuilderPlugin {\n *   name = 'auto-save';\n *   version = '1.0.0';\n *\n *   private api: GridBuilderAPI;\n *   private intervalId: number | null = null;\n *   private saveInterval: number;\n *\n *   constructor(options: { interval?: number } = {}) {\n *     this.saveInterval = options.interval || 30000; // Default 30s\n *   }\n *\n *   init(api: GridBuilderAPI) {\n *     this.api = api;\n *\n *     // Start auto-save interval\n *     this.intervalId = window.setInterval(() => {\n *       this.saveState();\n *     }, this.saveInterval);\n *\n *     console.log(`Auto-save enabled (every ${this.saveInterval}ms)`);\n *   }\n *\n *   destroy() {\n *     // Stop auto-save interval\n *     if (this.intervalId !== null) {\n *       window.clearInterval(this.intervalId);\n *       this.intervalId = null;\n *     }\n *   }\n *\n *   private saveState() {\n *     const state = this.api.getState();\n *     localStorage.setItem('grid-builder-state', JSON.stringify(state));\n *     console.log('State auto-saved');\n *   }\n * }\n * ```\n */\nexport interface GridBuilderPlugin {\n  /**\n   * Plugin name\n   *\n   * **Requirements**:\n   * - Must be unique across all plugins\n   * - Lowercase recommended (e.g., 'logger', 'auto-save')\n   *\n   * **Usage**:\n   * - Identifying plugin in logs\n   * - Debugging\n   * - Plugin management\n   *\n   * @example 'performance-monitor', 'auto-save', 'analytics'\n   */\n  name: string;\n\n  /**\n   * Plugin version\n   *\n   * **Optional**: Semantic versioning recommended\n   * **Usage**:\n   * - Compatibility checking\n   * - Debugging\n   * - Update notifications\n   *\n   * @example '1.0.0', '2.1.3'\n   */\n  version?: string;\n\n  /**\n   * Initialize plugin\n   *\n   * **Called**: When grid-builder component mounts (componentDidLoad)\n   * **Provided**: GridBuilderAPI for full access to grid builder functionality\n   *\n   * **Typical initialization tasks**:\n   * 1. Store API reference for later use\n   * 2. Subscribe to events via `api.on(...)`\n   * 3. Add custom UI elements\n   * 4. Start timers/intervals\n   * 5. Initialize state\n   *\n   * **Important**: Must be synchronous or handle async internally.\n   * Grid builder does not await plugin initialization.\n   *\n   * @param api - Grid Builder API for interacting with the library\n   *\n   * @example\n   * ```typescript\n   * init(api: GridBuilderAPI) {\n   *   this.api = api;\n   *\n   *   // Subscribe to events\n   *   api.on('componentAdded', this.handleComponentAdded);\n   *\n   *   // Add UI\n   *   this.addToolbarButton();\n   *\n   *   // Start background task\n   *   this.startMonitoring();\n   * }\n   * ```\n   */\n  init(api: GridBuilderAPI): void;\n\n  /**\n   * Cleanup plugin resources\n   *\n   * **Called**: When grid-builder component unmounts (disconnectedCallback)\n   *\n   * **Typical cleanup tasks**:\n   * 1. Unsubscribe from all events via `api.off(...)`\n   * 2. Remove custom UI elements\n   * 3. Clear timers/intervals\n   * 4. Free resources\n   * 5. Reset state\n   *\n   * **Important**:\n   * - Must unsubscribe ALL event listeners to prevent memory leaks\n   * - Must remove ALL DOM elements added by plugin\n   * - Must clear ALL timers/intervals\n   *\n   * **Failure to cleanup properly can cause**:\n   * - Memory leaks\n   * - Duplicate event handlers\n   * - Orphaned DOM elements\n   * - Background tasks continuing after unmount\n   *\n   * @example\n   * ```typescript\n   * destroy() {\n   *   // Unsubscribe from events\n   *   this.api.off('componentAdded', this.handleComponentAdded);\n   *\n   *   // Remove UI\n   *   this.removeToolbarButton();\n   *\n   *   // Stop background task\n   *   this.stopMonitoring();\n   *\n   *   // Clear timers\n   *   if (this.intervalId) {\n   *     clearInterval(this.intervalId);\n   *   }\n   * }\n   * ```\n   */\n  destroy(): void;\n}\n"]}