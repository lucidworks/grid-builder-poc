{"version":3,"file":"events.js","sourceRoot":"","sources":["../../src/types/events.ts"],"names":[],"mappings":"AAAA;;;;;;GAMG","sourcesContent":["/**\n * Grid Builder Event Types\n * ==========================\n *\n * Type definitions for all events emitted by the grid builder.\n * Used for event subscriptions via GridBuilderAPI.on() / .off()\n */\n\nimport { GridItem } from '../services/state-manager';\n\n/**\n * Component Added Event\n * ======================\n *\n * Fired when a component is added to a canvas.\n *\n * **Triggers**:\n * - User drags component from palette\n * - Programmatic add via API.addComponent()\n * - Undo delete operation\n * - Import/restore state\n *\n * **Use cases**:\n * - Track component usage (analytics)\n * - Validate component placement\n * - Auto-configure new components\n * - Sync with external systems\n *\n * @example\n * ```typescript\n * api.on('componentAdded', (event) => {\n *   analytics.track('Component Added', {\n *     type: event.item.type,\n *     canvasId: event.canvasId,\n *     position: event.item.layouts.desktop\n *   });\n * });\n * ```\n */\nexport interface ComponentAddedEvent {\n  /** Canvas ID where component was added */\n  canvasId: string;\n\n  /** Complete GridItem object for added component */\n  item: GridItem;\n}\n\n/**\n * Component Deleted Event\n * ========================\n *\n * Fired when a component is removed from a canvas.\n *\n * **Triggers**:\n * - User deletes component (Delete key or button)\n * - Programmatic delete via API.deleteComponent()\n * - Undo add operation\n * - Clear canvas\n *\n * **Use cases**:\n * - Track deletions (analytics)\n * - Cleanup associated resources\n * - Warn before destructive action\n * - Sync with external systems\n *\n * @example\n * ```typescript\n * api.on('componentDeleted', (event) => {\n *   // Cleanup resources\n *   if (event.item.type === 'video') {\n *     videoPlayerManager.cleanup(event.itemId);\n *   }\n *\n *   analytics.track('Component Deleted', {\n *     type: event.item.type,\n *     canvasId: event.canvasId\n *   });\n * });\n * ```\n */\nexport interface ComponentDeletedEvent {\n  /** Canvas ID where component was deleted from */\n  canvasId: string;\n\n  /** ID of deleted component */\n  itemId: string;\n\n  /** Complete GridItem snapshot before deletion (for undo) */\n  item: GridItem;\n}\n\n/**\n * Component Dragged Event\n * ========================\n *\n * Fired after a drag operation completes.\n *\n * **Triggers**:\n * - User finishes dragging component (mouse/touch up)\n * - NOT fired during drag (only on end)\n *\n * **Use cases**:\n * - Track repositioning (analytics)\n * - Validate new position\n * - Auto-align with other components\n * - Detect cross-canvas moves\n *\n * @example\n * ```typescript\n * api.on('componentDragged', (event) => {\n *   const distance = Math.sqrt(\n *     Math.pow(event.newPosition.x - event.oldPosition.x, 2) +\n *     Math.pow(event.newPosition.y - event.oldPosition.y, 2)\n *   );\n *\n *   analytics.track('Component Dragged', {\n *     itemId: event.itemId,\n *     distance,\n *     crossCanvas: event.canvasId !== event.item.canvasId\n *   });\n * });\n * ```\n */\nexport interface ComponentDraggedEvent {\n  /** Canvas ID where component ended (may differ from start if cross-canvas drag) */\n  canvasId: string;\n\n  /** ID of dragged component */\n  itemId: string;\n\n  /** Component state after drag */\n  item: GridItem;\n\n  /** Position before drag (grid units) */\n  oldPosition: { x: number; y: number };\n\n  /** Position after drag (grid units) */\n  newPosition: { x: number; y: number };\n}\n\n/**\n * Component Resized Event\n * ========================\n *\n * Fired after a resize operation completes.\n *\n * **Triggers**:\n * - User finishes resizing component (mouse/touch up on resize handle)\n * - NOT fired during resize (only on end)\n *\n * **Use cases**:\n * - Track resize operations (analytics)\n * - Validate new size\n * - Auto-adjust content layout\n * - Detect size constraints violations\n *\n * @example\n * ```typescript\n * api.on('componentResized', (event) => {\n *   const oldArea = event.oldSize.width * event.oldSize.height;\n *   const newArea = event.newSize.width * event.newSize.height;\n *   const percentChange = ((newArea - oldArea) / oldArea) * 100;\n *\n *   analytics.track('Component Resized', {\n *     itemId: event.itemId,\n *     type: event.item.type,\n *     percentChange: percentChange.toFixed(1)\n *   });\n * });\n * ```\n */\nexport interface ComponentResizedEvent {\n  /** Canvas ID containing component */\n  canvasId: string;\n\n  /** ID of resized component */\n  itemId: string;\n\n  /** Component state after resize */\n  item: GridItem;\n\n  /** Size before resize (grid units) */\n  oldSize: { width: number; height: number };\n\n  /** Size after resize (grid units) */\n  newSize: { width: number; height: number };\n}\n\n/**\n * Component Selected Event\n * =========================\n *\n * Fired when a component is selected.\n *\n * **Triggers**:\n * - User clicks component\n * - Programmatic selection via API\n * - Keyboard navigation\n *\n * **Use cases**:\n * - Track selections (analytics)\n * - Show custom selection UI\n * - Enable contextual actions\n * - Update config panel\n *\n * @example\n * ```typescript\n * api.on('componentSelected', (event) => {\n *   // Show custom selection indicator\n *   const canvas = api.getCanvasElement(event.canvasId);\n *   const indicator = document.createElement('div');\n *   indicator.id = 'custom-selection-indicator';\n *   indicator.textContent = `Selected: ${event.item.name}`;\n *   canvas?.appendChild(indicator);\n * });\n * ```\n */\nexport interface ComponentSelectedEvent {\n  /** Canvas ID containing selected component */\n  canvasId: string;\n\n  /** ID of selected component */\n  itemId: string;\n\n  /** Complete GridItem object for selected component */\n  item: GridItem;\n}\n\n/**\n * Component Deselected Event\n * ===========================\n *\n * Fired when component selection is cleared.\n *\n * **Triggers**:\n * - User clicks canvas background\n * - Escape key pressed\n * - Component deleted while selected\n * - New component selected (fires before componentSelected)\n *\n * **Use cases**:\n * - Remove custom selection UI\n * - Close config panels\n * - Clear selection state in plugins\n *\n * @example\n * ```typescript\n * api.on('componentDeselected', () => {\n *   // Remove custom selection indicator\n *   const indicator = document.getElementById('custom-selection-indicator');\n *   indicator?.remove();\n * });\n * ```\n */\nexport interface ComponentDeselectedEvent {\n  /** ID of deselected component (null if nothing was selected) */\n  previousItemId: string | null;\n\n  /** Canvas ID of deselected component (null if nothing was selected) */\n  previousCanvasId: string | null;\n}\n\n/**\n * Config Changed Event\n * =====================\n *\n * Fired when component configuration is saved.\n *\n * **Triggers**:\n * - User saves config panel changes\n * - Programmatic config update via API.updateConfig()\n * - Undo/redo config change\n *\n * **Use cases**:\n * - Track config changes (analytics)\n * - Validate configuration\n * - Sync with external systems\n * - Trigger dependent updates\n *\n * @example\n * ```typescript\n * api.on('configChanged', (event) => {\n *   // Track what changed\n *   const changedFields = Object.keys(event.newConfig).filter(\n *     key => event.newConfig[key] !== event.oldConfig?.[key]\n *   );\n *\n *   analytics.track('Config Changed', {\n *     itemId: event.itemId,\n *     type: event.item.type,\n *     changedFields\n *   });\n * });\n * ```\n */\nexport interface ConfigChangedEvent {\n  /** Canvas ID containing component */\n  canvasId: string;\n\n  /** ID of component whose config changed */\n  itemId: string;\n\n  /** Component state after config change */\n  item: GridItem;\n\n  /** Configuration before change (for undo) */\n  oldConfig: Record<string, any>;\n\n  /** Configuration after change */\n  newConfig: Record<string, any>;\n}\n\n/**\n * Drag Start Event\n * =================\n *\n * Fired when drag operation begins.\n *\n * **Triggers**:\n * - User starts dragging component (mouse/touch down + move)\n * - Fires ONCE at start (not continuously during drag)\n *\n * **Use cases**:\n * - Start performance monitoring\n * - Show drag preview/ghost\n * - Disable other interactions\n * - Track drag start time\n *\n * @example\n * ```typescript\n * let dragStartTime: number;\n *\n * api.on('dragStart', (event) => {\n *   dragStartTime = Date.now();\n *   console.log(`Started dragging ${event.item.type}`);\n * });\n *\n * api.on('dragEnd', () => {\n *   const duration = Date.now() - dragStartTime;\n *   console.log(`Drag took ${duration}ms`);\n * });\n * ```\n */\nexport interface DragStartEvent {\n  /** Canvas ID where drag started */\n  canvasId: string;\n\n  /** ID of component being dragged */\n  itemId: string;\n\n  /** Component being dragged */\n  item: GridItem;\n\n  /** Starting position (grid units) */\n  position: { x: number; y: number };\n}\n\n/**\n * Drag End Event\n * ===============\n *\n * Fired when drag operation ends.\n *\n * **Triggers**:\n * - User finishes dragging (mouse/touch up)\n * - Fires ONCE at end (after position updated)\n *\n * **Note**: Also fires 'componentDragged' event with position details\n *\n * **Use cases**:\n * - Stop performance monitoring\n * - Hide drag preview/ghost\n * - Re-enable interactions\n * - Calculate drag metrics\n *\n * @example\n * ```typescript\n * api.on('dragEnd', (event) => {\n *   console.log(`Dropped ${event.item.type} at (${event.position.x}, ${event.position.y})`);\n * });\n * ```\n */\nexport interface DragEndEvent {\n  /** Canvas ID where drag ended */\n  canvasId: string;\n\n  /** ID of dragged component */\n  itemId: string;\n\n  /** Component after drag */\n  item: GridItem;\n\n  /** Final position (grid units) */\n  position: { x: number; y: number };\n}\n\n/**\n * Resize Start Event\n * ===================\n *\n * Fired when resize operation begins.\n *\n * **Triggers**:\n * - User starts resizing (mouse/touch down on resize handle + move)\n * - Fires ONCE at start (not continuously during resize)\n *\n * **Use cases**:\n * - Start performance monitoring\n * - Show resize preview\n * - Disable other interactions\n * - Track resize start time\n *\n * @example\n * ```typescript\n * let resizeStartTime: number;\n *\n * api.on('resizeStart', (event) => {\n *   resizeStartTime = Date.now();\n *   console.log(`Started resizing ${event.item.type} from ${event.size.width}×${event.size.height}`);\n * });\n * ```\n */\nexport interface ResizeStartEvent {\n  /** Canvas ID containing component */\n  canvasId: string;\n\n  /** ID of component being resized */\n  itemId: string;\n\n  /** Component being resized */\n  item: GridItem;\n\n  /** Starting size (grid units) */\n  size: { width: number; height: number };\n}\n\n/**\n * Resize End Event\n * =================\n *\n * Fired when resize operation ends.\n *\n * **Triggers**:\n * - User finishes resizing (mouse/touch up on handle)\n * - Fires ONCE at end (after size updated)\n *\n * **Note**: Also fires 'componentResized' event with size details\n *\n * **Use cases**:\n * - Stop performance monitoring\n * - Hide resize preview\n * - Re-enable interactions\n * - Calculate resize metrics\n *\n * @example\n * ```typescript\n * api.on('resizeEnd', (event) => {\n *   const area = event.size.width * event.size.height;\n *   console.log(`Resized to ${event.size.width}×${event.size.height} (${area} grid units²)`);\n * });\n * ```\n */\nexport interface ResizeEndEvent {\n  /** Canvas ID containing component */\n  canvasId: string;\n\n  /** ID of resized component */\n  itemId: string;\n\n  /** Component after resize */\n  item: GridItem;\n\n  /** Final size (grid units) */\n  size: { width: number; height: number };\n}\n\n/**\n * Viewport Changed Event\n * =======================\n *\n * Fired when viewport mode switches (desktop ↔ mobile).\n *\n * **Triggers**:\n * - User clicks viewport toggle button\n * - Programmatic viewport change\n *\n * **Use cases**:\n * - Track viewport usage (analytics)\n * - Adjust plugin UI for viewport\n * - Warn about mobile layout customization\n * - Update external preview\n *\n * @example\n * ```typescript\n * api.on('viewportChanged', (event) => {\n *   console.log(`Switched from ${event.oldViewport} to ${event.newViewport}`);\n *\n *   // Update plugin UI\n *   if (event.newViewport === 'mobile') {\n *     pluginPanel.classList.add('mobile-mode');\n *   } else {\n *     pluginPanel.classList.remove('mobile-mode');\n *   }\n * });\n * ```\n */\nexport interface ViewportChangedEvent {\n  /** Viewport before change */\n  oldViewport: 'desktop' | 'mobile';\n\n  /** Viewport after change */\n  newViewport: 'desktop' | 'mobile';\n}\n\n/**\n * Undo Event\n * ===========\n *\n * Fired when undo operation is performed.\n *\n * **Triggers**:\n * - User presses Ctrl+Z / Cmd+Z\n * - Undo button clicked\n * - Programmatic undo via API\n *\n * **Use cases**:\n * - Track undo usage (analytics)\n * - Sync undo with external systems\n * - Update custom UI state\n *\n * @example\n * ```typescript\n * api.on('undo', (event) => {\n *   console.log(`Undid: ${event.description}`);\n *   statusBar.showMessage(`Undid ${event.description}`);\n * });\n * ```\n */\nexport interface UndoEvent {\n  /** Human-readable description of undone action */\n  description: string;\n\n  /** Action type ('add', 'delete', 'drag', 'resize', 'config', etc.) */\n  actionType: string;\n}\n\n/**\n * Redo Event\n * ===========\n *\n * Fired when redo operation is performed.\n *\n * **Triggers**:\n * - User presses Ctrl+Shift+Z / Cmd+Shift+Z\n * - Redo button clicked\n * - Programmatic redo via API\n *\n * **Use cases**:\n * - Track redo usage (analytics)\n * - Sync redo with external systems\n * - Update custom UI state\n *\n * @example\n * ```typescript\n * api.on('redo', (event) => {\n *   console.log(`Redid: ${event.description}`);\n *   statusBar.showMessage(`Redid ${event.description}`);\n * });\n * ```\n */\nexport interface RedoEvent {\n  /** Human-readable description of redone action */\n  description: string;\n\n  /** Action type ('add', 'delete', 'drag', 'resize', 'config', etc.) */\n  actionType: string;\n}\n\n/**\n * Components Batch Added Event\n * =============================\n *\n * Fired when multiple components are added in single batch operation.\n *\n * **Triggers**:\n * - API.addComponentsBatch() called\n * - Template/preset loading\n * - Import saved layout\n *\n * **Use cases**:\n * - Track batch operations (analytics)\n * - Show batch progress\n * - Optimize bulk operations\n *\n * @example\n * ```typescript\n * api.on('componentsBatchAdded', (event) => {\n *   console.log(`Added ${event.items.length} components in batch`);\n *   statusBar.showMessage(`Loaded template with ${event.items.length} components`);\n * });\n * ```\n */\nexport interface ComponentsBatchAddedEvent {\n  /** Array of all added GridItem objects */\n  items: GridItem[];\n}\n\n/**\n * Components Batch Deleted Event\n * ===============================\n *\n * Fired when multiple components are deleted in single batch operation.\n *\n * **Triggers**:\n * - API.deleteComponentsBatch() called\n * - Clear canvas\n * - Bulk cleanup\n *\n * **Use cases**:\n * - Track batch deletions (analytics)\n * - Warn before destructive batch action\n * - Cleanup resources\n *\n * @example\n * ```typescript\n * api.on('componentsBatchDeleted', (event) => {\n *   console.log(`Deleted ${event.itemIds.length} components in batch`);\n *\n *   // Cleanup resources\n *   event.itemIds.forEach(itemId => {\n *     resourceManager.cleanup(itemId);\n *   });\n * });\n * ```\n */\nexport interface ComponentsBatchDeletedEvent {\n  /** Array of deleted item IDs */\n  itemIds: string[];\n}\n\n/**\n * Configs Batch Changed Event\n * ============================\n *\n * Fired when multiple component configs are updated in single batch operation.\n *\n * **Triggers**:\n * - API.updateConfigsBatch() called\n * - Theme changes\n * - Bulk property updates\n *\n * **Use cases**:\n * - Track batch config changes (analytics)\n * - Optimize bulk updates\n * - Sync with external systems\n *\n * @example\n * ```typescript\n * api.on('configsBatchChanged', (event) => {\n *   console.log(`Updated configs for ${event.updates.length} components`);\n *   statusBar.showMessage(`Applied theme to ${event.updates.length} components`);\n * });\n * ```\n */\nexport interface ConfigsBatchChangedEvent {\n  /** Array of { itemId, oldConfig, newConfig } update records */\n  updates: Array<{\n    itemId: string;\n    oldConfig: Record<string, any>;\n    newConfig: Record<string, any>;\n  }>;\n}\n\n/**\n * Event Map\n * ==========\n *\n * Type-safe mapping of event names to event data types.\n * Used internally for type checking event subscriptions.\n *\n * **Example usage**:\n * ```typescript\n * api.on<ComponentAddedEvent>('componentAdded', (event) => {\n *   // event is typed as ComponentAddedEvent\n *   console.log(event.item.type);\n * });\n * ```\n */\nexport interface EventMap {\n  componentAdded: ComponentAddedEvent;\n  componentDeleted: ComponentDeletedEvent;\n  componentDragged: ComponentDraggedEvent;\n  componentResized: ComponentResizedEvent;\n  componentSelected: ComponentSelectedEvent;\n  componentDeselected: ComponentDeselectedEvent;\n  configChanged: ConfigChangedEvent;\n  dragStart: DragStartEvent;\n  dragEnd: DragEndEvent;\n  resizeStart: ResizeStartEvent;\n  resizeEnd: ResizeEndEvent;\n  viewportChanged: ViewportChangedEvent;\n  undo: UndoEvent;\n  redo: RedoEvent;\n  componentsBatchAdded: ComponentsBatchAddedEvent;\n  componentsBatchDeleted: ComponentsBatchDeletedEvent;\n  configsBatchChanged: ConfigsBatchChangedEvent;\n}\n\n/**\n * GridBuilderAPI Event Types\n * ============================\n *\n * Additional event types used by the GridBuilderAPI.\n * These follow a different naming convention (item* vs component*)\n * for consistency with the API method names.\n */\n\n/** Fired when an item is added to a canvas */\nexport interface ItemAddedEvent {\n  canvasId: string;\n  item: GridItem;\n}\n\n/** Fired when an item is removed from a canvas */\nexport interface ItemRemovedEvent {\n  canvasId: string;\n  itemId: string;\n}\n\n/** Fired when an item is updated */\nexport interface ItemUpdatedEvent {\n  canvasId: string;\n  itemId: string;\n  updates: Partial<GridItem>;\n}\n\n/** Fired when an item is moved between canvases */\nexport interface ItemMovedEvent {\n  itemId: string;\n  fromCanvasId: string;\n  toCanvasId: string;\n}\n\n/** Fired when item selection changes */\nexport interface SelectionChangedEvent {\n  itemId: string | null;\n  canvasId: string | null;\n}\n\n/** Fired when grid visibility changes */\nexport interface GridVisibilityChangedEvent {\n  visible: boolean;\n}\n\n/**\n * Canvas Added Event\n * ===================\n *\n * Fired when a canvas is added to the library state.\n *\n * **Library emits**: canvasId only (no metadata)\n * **Host app responsibility**: Manage canvas metadata (title, colors, etc.) separately\n *\n * @example\n * ```typescript\n * // Host app maintains canvas metadata\n * const canvasMetadata = {};\n *\n * api.on('canvasAdded', (event) => {\n *   // Host app can add its own metadata\n *   canvasMetadata[event.canvasId] = {\n *     title: 'New Section',\n *     backgroundColor: '#f5f5f5'\n *   };\n * });\n * ```\n */\nexport interface CanvasAddedEvent {\n  canvasId: string;\n}\n\n/**\n * Canvas Removed Event\n * =====================\n *\n * Fired when a canvas is removed from the library state.\n *\n * **Library emits**: canvasId only\n * **Host app responsibility**: Clean up canvas metadata on removal\n *\n * @example\n * ```typescript\n * api.on('canvasRemoved', (event) => {\n *   // Host app removes its own metadata\n *   delete canvasMetadata[event.canvasId];\n * });\n * ```\n */\nexport interface CanvasRemovedEvent {\n  canvasId: string;\n}\n\n/** Generic state change event */\nexport interface StateChangedEvent {\n  // Empty - just signals that state changed\n}\n\n/**\n * GridBuilderAPI Event Map\n * ==========================\n *\n * Type-safe mapping of event names to event data types for GridBuilderAPI.\n */\n/**\n * Items Batch Added Event\n * =========================\n *\n * Fired when multiple items are added in a single batch operation via GridBuilderAPI.\n *\n * @example\n * ```typescript\n * api.on('itemsBatchAdded', (event) => {\n *   console.log(`Added ${event.items.length} items in batch`);\n * });\n * ```\n */\nexport interface ItemsBatchAddedEvent {\n  /** Array of all added GridItem objects */\n  items: GridItem[];\n}\n\n/**\n * Items Batch Deleted Event\n * ===========================\n *\n * Fired when multiple items are deleted in a single batch operation via GridBuilderAPI.\n *\n * @example\n * ```typescript\n * api.on('itemsBatchDeleted', (event) => {\n *   console.log(`Deleted ${event.itemIds.length} items in batch`);\n * });\n * ```\n */\nexport interface ItemsBatchDeletedEvent {\n  /** Array of deleted item IDs */\n  itemIds: string[];\n}\n\n/**\n * Items Batch Updated Event\n * ===========================\n *\n * Fired when multiple item configs are updated in a single batch operation via GridBuilderAPI.\n *\n * @example\n * ```typescript\n * api.on('itemsBatchUpdated', (event) => {\n *   console.log(`Updated ${event.updates.length} items in batch`);\n * });\n * ```\n */\nexport interface ItemsBatchUpdatedEvent {\n  /** Array of { itemId, config } update records */\n  updates: Array<{\n    itemId: string;\n    canvasId: string;\n    config: Record<string, any>;\n  }>;\n}\n\nexport interface GridBuilderEventMap {\n  // Item events\n  itemAdded: ItemAddedEvent;\n  itemRemoved: ItemRemovedEvent;\n  itemUpdated: ItemUpdatedEvent;\n  itemMoved: ItemMovedEvent;\n\n  // Batch item events\n  itemsBatchAdded: ItemsBatchAddedEvent;\n  itemsBatchDeleted: ItemsBatchDeletedEvent;\n  itemsBatchUpdated: ItemsBatchUpdatedEvent;\n\n  // Selection events\n  selectionChanged: SelectionChangedEvent;\n\n  // Canvas events\n  canvasAdded: CanvasAddedEvent;\n  canvasRemoved: CanvasRemovedEvent;\n\n  // Display events\n  viewportChanged: ViewportChangedEvent;\n  gridVisibilityChanged: GridVisibilityChangedEvent;\n\n  // State events\n  stateChanged: StateChangedEvent;\n}\n\n/**\n * Event name type (union of all event names)\n *\n * **Use cases**:\n * - Type-safe event name parameters\n * - Autocomplete for event names\n * - Compile-time validation\n */\nexport type EventName = keyof EventMap;\n"]}