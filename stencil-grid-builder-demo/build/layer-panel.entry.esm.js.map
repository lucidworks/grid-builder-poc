{"version":3,"file":"layer-panel.entry.esm.js","sources":["src/demo/components/layer-panel/layer-panel.scss?tag=layer-panel","src/demo/components/layer-panel/layer-panel.tsx"],"sourcesContent":["/**\n * Layer Panel Styles\n * ==================\n *\n * Main layer panel container with virtual scrolling list.\n */\n\n.layer-panel {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  background: #fafafa;\n  overflow: hidden;\n  box-sizing: border-box;\n\n  &__header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 12px 16px;\n    border-bottom: 1px solid #e0e0e0;\n    background: #ffffff;\n  }\n\n  &__title {\n    margin: 0;\n    font-size: 16px;\n    font-weight: 600;\n    color: #333;\n  }\n\n  &__count {\n    font-size: 12px;\n    color: #757575;\n    background: #f5f5f5;\n    padding: 2px 8px;\n    border-radius: 12px;\n  }\n\n  &__search {\n    padding: 12px 16px;\n    border-bottom: 1px solid #e0e0e0;\n    background: #ffffff;\n  }\n\n  &__search-input {\n    width: 100%;\n    padding: 8px 12px;\n    border: 1px solid #e0e0e0;\n    border-radius: 4px;\n    font-size: 14px;\n    outline: none;\n    transition: border-color 0.2s ease;\n    box-sizing: border-box;\n\n    &:focus {\n      border-color: #4a90e2;\n      box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.1);\n    }\n\n    &::placeholder {\n      color: #9e9e9e;\n    }\n  }\n\n  &__list {\n    overflow-x: hidden;\n    padding: 8px;\n    background: #fafafa;\n    width: 100%;\n    box-sizing: border-box;\n    min-height: 400px; /* Show at least 3-4 rows of items */\n\n    /* Scrollbar styling */\n    &::-webkit-scrollbar {\n      width: 8px;\n    }\n\n    &::-webkit-scrollbar-track {\n      background: #f5f5f5;\n    }\n\n    &::-webkit-scrollbar-thumb {\n      background: #ccc;\n      border-radius: 4px;\n\n      &:hover {\n        background: #aaa;\n      }\n    }\n  }\n\n  &__list-inner {\n    position: relative;\n    min-height: 100%;\n    width: 100%;\n    box-sizing: border-box;\n  }\n\n  &__visible-items {\n    position: absolute;\n    width: 100%;\n    will-change: transform;\n  }\n\n  &__empty {\n    text-align: center;\n    padding: 32px 16px;\n    color: #9e9e9e;\n    font-size: 14px;\n  }\n\n  &__footer {\n    padding: 8px 16px;\n    border-top: 1px solid #e0e0e0;\n    background: #ffffff;\n  }\n\n  &__hint {\n    font-size: 11px;\n    color: #757575;\n    text-align: center;\n  }\n}\n","/**\n * Layer Panel Component\n * =====================\n *\n * Displays all grid items across all canvases sorted by z-index (stacking order).\n * Supports drag-to-reorder, search/filter, and virtual scrolling for performance.\n *\n * ## Features\n *\n * - **Global view**: Shows items from all canvases in one unified list\n * - **Z-index sorting**: Items sorted by z-index (descending, top items first)\n * - **Virtual scrolling**: Renders only ~50 visible items for performance (handles 1000+ items)\n * - **Search/filter**: Debounced text search across item names\n * - **Drag-to-reorder**: Change z-index by dragging items in the list\n * - **Visual feedback**: Shows active canvas and selected item\n *\n * ## Performance Targets\n *\n * Based on `/tmp/z-index-performance-assessment.md`:\n * - **1000 items**: Baseline target, excellent performance\n * - **5000 items**: Extended capacity with optimizations\n * - **Virtual scrolling**: 50-item render window (200px pre-render buffer)\n * - **Search debounce**: 300ms delay\n * - **Batch updates**: Single undo/redo command for reordering\n *\n * ## Usage\n *\n * ```typescript\n * <layer-panel />\n * ```\n *\n * The layer panel automatically subscribes to grid state and updates reactively.\n * @module layer-panel\n */\n\nimport { Component, h, State, Listen, Element, Prop, Watch } from \"@stencil/core\";\nimport { type GridItem } from \"../../../services/state-manager\";\n\n/**\n * Extended grid item with canvas information for display\n */\ninterface LayerItem extends GridItem {\n  canvasId: string;\n}\n\n/**\n * Virtual scrolling item with height information\n */\ninterface VirtualItem {\n  type: \"folder\" | \"item\";\n  data:\n    | LayerItem\n    | {\n        canvasId: string;\n        title: string;\n        itemCount: number;\n        totalItemCount?: number;\n        isEmpty?: boolean;\n      };\n  height: number;\n  offset: number; // Cumulative offset from top\n}\n\n@Component({\n  tag: \"layer-panel\",\n  styleUrl: \"layer-panel.scss\",\n  shadow: false,\n})\nexport class LayerPanel {\n  @Element() hostElement: HTMLElement;\n\n  /**\n   * Grid Builder API instance (instance-based architecture)\n   *\n   * **Required**: Must be provided or component won't display items\n   * **Source**: Host app (blog-app) passes this via prop\n   * **Purpose**: Access instance-based state for multi-instance support\n   *\n   * **Why needed**: Grid-builder uses its own state instance. The layer panel\n   * must access that same instance to display items correctly.\n   */\n  @Prop() api?: any;\n\n  /**\n   * Canvas metadata for folder titles\n   * Map of canvasId ‚Üí { title: string }\n   */\n  @Prop() canvasMetadata?: Record<string, { title: string }> = {};\n\n  /**\n   * Height of folder header in pixels\n   * @default 40\n   */\n  @Prop() folderHeight?: number = 40;\n\n  /**\n   * Height of layer item in pixels\n   * @default 40\n   */\n  @Prop() itemHeight?: number = 40;\n\n  /**\n   * Number of items to render in virtual window\n   * @default 50\n   */\n  @Prop() virtualWindowSize?: number = 50;\n\n  /**\n   * Pre-render buffer in pixels (renders items outside viewport)\n   * @default 200\n   */\n  @Prop() virtualBufferPx?: number = 200;\n\n  /**\n   * Search input debounce delay in milliseconds\n   * @default 300\n   */\n  @Prop() searchDebounceMs?: number = 300;\n\n  /**\n   * All items from all canvases, sorted by z-index (descending)\n   */\n  @State() allItems: LayerItem[] = [];\n\n  /**\n   * Filtered items (after search)\n   */\n  @State() filteredItems: LayerItem[] = [];\n\n  /**\n   * Search query for filtering items\n   */\n  @State() searchQuery: string = \"\";\n\n  /**\n   * Folder expand/collapse state\n   * Map of canvasId ‚Üí isExpanded\n   * Default: active canvas expanded, others collapsed\n   */\n  @State() folderExpandedState: Record<string, boolean> = {};\n\n  /**\n   * Current search debounce timer\n   */\n  private searchDebounceTimer: number | null = null;\n\n  /**\n   * Virtual scrolling: first visible item index\n   */\n  @State() virtualScrollOffset: number = 0;\n\n  /**\n   * Event listener cleanup functions\n   */\n  private cleanupFunctions: (() => void)[] = [];\n\n  /**\n   * Drag state tracking\n   * Stores information about the item currently being dragged\n   */\n  private draggedItem: {\n    itemId: string;\n    canvasId: string;\n    zIndex: number;\n  } | null = null;\n\n  /**\n   * Watch API prop for changes\n   *\n   * **Why needed**: Layer panel's componentDidLoad() runs before blog-app\n   * has retrieved and passed the API prop. We need to initialize when\n   * the API prop becomes available.\n   */\n  @Watch(\"api\")\n  handleApiChange(newApi: any) {\n    console.log(\"üîß Layer panel: API prop changed\", { hasApi: !!newApi });\n\n    if (newApi) {\n      this.setupLayerPanel();\n    }\n  }\n\n  /**\n   * Component did load - subscribe to events\n   */\n  componentDidLoad() {\n    console.log(\"üîß Layer panel componentDidLoad called\");\n    console.log(\"  API available:\", !!this.api);\n\n    // If API is already available, initialize immediately\n    // Otherwise, @Watch(\"api\") will initialize when API prop is set\n    if (this.api) {\n      this.setupLayerPanel();\n    } else {\n      console.warn(\"  ‚ö†Ô∏è API not yet available, waiting for prop...\");\n    }\n  }\n\n  /**\n   * Setup layer panel (called when API becomes available)\n   */\n  private setupLayerPanel = () => {\n    console.log(\"üîß setupLayerPanel called\");\n\n    if (!this.api) {\n      console.warn(\"  ‚ö†Ô∏è No API - aborting\");\n      return;\n    }\n\n    // Prevent double initialization\n    if (this.cleanupFunctions.length > 0) {\n      console.log(\"  ‚ÑπÔ∏è Already initialized, skipping\");\n      return;\n    }\n\n    // Initialize folder expanded state\n    // Default: active canvas expanded, others collapsed\n    this.initializeFolderState();\n\n    // Initial data load\n    this.refreshItems();\n\n    // Subscribe to API events for state changes\n    const refreshHandler = () => {\n      this.refreshItems();\n    };\n\n    // Listen to all events that modify items\n    this.api.on(\"componentAdded\", refreshHandler);\n    this.api.on(\"componentDeleted\", refreshHandler);\n    this.api.on(\"componentDragged\", refreshHandler);\n    this.api.on(\"componentResized\", refreshHandler);\n    this.api.on(\"componentsBatchAdded\", refreshHandler);\n    this.api.on(\"componentsBatchDeleted\", refreshHandler);\n    this.api.on(\"zIndexChanged\", refreshHandler);\n    this.api.on(\"zIndexBatchChanged\", refreshHandler);\n\n    // Store cleanup functions\n    this.cleanupFunctions.push(() => {\n      this.api.off(\"componentAdded\", refreshHandler);\n      this.api.off(\"componentDeleted\", refreshHandler);\n      this.api.off(\"componentDragged\", refreshHandler);\n      this.api.off(\"componentResized\", refreshHandler);\n      this.api.off(\"componentsBatchAdded\", refreshHandler);\n      this.api.off(\"componentsBatchDeleted\", refreshHandler);\n      this.api.off(\"zIndexChanged\", refreshHandler);\n      this.api.off(\"zIndexBatchChanged\", refreshHandler);\n    });\n\n    // Subscribe to selection/canvas changes for visual feedback\n    const visualUpdateHandler = () => {\n      // Force re-render to update visual feedback\n      this.allItems = [...this.allItems];\n    };\n\n    this.api.on(\"componentSelected\", visualUpdateHandler);\n    this.api.on(\"canvasActivated\", visualUpdateHandler);\n\n    this.cleanupFunctions.push(() => {\n      this.api.off(\"componentSelected\", visualUpdateHandler);\n      this.api.off(\"canvasActivated\", visualUpdateHandler);\n    });\n\n    // Subscribe to canvas activation to auto-expand the active section\n    const canvasActivationHandler = () => {\n      const state = this.api.getState();\n      const activeCanvasId = state.activeCanvasId;\n\n      if (activeCanvasId) {\n        console.log(\"üìÅ Canvas activated, expanding folder:\", activeCanvasId);\n        // Update folder state to expand only the active canvas\n        const newFolderState: Record<string, boolean> = {};\n        Object.keys(state.canvases).forEach((canvasId) => {\n          newFolderState[canvasId] = canvasId === activeCanvasId;\n        });\n        this.folderExpandedState = newFolderState;\n      }\n    };\n\n    this.api.on(\"canvasActivated\", canvasActivationHandler);\n\n    this.cleanupFunctions.push(() => {\n      this.api.off(\"canvasActivated\", canvasActivationHandler);\n    });\n\n    // Initialize virtual scrolling\n    this.initializeVirtualScrolling();\n  }\n\n  /**\n   * Initialize folder expanded state\n   * Default: active canvas expanded, others collapsed\n   */\n  private initializeFolderState = () => {\n    console.log(\"üìÅ initializeFolderState called\");\n\n    if (!this.api) {\n      console.warn(\"  ‚ö†Ô∏è No API - aborting\");\n      return;\n    }\n\n    const state = this.api.getState();\n    const activeCanvasId = state.activeCanvasId;\n    console.log(\"  Active canvas:\", activeCanvasId);\n\n    const folderState: Record<string, boolean> = {};\n\n    Object.keys(state.canvases).forEach((canvasId) => {\n      folderState[canvasId] = canvasId === activeCanvasId;\n    });\n\n    console.log(\"  Folder state:\", folderState);\n    this.folderExpandedState = folderState;\n  };\n\n  /**\n   * Cleanup event subscriptions\n   */\n  disconnectedCallback() {\n    this.cleanupFunctions.forEach((cleanup) => cleanup());\n    this.cleanupFunctions = [];\n\n    if (this.searchDebounceTimer) {\n      clearTimeout(this.searchDebounceTimer);\n    }\n  }\n\n  /**\n   * Refresh item list from grid state\n   *\n   * Aggregates all items from all canvases and sorts by z-index (descending).\n   * Top items (highest z-index) appear first in the list.\n   */\n  private refreshItems = () => {\n    console.log(\"üîÑ refreshItems called\");\n\n    if (!this.api) {\n      console.warn(\"  ‚ö†Ô∏è No API - aborting\");\n      return;\n    }\n\n    const state = this.api.getState();\n    console.log(\"  State from API:\", state);\n    console.log(\"  Canvases:\", Object.keys(state.canvases || {}));\n\n    const items: LayerItem[] = [];\n\n    // Collect all items from all canvases\n    Object.entries(state.canvases).forEach(([canvasId, canvas]: [string, any]) => {\n      console.log(`  Canvas ${canvasId}: ${canvas.items?.length || 0} items`);\n      canvas.items.forEach((item) => {\n        items.push({\n          ...item,\n          canvasId,\n        });\n      });\n    });\n\n    console.log(`  Total items collected: ${items.length}`);\n\n    // Sort by z-index (descending - highest first)\n    items.sort((a, b) => b.zIndex - a.zIndex);\n\n    this.allItems = items;\n    console.log(\"  this.allItems set to:\", this.allItems.length, \"items\");\n\n    this.applySearchFilter();\n    console.log(\"  After filter:\", this.filteredItems.length, \"items\");\n  };\n\n  /**\n   * Apply search filter to items\n   *\n   * Filters items by name (case-insensitive substring match).\n   * Performance: <5ms for 1000 items, <10ms for 5000 items\n   */\n  private applySearchFilter = () => {\n    if (!this.searchQuery) {\n      this.filteredItems = this.allItems;\n      return;\n    }\n\n    const query = this.searchQuery.toLowerCase();\n    this.filteredItems = this.allItems.filter((item) =>\n      item.name.toLowerCase().includes(query),\n    );\n  };\n\n  /**\n   * Handle search input change with debouncing\n   *\n   * Debounces search input using configurable delay (default 300ms)\n   * to prevent excessive filtering on every keystroke.\n   */\n  private handleSearchInput = (event: Event) => {\n    const input = event.target as HTMLInputElement;\n    const value = input.value;\n\n    // Clear existing timer\n    if (this.searchDebounceTimer) {\n      clearTimeout(this.searchDebounceTimer);\n    }\n\n    // Debounce by configurable delay\n    this.searchDebounceTimer = window.setTimeout(() => {\n      this.searchQuery = value;\n      this.applySearchFilter();\n    }, this.searchDebounceMs);\n  };\n\n  /**\n   * Group items by canvas for folder rendering\n   */\n  private groupItemsByCanvas = (\n    items: LayerItem[],\n  ): Record<string, LayerItem[]> => {\n    const grouped: Record<string, LayerItem[]> = {};\n\n    items.forEach((item) => {\n      if (!grouped[item.canvasId]) {\n        grouped[item.canvasId] = [];\n      }\n      grouped[item.canvasId].push(item);\n    });\n\n    return grouped;\n  };\n\n  /**\n   * Get canvas title from metadata or fallback to canvasId\n   */\n  private getCanvasTitle = (canvasId: string): string => {\n    return this.canvasMetadata?.[canvasId]?.title || canvasId;\n  };\n\n  /**\n   * Toggle folder expand/collapse state\n   */\n  private toggleFolder = (canvasId: string) => {\n    this.folderExpandedState = {\n      ...this.folderExpandedState,\n      [canvasId]: !this.folderExpandedState[canvasId],\n    };\n  };\n\n  /**\n   * Initialize virtual scrolling\n   *\n   * Sets up scroll event listener for variable-height virtual rendering.\n   * Supports configurable item/folder heights and buffer zones.\n   *\n   * Performance target: <16ms per scroll frame (60fps)\n   */\n  private initializeVirtualScrolling = () => {\n    const scrollContainer = this.hostElement.querySelector(\n      \".layer-panel__list\",\n    ) as HTMLElement;\n    if (!scrollContainer) return;\n\n    // Track scroll position for virtual rendering\n    scrollContainer.addEventListener(\"scroll\", () => {\n      const scrollTop = scrollContainer.scrollTop;\n      this.virtualScrollOffset = scrollTop;\n    });\n  };\n\n  /**\n   * Build virtual items list with position cache\n   *\n   * Creates a flattened list of folders and items with their heights and cumulative offsets.\n   * This allows for accurate virtual scrolling with variable-height items.\n   * @returns Array of virtual items with position information\n   */\n  private buildVirtualItemsList = (): VirtualItem[] => {\n    const virtualItems: VirtualItem[] = [];\n    let currentOffset = 0;\n\n    // Group items by canvas\n    const allItemsByCanvas = this.groupItemsByCanvas(this.allItems);\n    const filteredItemsByCanvas = this.groupItemsByCanvas(this.filteredItems);\n\n    // Build virtual items list (folders + items)\n    // Iterate in canvasMetadata order to match visual order on page\n    const canvasOrder = this.canvasMetadata\n      ? Object.keys(this.canvasMetadata)\n      : Object.keys(allItemsByCanvas);\n\n    canvasOrder.forEach((canvasId) => {\n      // Skip canvases that don't exist in state (e.g., removed canvases)\n      if (!allItemsByCanvas[canvasId]) return;\n      const allCanvasItems = allItemsByCanvas[canvasId] || [];\n      const filteredCanvasItems = filteredItemsByCanvas[canvasId] || [];\n      const isExpanded = this.folderExpandedState[canvasId] ?? true;\n      const isEmpty = this.searchQuery && filteredCanvasItems.length === 0;\n\n      // Add folder header\n      virtualItems.push({\n        type: \"folder\",\n        data: {\n          canvasId,\n          title: this.getCanvasTitle(canvasId),\n          itemCount: filteredCanvasItems.length,\n          totalItemCount: allCanvasItems.length,\n          isEmpty,\n        },\n        height: this.folderHeight,\n        offset: currentOffset,\n      });\n      currentOffset += this.folderHeight;\n\n      // Add items if folder is expanded\n      if (isExpanded) {\n        filteredCanvasItems.forEach((item) => {\n          virtualItems.push({\n            type: \"item\",\n            data: item,\n            height: this.itemHeight,\n            offset: currentOffset,\n          });\n          currentOffset += this.itemHeight;\n        });\n      }\n    });\n\n    return virtualItems;\n  };\n\n  /**\n   * Get visible items for virtual scrolling\n   *\n   * Returns only the items/folders that should be rendered based on scroll position.\n   * Uses configurable heights and buffer zones for optimal performance.\n   *\n   * Performance: Reduces DOM nodes from 1000+ to ~50-100 (10-20√ó improvement)\n   * @returns Object with visible items and total scroll height\n   */\n  private calculateVirtualScrolling = (): {\n    visibleItems: VirtualItem[];\n    totalHeight: number;\n  } => {\n    const allVirtualItems = this.buildVirtualItemsList();\n\n    // Calculate total height\n    const totalHeight =\n      allVirtualItems.length > 0\n        ? allVirtualItems[allVirtualItems.length - 1].offset +\n          allVirtualItems[allVirtualItems.length - 1].height\n        : 0;\n\n    // Find visible range with buffer\n    const scrollTop = this.virtualScrollOffset;\n    const scrollContainer = this.hostElement.querySelector(\n      \".layer-panel__list\",\n    ) as HTMLElement;\n    const viewportHeight = scrollContainer?.clientHeight || 600;\n\n    const startY = Math.max(0, scrollTop - this.virtualBufferPx);\n    const endY = scrollTop + viewportHeight + this.virtualBufferPx;\n\n    // Binary search for start index\n    let startIndex = 0;\n    for (let i = 0; i < allVirtualItems.length; i++) {\n      if (allVirtualItems[i].offset + allVirtualItems[i].height >= startY) {\n        startIndex = i;\n        break;\n      }\n    }\n\n    // Find end index\n    let endIndex = startIndex;\n    for (let i = startIndex; i < allVirtualItems.length; i++) {\n      if (allVirtualItems[i].offset > endY) {\n        break;\n      }\n      endIndex = i;\n    }\n\n    // Extract visible items\n    const visibleItems = allVirtualItems.slice(startIndex, endIndex + 1);\n\n    return { visibleItems, totalHeight };\n  };\n\n  /**\n   * Handle layer item selection\n   *\n   * Updates grid state to select the clicked item.\n   */\n  @Listen(\"layerItemSelect\")\n  handleLayerItemSelect(\n    event: CustomEvent<{ itemId: string; canvasId: string }>,\n  ) {\n    if (!this.api) return;\n\n    const { itemId, canvasId } = event.detail;\n\n    // Update grid state via API\n    const state = this.api.getState();\n    state.selectedItemId = itemId;\n    state.selectedCanvasId = canvasId;\n    state.activeCanvasId = canvasId;\n  }\n\n  /**\n   * Handle folder toggle (expand/collapse)\n   */\n  @Listen(\"toggleFolder\")\n  handleToggleFolder(event: CustomEvent<{ canvasId: string }>) {\n    this.toggleFolder(event.detail.canvasId);\n  }\n\n  /**\n   * Handle canvas activation (set as active canvas)\n   */\n  @Listen(\"activateCanvas\")\n  handleActivateCanvas(event: CustomEvent<{ canvasId: string }>) {\n    if (!this.api) return;\n\n    const state = this.api.getState();\n    state.activeCanvasId = event.detail.canvasId;\n  }\n\n  /**\n   * Handle scroll to canvas (double-click on folder header)\n   */\n  @Listen(\"scrollToCanvas\")\n  handleScrollToCanvas(event: CustomEvent<{ canvasId: string }>) {\n    const { canvasId } = event.detail;\n    console.log(\"üìú Scrolling to canvas:\", canvasId);\n\n    // Find the canvas element in the DOM\n    const canvasElement = document.getElementById(canvasId);\n    if (canvasElement) {\n      canvasElement.scrollIntoView({\n        behavior: \"smooth\",\n        block: \"center\",\n        inline: \"nearest\",\n      });\n      console.log(\"  ‚úÖ Scrolled to canvas element\");\n    } else {\n      console.warn(\"  ‚ö†Ô∏è Canvas element not found:\", canvasId);\n    }\n  }\n\n  /**\n   * Handle drag start for layer item reordering\n   *\n   * Stores drag metadata for drop calculation.\n   */\n  @Listen(\"layerItemDragStart\")\n  handleLayerItemDragStart(\n    event: CustomEvent<{ itemId: string; canvasId: string; zIndex: number }>,\n  ) {\n    const { itemId, canvasId, zIndex } = event.detail;\n\n    // Store drag state\n    this.draggedItem = {\n      itemId,\n      canvasId,\n      zIndex,\n    };\n  }\n\n  /**\n   * Handle drop for layer item reordering\n   *\n   * Calculates new z-index and handles cross-canvas movement.\n   * Supports Photoshop-like behavior: drop above/below target item.\n   *\n   * Uses GridBuilderAPI methods for proper event emission and undo/redo support.\n   */\n  @Listen(\"layer-item-dropped\")\n  handleLayerItemDropped(\n    event: CustomEvent<{\n      targetItemId: string;\n      targetCanvasId: string;\n      targetZIndex: number;\n      dropAbove: boolean;\n    }>,\n  ) {\n    console.log(\"üéØ Layer item dropped\", { event: event.detail, draggedItem: this.draggedItem, hasApi: !!this.api });\n\n    if (!this.draggedItem || !this.api) {\n      console.warn(\"  ‚ö†Ô∏è No draggedItem or API, aborting\");\n      return;\n    }\n\n    const state = this.api.getState();\n    const { targetItemId, targetCanvasId, targetZIndex, dropAbove } =\n      event.detail;\n    const {\n      itemId: draggedItemId,\n      canvasId: draggedCanvasId,\n      zIndex: draggedZIndex,\n    } = this.draggedItem;\n\n    // Don't drop on self\n    if (draggedItemId === targetItemId && draggedCanvasId === targetCanvasId) {\n      console.log(\"  ‚ÑπÔ∏è Dropped on self, ignoring\");\n      this.draggedItem = null;\n      return;\n    }\n\n    console.log(\"  üì¶ Processing drop:\", { draggedItemId, draggedCanvasId, draggedZIndex, targetItemId, targetCanvasId, targetZIndex, dropAbove });\n\n    // Collect all z-index changes to apply in batch\n    const zIndexChanges: { itemId: string; canvasId: string; newZIndex: number }[] = [];\n\n    // Handle cross-canvas movement\n    if (draggedCanvasId !== targetCanvasId) {\n      const sourceCanvas = state.canvases[draggedCanvasId];\n      const targetCanvas = state.canvases[targetCanvasId];\n\n      if (!sourceCanvas || !targetCanvas) return;\n\n      // Move item to target canvas using API\n      this.api.moveItem(draggedCanvasId, targetCanvasId, draggedItemId);\n\n      // Get updated state after move\n      const updatedTargetCanvas = this.api.getState().canvases[targetCanvasId];\n      const sortedItems = [...updatedTargetCanvas.items].sort(\n        (a, b) => a.zIndex - b.zIndex,\n      );\n\n      // Find target item index in sorted list\n      const targetIndex = sortedItems.findIndex((i) => i.id === targetItemId);\n\n      // Calculate new z-index based on drop position\n      let newZIndex: number;\n      if (dropAbove) {\n        // Drop above target: use target's z-index\n        newZIndex = targetZIndex;\n        // Collect z-index changes for items that need to shift up\n        sortedItems.forEach((item) => {\n          if (item.id !== draggedItemId && item.zIndex >= newZIndex) {\n            zIndexChanges.push({\n              itemId: item.id,\n              canvasId: targetCanvasId,\n              newZIndex: item.zIndex + 1,\n            });\n          }\n        });\n      } else {\n        // Drop below target: use z-index between target and next item\n        if (targetIndex < sortedItems.length - 1) {\n          const nextItem = sortedItems[targetIndex + 1];\n          newZIndex = nextItem.zIndex;\n          // Collect z-index changes for items that need to shift up\n          sortedItems.forEach((item) => {\n            if (item.id !== draggedItemId && item.zIndex >= newZIndex) {\n              zIndexChanges.push({\n                itemId: item.id,\n                canvasId: targetCanvasId,\n                newZIndex: item.zIndex + 1,\n              });\n            }\n          });\n        } else {\n          // Dropping at the bottom\n          newZIndex = targetZIndex + 1;\n        }\n      }\n\n      // Add dragged item's new z-index\n      zIndexChanges.push({\n        itemId: draggedItemId,\n        canvasId: targetCanvasId,\n        newZIndex,\n      });\n    } else {\n      // Same canvas reordering\n      const canvas = state.canvases[draggedCanvasId];\n      const sortedItems = [...canvas.items].sort((a, b) => a.zIndex - b.zIndex);\n\n      // Find indices\n      const draggedIndex = sortedItems.findIndex((i) => i.id === draggedItemId);\n      const targetIndex = sortedItems.findIndex((i) => i.id === targetItemId);\n\n      // Calculate new z-index\n      let newZIndex: number;\n      if (dropAbove) {\n        // Drop above target\n        newZIndex = targetZIndex;\n        // Collect z-index changes for items between old and new position\n        sortedItems.forEach((item) => {\n          if (item.id !== draggedItemId) {\n            if (draggedIndex < targetIndex) {\n              // Moving down: decrement items between\n              if (item.zIndex > draggedZIndex && item.zIndex <= targetZIndex) {\n                zIndexChanges.push({\n                  itemId: item.id,\n                  canvasId: draggedCanvasId,\n                  newZIndex: item.zIndex - 1,\n                });\n              }\n            } else {\n              // Moving up: increment items between\n              if (item.zIndex >= targetZIndex && item.zIndex < draggedZIndex) {\n                zIndexChanges.push({\n                  itemId: item.id,\n                  canvasId: draggedCanvasId,\n                  newZIndex: item.zIndex + 1,\n                });\n              }\n            }\n          }\n        });\n      } else {\n        // Drop below target\n        if (targetIndex < sortedItems.length - 1) {\n          newZIndex = targetZIndex + 1;\n          // Collect z-index changes\n          sortedItems.forEach((item) => {\n            if (item.id !== draggedItemId) {\n              if (draggedIndex < targetIndex) {\n                // Moving down\n                if (item.zIndex > draggedZIndex && item.zIndex <= newZIndex) {\n                  zIndexChanges.push({\n                    itemId: item.id,\n                    canvasId: draggedCanvasId,\n                    newZIndex: item.zIndex - 1,\n                  });\n                }\n              } else {\n                // Moving up\n                if (item.zIndex >= newZIndex && item.zIndex < draggedZIndex) {\n                  zIndexChanges.push({\n                    itemId: item.id,\n                    canvasId: draggedCanvasId,\n                    newZIndex: item.zIndex + 1,\n                  });\n                }\n              }\n            }\n          });\n        } else {\n          // Dropping at bottom\n          newZIndex = targetZIndex + 1;\n        }\n      }\n\n      // Add dragged item's new z-index\n      zIndexChanges.push({\n        itemId: draggedItemId,\n        canvasId: draggedCanvasId,\n        newZIndex,\n      });\n    }\n\n    // Apply all z-index changes in one batch operation\n    if (zIndexChanges.length > 0) {\n      this.api.setItemsZIndexBatch(zIndexChanges);\n    }\n\n    // Clear drag state (refreshItems() is no longer needed as API events will trigger re-render)\n    this.draggedItem = null;\n  }\n\n  render() {\n    const { visibleItems, totalHeight } = this.calculateVirtualScrolling();\n\n    // Get state for selection/active canvas checks\n    const state = this.api?.getState();\n    const activeCanvasId = state?.activeCanvasId;\n    const selectedItemId = state?.selectedItemId;\n    const selectedCanvasId = state?.selectedCanvasId;\n\n    return (\n      <div class=\"layer-panel\">\n        {/* Header */}\n        <div class=\"layer-panel__header\">\n          <h3 class=\"layer-panel__title\">Layers</h3>\n          <div class=\"layer-panel__count\">\n            {this.filteredItems.length} items\n          </div>\n        </div>\n\n        {/* Search */}\n        <div class=\"layer-panel__search\">\n          <input\n            type=\"text\"\n            class=\"layer-panel__search-input\"\n            placeholder=\"Search layers...\"\n            onInput={this.handleSearchInput}\n          />\n        </div>\n\n        {/* Layer list with virtual scrolling */}\n        <div class=\"layer-panel__list\">\n          <div\n            class=\"layer-panel__list-inner\"\n            style={{ height: `${totalHeight}px`, position: \"relative\" }}\n          >\n            {visibleItems.length === 0 && (\n              <div class=\"layer-panel__empty\">No items found</div>\n            )}\n\n            {visibleItems.map((virtualItem) => {\n              if (virtualItem.type === \"folder\") {\n                // Render folder header\n                const folderData = virtualItem.data as {\n                  canvasId: string;\n                  title: string;\n                  itemCount: number;\n                  totalItemCount?: number;\n                  isEmpty?: boolean;\n                };\n\n                return (\n                  <layer-panel-folder-header\n                    key={`folder-${folderData.canvasId}`}\n                    canvasId={folderData.canvasId}\n                    canvasTitle={folderData.title}\n                    itemCount={folderData.itemCount}\n                    totalItemCount={folderData.totalItemCount}\n                    isExpanded={\n                      this.folderExpandedState[folderData.canvasId] ?? true\n                    }\n                    isActive={folderData.canvasId === activeCanvasId}\n                    isEmpty={folderData.isEmpty}\n                    style={{\n                      position: \"absolute\",\n                      top: `${virtualItem.offset}px`,\n                      left: \"0\",\n                      right: \"0\",\n                      height: `${virtualItem.height}px`,\n                    }}\n                  />\n                );\n              } else {\n                // Render layer item\n                const item = virtualItem.data as LayerItem;\n\n                return (\n                  <layer-panel-item\n                    key={item.id}\n                    itemId={item.id}\n                    canvasId={item.canvasId}\n                    name={item.name}\n                    type={item.type}\n                    zIndex={item.zIndex}\n                    isActive={\n                      item.id === selectedItemId &&\n                      item.canvasId === selectedCanvasId\n                    }\n                    style={{\n                      position: \"absolute\",\n                      top: `${virtualItem.offset}px`,\n                      left: \"0\",\n                      right: \"0\",\n                      height: `${virtualItem.height}px`,\n                    }}\n                  />\n                );\n              }\n            })}\n          </div>\n        </div>\n\n        {/* Instructions */}\n        <div class=\"layer-panel__footer\">\n          <div class=\"layer-panel__hint\">\n            Click folder to expand/collapse ¬∑ Click item to select\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n"],"names":[],"mappings":"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"}